(this["webpackJsonpmake-sense"]=this["webpackJsonpmake-sense"]||[]).push([[0],{394:function(e,t,n){},395:function(e,t,n){},396:function(e,t,n){},419:function(e,t,n){},445:function(e,t,n){},446:function(e,t,n){},447:function(e,t,n){},448:function(e,t,n){},449:function(e,t,n){},450:function(e,t,n){},451:function(e,t,n){},452:function(e,t,n){},453:function(e,t,n){},454:function(e,t,n){},455:function(e,t,n){},456:function(e,t,n){},457:function(e,t,n){},462:function(e,t){},463:function(e,t){},471:function(e,t){},473:function(e,t,n){},474:function(e,t,n){},497:function(e,t,n){},498:function(e,t,n){},499:function(e,t,n){},500:function(e,t,n){},501:function(e,t,n){},502:function(e,t,n){},503:function(e,t,n){},504:function(e,t,n){},505:function(e,t,n){},506:function(e,t,n){},507:function(e,t,n){},508:function(e,t,n){},509:function(e,t,n){},519:function(e,t,n){},520:function(e,t,n){},521:function(e,t,n){},522:function(e,t,n){},523:function(e,t,n){},524:function(e,t,n){},525:function(e,t,n){},526:function(e,t,n){},527:function(e,t,n){},529:function(e,t,n){"use strict";n.r(t),n.d(t,"store",(function(){return wa}));var a,i=n(3),o=n.n(i),r=n(50),c=n.n(r),s=(n(394),n(395),n(396),n(8)),l=n(28);!function(e){e.TOP="TOP",e.BOTTOM="BOTTOM",e.LEFT="LEFT",e.RIGHT="RIGHT",e.TOP_RIGHT="TOP_RIGHT",e.TOP_LEFT="TOP_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.CENTER="CENTER"}(a||(a={}));var u,d=n(6);!function(e){e.LOAD_LABEL_NAMES="LOAD_LABEL_NAMES",e.UPDATE_LABEL="UPDATE_LABEL",e.SUGGEST_LABEL_NAMES="SUGGEST_LABEL_NAMES",e.IMPORT_IMAGES="IMPORT_IMAGES",e.LOAD_AI_MODEL="LOAD_AI_MODEL",e.EXPORT_ANNOTATIONS="EXPORT_ANNOTATIONS",e.IMPORT_ANNOTATIONS="IMPORT_ANNOTATIONS",e.INSERT_LABEL_NAMES="INSERT_LABEL_NAMES",e.EXIT_PROJECT="EXIT_PROJECT",e.LOADER="LOADER"}(u||(u={}));var g=function e(){Object(d.a)(this,e)};g.GITHUB_URL="https://github.com/SkalskiP",g.MEDIUM_URL="https://medium.com/@piotr.skalski92",g.PATREON_URL="https://www.patreon.com/make_sense",g.TOP_NAVIGATION_BAR_HEIGHT_PX=35,g.EDITOR_BOTTOM_NAVIGATION_BAR_HEIGHT_PX=41,g.EDITOR_TOP_NAVIGATION_BAR_HEIGHT_PX=41,g.SIDE_NAVIGATION_BAR_WIDTH_OPEN_PX=(g.SIDE_NAVIGATION_BAR_WIDTH_CLOSED_PX=24)+300+1,g.TOOLKIT_TAB_HEIGHT_PX=40,g.TOOLBOX_PANEL_WIDTH_PX=51,g.EDITOR_MIN_WIDTH=900,g.EDITOR_MIN_HEIGHT=500,g.PRIMARY_COLOR="#2af598",g.SECONDARY_COLOR="#009efd",g.DARK_THEME_FIRST_COLOR="#171717",g.DARK_THEME_SECOND_COLOR="#282828",g.DARK_THEME_THIRD_COLOR="#4c4c4c",g.DARK_THEME_FORTH_COLOR="#262c2f",g.CROSS_HAIR_THICKNESS_PX=1,g.CROSS_HAIR_COLOR="#fff",g.RESIZE_HANDLE_DIMENSION_PX=8,g.RESIZE_HANDLE_HOVER_DIMENSION_PX=16,g.CLOSEABLE_POPUPS=[u.IMPORT_IMAGES,u.EXPORT_ANNOTATIONS,u.IMPORT_ANNOTATIONS,u.EXIT_PROJECT,u.UPDATE_LABEL],g.LABEL_COLORS_PALETTE=["#ff3838","#ff9d97","#ff701f","#ffb21d","#cff231","#48f90a","#92cc17","#3ddb86","#1a9334","#00d4bb","#2c99a8","#00c2ff","#344593","#6473ff","#0018ec","#8438ff","#520085","#cb38ff","#ff95c8","#ff37c7"];var b,h=n(11),f=n(25),O=n(26);!function(e){e.IMAGE_RECOGNITION="IMAGE RECOGNITION",e.POINT="POINT",e.RECT="RECT",e.POLYGON="POLYGON",e.LINE="LINE"}(b||(b={}));var v=n(65),p=n.n(v),m=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"calculateGridSize",value:function(e,t,n){var a=Math.floor(e.width/t.width);return{width:a,height:Math.ceil(n/a)}}},{key:"calculateContentSize",value:function(e,t,n){var a={width:t.width*n.width,height:t.height*n.height};return{width:Math.max(e.width,a.width),height:a.height}}},{key:"calculateAnchorPoints",value:function(t,n,a){for(var i=e.calculateGridSize(t,n,a),o=(e.calculateContentSize(t,n,i).width-i.width*n.width)/(i.width+1),r=[],c=0;c<a;c++){var s=Math.floor(c/i.width),l={x:s*o+c%i.width*n.width,y:s*n.height};r.push(l)}return r}}]),e}(),j=n(10),y=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"snapValueToRange",value:function(e,t,n){return e<t?t:e>n?n:e}},{key:"isValueInRange",value:function(e,t,n){return e>=t&&e<=n}}]),e}(),I=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"getRatio",value:function(e){return e?e.width/e.height:null}},{key:"intersect",value:function(e,t){return e&&t?!(t.x>e.x+e.width||t.x+t.width<e.x||t.y>e.y+e.height||t.y+t.height<e.y):null}},{key:"isPointInside",value:function(e,t){return e&&t?e.x<t.x&&e.x+e.width>t.x&&e.y<t.y&&e.y+e.height>t.y:null}},{key:"getRectWithCenterAndSize",value:function(e,t){return Object(j.a)({x:e.x-.5*t.width,y:e.y-.5*t.height},t)}},{key:"fitInsideRectWithRatio",value:function(t,n){if(e.getRatio(t)<n){var a=t.width/n;return{x:t.x,y:t.y+(t.height-a)/2,width:t.width,height:a}}var i=t.height*n;return{x:t.x+(t.width-i)/2,y:t.y,width:i,height:t.height}}},{key:"resizeRect",value:function(e,t,n){var i=Object(j.a)({},e);switch(t){case a.RIGHT:i.width+=n.x;break;case a.BOTTOM_RIGHT:i.width+=n.x,i.height+=n.y;break;case a.BOTTOM:i.height+=n.y;break;case a.TOP_RIGHT:i.width+=n.x,i.y+=n.y,i.height-=n.y;break;case a.TOP:i.y+=n.y,i.height-=n.y;break;case a.TOP_LEFT:i.x+=n.x,i.width-=n.x,i.y+=n.y,i.height-=n.y;break;case a.LEFT:i.x+=n.x,i.width-=n.x;break;case a.BOTTOM_LEFT:i.x+=n.x,i.width-=n.x,i.height+=n.y}return i.width<0&&(i.x=i.x+i.width,i.width=-i.width),i.height<0&&(i.y=i.y+i.height,i.height=-i.height),i}},{key:"translate",value:function(e,t){return Object(j.a)(Object(j.a)({},e),{},{x:e.x+t.x,y:e.y+t.y})}},{key:"expand",value:function(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width+2*t.x,height:e.height+2*t.y}}},{key:"scaleRect",value:function(e,t){return{x:e.x*t,y:e.y*t,width:e.width*t,height:e.height*t}}},{key:"mapRectToAnchors",value:function(e){return[{type:a.TOP_LEFT,position:{x:e.x,y:e.y}},{type:a.TOP,position:{x:e.x+.5*e.width,y:e.y}},{type:a.TOP_RIGHT,position:{x:e.x+e.width,y:e.y}},{type:a.LEFT,position:{x:e.x,y:e.y+.5*e.height}},{type:a.RIGHT,position:{x:e.x+e.width,y:e.y+.5*e.height}},{type:a.BOTTOM_LEFT,position:{x:e.x,y:e.y+e.height}},{type:a.BOTTOM,position:{x:e.x+.5*e.width,y:e.y+e.height}},{type:a.BOTTOM_RIGHT,position:{x:e.x+e.width,y:e.y+e.height}}]}},{key:"snapPointToRect",value:function(t,n){return e.isPointInside(n,t)?t:{x:y.snapValueToRange(t.x,n.x,n.x+n.width),y:y.snapValueToRange(t.y,n.y,n.y+n.height)}}},{key:"getCenter",value:function(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}},{key:"getSize",value:function(e){return{width:e.width,height:e.height}}}]),e}(),A=n(4),E=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).gridSize=void 0,a.contentSize=void 0,a.childAnchors=void 0,a.scrollbars=void 0,a.calculate=function(e,t,n){a.gridSize=m.calculateGridSize(e,t,n),a.contentSize=m.calculateContentSize(e,t,a.gridSize),a.childAnchors=m.calculateAnchorPoints(e,t,n)},a.getVirtualListStyle=function(){return{position:"relative",width:a.props.size.width,height:a.props.size.height}},a.getVirtualListContentStyle=function(){return{width:a.contentSize.width,height:a.contentSize.height}},a.onScrollStart=function(){a.setState({isScrolling:!0})},a.onScrollStop=function(){a.setState({isScrolling:!1})},a.onScroll=function(e){a.setState({viewportRect:{x:e.scrollLeft,y:e.scrollTop,width:a.props.size.width,height:a.props.size.height}})},a.getChildren=function(){var e=a.state,t=e.viewportRect,n=e.isScrolling,i=a.props,o=i.overScanHeight,r=i.childSize,c=o||0,s={x:t.x,y:t.y-c,width:t.width,height:t.height+2*c};return a.childAnchors.reduce((function(e,t,i){var o=Object.assign(t,r),c=I.intersect(s,o);if(c){var l={position:"absolute",left:t.x,top:t.y,width:r.width,height:r.height};return e.concat(a.props.childRender(i,n,c,l))}return e}),[])},a.state={viewportRect:null,isScrolling:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.size,n=e.childSize,a=e.childCount;this.calculate(t,n,a),this.setState({viewportRect:{x:0,y:0,width:this.props.size.width,height:this.props.size.height}})}},{key:"componentWillUpdate",value:function(e,t,n){var a=e.size,i=e.childSize,o=e.childCount;this.props.size.height===a.height&&this.props.size.width===a.width&&this.props.childCount===o||(this.calculate(a,i,o),this.setState({viewportRect:{x:this.scrollbars.getValues().scrollLeft,y:this.scrollbars.getValues().scrollTop,width:a.width,height:a.height}}))}},{key:"render",value:function(){var e=this,t=!!this.props.size&&!!this.props.childSize&&!!this.gridSize;return Object(A.jsx)("div",{className:"VirtualList",style:this.getVirtualListStyle(),children:Object(A.jsx)(p.a,{ref:function(t){return e.scrollbars=t},onScrollFrame:this.onScroll,onScrollStart:this.onScrollStart,onScrollStop:this.onScrollStop,autoHide:!0,children:t&&Object(A.jsx)("div",{className:"VirtualListContent",style:this.getVirtualListContentStyle(),children:this.getChildren()})})})}}]),n}(o.a.Component),P=n(12),C=n.n(P),L=n(17),T=n(41),S=n.n(T),x=n(157),w=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"add",value:function(t){e.queue.push(Object(L.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))))}},{key:"run",value:function(){setTimeout((function(){return e.runQueue()}),10)}},{key:"addAndRun",value:function(t){e.add(t),e.run()}},{key:"runQueue",value:function(){var t=Object(L.a)(C.a.mark((function t(){return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isRunning){t.next=5;break}return e.isRunning=!0,t.next=4,e.runTasks();case 4:e.isRunning=!1;case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"runTasks",value:function(){var t=Object(L.a)(C.a.mark((function t(){var n;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.queue.length>0)){t.next=6;break}return n=e.queue.shift(),t.next=4,n();case 4:t.next=0;break;case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),e}();w.queue=[],w.isRunning=!1;var D,R=n(19),N=n(22),_=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"storeImage",value:function(t,n){e.repository[t]=n}},{key:"storeImages",value:function(t,n){Object(N.zip)(t,n).forEach((function(t){e.storeImage.apply(e,Object(R.a)(t))}))}},{key:"getById",value:function(t){return e.repository[t]}}]),e}();function k(e){return{type:D.UPDATE_ACTIVE_IMAGE_INDEX,payload:{activeImageIndex:e}}}function M(e){return{type:D.UPDATE_ACTIVE_LABEL_NAME_ID,payload:{activeLabelNameId:e}}}function B(e){return{type:D.UPDATE_ACTIVE_LABEL_ID,payload:{activeLabelId:e}}}function U(e){return{type:D.UPDATE_HIGHLIGHTED_LABEL_ID,payload:{highlightedLabelId:e}}}function V(e){return{type:D.UPDATE_ACTIVE_LABEL_TYPE,payload:{activeLabelType:e}}}function z(e,t){return{type:D.UPDATE_IMAGE_DATA_BY_ID,payload:{id:e,newImageData:t}}}function F(e){return{type:D.ADD_IMAGES_DATA,payload:{imageData:e}}}function G(e){return{type:D.UPDATE_IMAGES_DATA,payload:{imageData:e}}}function H(e){return{type:D.UPDATE_LABEL_NAMES,payload:{labels:e}}}function W(e){return{type:D.UPDATE_FIRST_LABEL_CREATED_FLAG,payload:{firstLabelCreatedFlag:e}}}_.repository={},function(e){e.UPDATE_SUGGESTED_LABEL_LIST="@@UPDATE_SUGGESTED_LABEL_LIST",e.UPDATE_REJECTED_SUGGESTED_LABEL_LIST="@@UPDATE_REJECTED_SUGGESTED_LABEL_LIST",e.UPDATE_OBJECT_DETECTOR_STATUS="@@UPDATE_OBJECT_DETECTOR_STATUS",e.UPDATE_POSE_DETECTOR_STATUS="@@UPDATE_POSE_DETECTOR_STATUS",e.UPDATE_FORM_DETECTOR_STATUS="@@UPDATE_FORM_DETECTOR_STATUS",e.UPDATE_MASK_DETECTOR_STATUS="@@UPDATE_MASK_DETECTOR_STATUS",e.UPDATE_DISABLED_AI_FLAG="@@UPDATE_DISABLED_AI_FLAG",e.UPDATE_PROJECT_DATA="@@UPDATE_PROJECT_DATA",e.UPDATE_WINDOW_SIZE="@@UPDATE_WINDOW_SIZE",e.UPDATE_ACTIVE_POPUP_TYPE="@@UPDATE_ACTIVE_POPUP_TYPE",e.UPDATE_CUSTOM_CURSOR_STYLE="@@UPDATE_CUSTOM_CURSOR_STYLE",e.UPDATE_CONTEXT="@@UPDATE_CONTEXT",e.UPDATE_PREVENT_CUSTOM_CURSOR_STATUS="@@UPDATE_PREVENT_CUSTOM_CURSOR_STATUS",e.UPDATE_IMAGE_DRAG_MODE_STATUS="@@UPDATE_IMAGE_DRAG_MODE_STATUS",e.UPDATE_CROSS_HAIR_VISIBLE_STATUS="@@UPDATE_CROSS_HAIR_VISIBLE_STATUS",e.UPDATE_ENABLE_PER_CLASS_COLORATION_STATUS="@@UPDATE_ENABLE_PER_CLASS_COLORATION_STATUS",e.UPDATE_ZOOM="@@UPDATE_ZOOM",e.UPDATE_ACTIVE_IMAGE_INDEX="@@UPDATE_ACTIVE_IMAGE_INDEX",e.UPDATE_IMAGE_DATA_BY_ID="@@UPDATE_IMAGE_DATA_BY_ID",e.ADD_IMAGES_DATA="@@ADD_IMAGES_DATA",e.UPDATE_IMAGES_DATA="@@UPDATE_IMAGES_DATA",e.UPDATE_ACTIVE_LABEL_NAME_ID="@@UPDATE_ACTIVE_LABEL_NAME_ID",e.UPDATE_ACTIVE_LABEL_TYPE="@@UPDATE_ACTIVE_LABEL_TYPE",e.UPDATE_ACTIVE_LABEL_ID="@@UPDATE_ACTIVE_LABEL_ID",e.UPDATE_HIGHLIGHTED_LABEL_ID="@@UPDATE_HIGHLIGHTED_LABEL_ID",e.UPDATE_LABEL_NAMES="@@UPDATE_LABEL_NAMES",e.UPDATE_FIRST_LABEL_CREATED_FLAG="@@UPDATE_FIRST_LABEL_CREATED_FLAG",e.SUBMIT_NEW_NOTIFICATION="@@SUBMIT_NEW_NOTIFICATION",e.DELETE_NOTIFICATION_BY_ID="@@DELETE_NOTIFICATION_BY_ID"}(D||(D={}));var Y,Z=n(47),X=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"loadImage",value:function(e){return new Promise((function(t,n){var a=URL.createObjectURL(e),i=new Image;i.src=a,i.onload=function(){return t(i)},i.onerror=n}))}},{key:"loadImages",value:function(t){return new Promise((function(n,a){var i=t.map((function(t){return e.loadImage(t)}));Promise.all(i).then((function(e){return n(e)})).catch((function(e){return a(e)}))}))}},{key:"readFile",value:function(e){return new Promise((function(t,n){var a=new FileReader;a.onloadend=function(e){t(e.target.result)},a.onerror=n,a.readAsText(e)}))}},{key:"readFiles",value:function(t){return new Promise((function(n,a){var i=t.map((function(t){return e.readFile(t)}));Promise.all(i).then((function(e){return n(e)})).catch((function(e){return a(e)}))}))}},{key:"extractFileExtension",value:function(e){var t=e.split(".");return t.length>1?t[t.length-1]:null}},{key:"extractFileName",value:function(e){var t,n=e.split("."),a="",i=Object(Z.a)(Array(n.length-1).keys());try{for(i.s();!(t=i.n()).done;){var o=t.value;a+=""===a?n[o]:"."+n[o]}}catch(r){i.e(r)}finally{i.f()}return a}}]),e}(),K=(n(419),function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"getSuggestedLabelList",value:function(){return wa.getState().ai.suggestedLabelList}},{key:"getRejectedSuggestedLabelList",value:function(){return wa.getState().ai.rejectedSuggestedLabelList}},{key:"isAIObjectDetectorModelLoaded",value:function(){return wa.getState().ai.isObjectDetectorLoaded}},{key:"isAIPoseDetectorModelLoaded",value:function(){return wa.getState().ai.isPoseDetectorLoaded}},{key:"isAIFormDetectorModelLoaded",value:function(){return wa.getState().ai.isFormDetectorLoaded}},{key:"isAIMaskDetectorModelLoaded",value:function(){return wa.getState().ai.isMaskDetectorLoaded}},{key:"isAIDisabled",value:function(){return wa.getState().ai.isAIDisabled}}]),e}()),J=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"getLeadingColor",value:function(){return K.isAIObjectDetectorModelLoaded()||K.isAIFormDetectorModelLoaded()||K.isAIMaskDetectorModelLoaded()?g.PRIMARY_COLOR:g.SECONDARY_COLOR}}]),e}(),q=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).isLoading=!1,a.loadImage=function(){var e=Object(L.a)(C.a.mark((function e(t,n){var i,o;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.loadStatus?(i=_.getById(t.id),a.state.image!==i&&a.setState({image:i})):n&&a.isLoading||(a.isLoading=!0,o=function(e){return a.saveLoadedImage(e,t)},X.loadImage(t.fileData).then((function(e){return o(e)})).catch((function(e){return a.handleLoadImageError()})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),a.saveLoadedImage=function(e,t){t.loadStatus=!0,a.props.updateImageDataById(t.id,t),_.storeImage(t.id,e),t.id===a.props.imageData.id&&(a.setState({image:e}),a.isLoading=!1)},a.getStyle=function(){var e=a.props.size,t={x:.15*e.width,y:.15*e.height,width:.7*e.width,height:.7*e.height},n={x:0,y:0,width:a.state.image.width,height:a.state.image.height},i=I.getRatio(n),o=I.fitInsideRectWithRatio(t,i);return{width:o.width,height:o.height,left:o.x,top:o.y}},a.handleLoadImageError=function(){},a.getClassName=function(){return S()("ImagePreview",{selected:a.props.isSelected})},a.state={image:null},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){w.addAndRun(this.loadImage(this.props.imageData,this.props.isScrolling))}},{key:"componentWillUpdate",value:function(e,t,n){this.props.imageData.id!==e.imageData.id&&(e.imageData.loadStatus?w.addAndRun(this.loadImage(e.imageData,e.isScrolling)):this.setState({image:null})),this.props.isScrolling&&!e.isScrolling&&w.addAndRun(this.loadImage(e.imageData,!1))}},{key:"shouldComponentUpdate",value:function(e,t,n){return this.props.imageData.id!==e.imageData.id||this.state.image!==t.image||this.props.isSelected!==e.isSelected||this.props.isChecked!==e.isChecked}},{key:"render",value:function(){var e=this.props,t=e.isChecked,n=e.style,a=e.onClick;return Object(A.jsx)("div",{className:this.getClassName(),style:n,onClick:a||void 0,children:this.state.image?[Object(A.jsxs)("div",{className:"Foreground",style:this.getStyle(),children:[Object(A.jsx)("img",{className:"Image",draggable:!1,src:this.state.image.src,alt:this.state.image.alt,style:Object(j.a)(Object(j.a)({},this.getStyle()),{},{left:0,top:0})}),t&&Object(A.jsx)("img",{className:"CheckBox",draggable:!1,src:"ico/ok.png",alt:"checkbox"})]},"Foreground"),Object(A.jsx)("div",{className:"Background",style:this.getStyle()},"Background")]:Object(A.jsx)(x.ClipLoader,{size:30,color:J.getLeadingColor(),loading:!0})})}}]),n}(o.a.Component),Q={updateImageDataById:z},$=Object(l.b)((function(e){return{}}),Q)(q);n(445);function ee(e){return{type:D.UPDATE_ACTIVE_POPUP_TYPE,payload:{activePopupType:e}}}function te(e){return{type:D.UPDATE_CUSTOM_CURSOR_STYLE,payload:{customCursorStyle:e}}}function ne(e){return{type:D.UPDATE_PREVENT_CUSTOM_CURSOR_STATUS,payload:{preventCustomCursor:e}}}function ae(e){return{type:D.UPDATE_PROJECT_DATA,payload:{projectData:e}}}!function(e){e.EDITOR="EDITOR",e.LEFT_NAVBAR="LEFT_NAVBAR",e.RIGHT_NAVBAR="RIGHT_NAVBAR",e.POPUP="POPUP",e.DROPDOWN="DROPDOWN"}(Y||(Y={}));var ie=function e(){Object(d.a)(this,e)};ie.editor=void 0,ie.canvas=void 0,ie.mousePositionIndicator=void 0,ie.cursor=void 0,ie.viewPortScrollbars=void 0,ie.image=void 0,ie.primaryRenderingEngine=void 0,ie.supportRenderingEngine=void 0,ie.viewPortHelper=void 0,ie.isLoading=!1,ie.viewPortActionsDisabled=!1,ie.mousePositionOnViewPortContent=void 0,ie.viewPortSize=void 0,ie.defaultRenderImageRect=void 0;var oe,re=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"deg2rad",value:function(e){return e*Math.PI/180}},{key:"rad2deg",value:function(e){return 180*e/Math.PI}}]),e}(),ce=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"clearCanvas",value:function(e){e.getContext("2d").clearRect(0,0,e.width,e.height)}},{key:"drawLine",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#111111",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=e.getContext("2d");o.save(),o.strokeStyle=a,o.lineWidth=i,o.lineCap="round",o.beginPath(),o.moveTo(t.x,t.y),o.lineTo(n.x+1,n.y+1),o.stroke(),o.restore()}},{key:"drawRect",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#fff",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=e.getContext("2d");i.save(),i.strokeStyle=n,i.lineWidth=a,i.beginPath(),i.rect(t.x,t.y,t.width,t.height),i.stroke(),i.restore()}},{key:"drawRectWithFill",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#fff",a=e.getContext("2d");a.save(),a.fillStyle=n,a.beginPath(),a.rect(t.x,t.y,t.width,t.height),a.fill(),a.restore()}},{key:"shadeEverythingButRect",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rgba(0, 0, 0, 0.7)",a=e.getContext("2d");a.save(),a.fillStyle=n,a.fillRect(0,0,e.width,e.height),a.globalCompositeOperation="destination-out",a.fillRect(t.x,t.y,t.width,t.height),a.restore()}},{key:"drawCircleWithFill",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#ffffff",i=e.getContext("2d");i.save();var o=re.deg2rad(0),r=re.deg2rad(360);i.fillStyle=a,i.beginPath(),i.arc(t.x,t.y,n,o,r,!1),i.fill(),i.restore()}},{key:"drawCircle",value:function(e,t,n,a,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"#ffffff",c=e.getContext("2d"),s=re.deg2rad(a),l=re.deg2rad(i);c.save(),c.strokeStyle=r,c.lineWidth=o,c.beginPath(),c.arc(t.x,t.y,n,s,l,!1),c.stroke(),c.restore()}},{key:"drawPolygon",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#fff",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=e.getContext("2d");i.save(),i.strokeStyle=n,i.lineWidth=a,i.beginPath(),i.moveTo(t[0].x,t[0].y);for(var o=1;o<t.length;o++)i.lineTo(t[o].x,t[o].y);i.closePath(),i.stroke(),i.restore()}},{key:"drawPolygonWithFill",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#fff",a=e.getContext("2d");a.save(),a.fillStyle=n,a.beginPath(),a.moveTo(t[0].x,t[0].y);for(var i=1;i<t.length;i++)a.lineTo(t[i].x,t[i].y);a.closePath(),a.fill(),a.restore()}},{key:"drawText",value:function(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#ffffff",o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"center",c=e.getContext("2d");c.save(),c.fillStyle=i,c.textAlign=r,c.textBaseline="middle",c.font=(o?"bold ":"")+n+"px Arial",c.fillText(t,a.x,a.y),c.restore()}},{key:"hexToRGB",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=parseInt(e.slice(1,3),16),a=parseInt(e.slice(3,5),16),i=parseInt(e.slice(5,7),16);return null!==t?"rgba("+n+", "+a+", "+i+", "+t+")":"rgb("+n+", "+a+", "+i+")"}}]),e}(),se=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"equals",value:function(e,t){return e.x===t.x&&e.y===t.y}},{key:"add",value:function(e,t){return{x:e.x+t.x,y:e.y+t.y}}},{key:"subtract",value:function(e,t){return{x:e.x-t.x,y:e.y-t.y}}},{key:"multiply",value:function(e,t){return{x:e.x*t,y:e.y*t}}}]),e}(),le=function e(){Object(d.a)(this,e)};le.LINE_THICKNESS=2,le.lineActiveColor=g.PRIMARY_COLOR,le.defaultLineColor="#ffffff",le.CROSS_HAIR_LINE_COLOR="#ffffff",le.crossHairPadding=25,le.anchorSize={width:g.RESIZE_HANDLE_DIMENSION_PX,height:g.RESIZE_HANDLE_DIMENSION_PX},le.anchorHoverSize={width:g.RESIZE_HANDLE_HOVER_DIMENSION_PX,height:g.RESIZE_HANDLE_HOVER_DIMENSION_PX},le.suggestedAnchorDetectionSize={width:100,height:100},le.defaultAnchorColor="#ffffff",le.inactiveAnchorColor=g.DARK_THEME_SECOND_COLOR,le.DEFAULT_ANCHOR_COLOR="#ffffff",le.ACTIVE_ANCHOR_COLOR=g.SECONDARY_COLOR,le.INACTIVE_ANCHOR_COLOR=g.DARK_THEME_SECOND_COLOR,le.DEFAULT_LINE_COLOR="#ffffff",le.ACTIVE_LINE_COLOR=g.PRIMARY_COLOR,le.INACTIVE_LINE_COLOR="#ffffff",function(e){e.DEFAULT="DEFAULT",e.MOVE="MOVE",e.RESIZE="RESIZE",e.ADD="ADD",e.CANCEL="CANCEL",e.CLOSE="CLOSE",e.GRAB="GRAB",e.GRABBING="GRABBING"}(oe||(oe={}));var ue,de=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"getLabelNames",value:function(){return wa.getState().labels.labels}},{key:"getLabelNameById",value:function(t){var n=e.getLabelNames();return Object(N.find)(n,{id:t})}},{key:"getActiveLabelNameId",value:function(){return wa.getState().labels.activeLabelNameId}},{key:"getActiveLabelType",value:function(){return wa.getState().labels.activeLabelType}},{key:"getImagesData",value:function(){return wa.getState().labels.imagesData}},{key:"getActiveImageIndex",value:function(){return wa.getState().labels.activeImageIndex}},{key:"getActiveImageData",value:function(){var t=e.getActiveImageIndex();return null===t?null:e.getImageDataByIndex(t)}},{key:"getImageDataByIndex",value:function(t){return e.getImagesData()[t]}},{key:"getImageDataById",value:function(t){var n=e.getImagesData();return Object(N.find)(n,{id:t})}},{key:"getActiveLabelId",value:function(){return wa.getState().labels.activeLabelId}},{key:"getHighlightedLabelId",value:function(){return wa.getState().labels.highlightedLabelId}},{key:"getActiveRectLabel",value:function(){var t=e.getActiveLabelId();return null===t?null:Object(N.find)(e.getActiveImageData().labelRects,{id:t})}},{key:"getActivePointLabel",value:function(){var t=e.getActiveLabelId();return null===t?null:Object(N.find)(e.getActiveImageData().labelPoints,{id:t})}},{key:"getActivePolygonLabel",value:function(){var t=e.getActiveLabelId();return null===t?null:Object(N.find)(e.getActiveImageData().labelPolygons,{id:t})}},{key:"getActiveLineLabel",value:function(){var t=e.getActiveLabelId();return null===t?null:Object(N.find)(e.getActiveImageData().labelLines,{id:t})}}]),e}();!function(e){e.RESIZE="resize",e.MOUSE_UP="mouseup",e.MOUSE_DOWN="mousedown",e.MOUSE_MOVE="mousemove",e.MOUSE_WHEEL="wheel",e.KEY_DOWN="keydown",e.KEY_PRESS="keypress",e.KEY_UP="keyup",e.FOCUS="focus"}(ue||(ue={}));var ge,be=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"getEventType",value:function(e){if(!e)return null;switch(e.type){case ue.MOUSE_DOWN:return ue.MOUSE_DOWN;case ue.MOUSE_UP:return ue.MOUSE_UP;case ue.MOUSE_MOVE:return ue.MOUSE_MOVE;default:return null}}}]),e}(),he=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"getActivePopupType",value:function(){return wa.getState().general.activePopupType}},{key:"getActiveContext",value:function(){return wa.getState().general.activeContext}},{key:"getPreventCustomCursorStatus",value:function(){return wa.getState().general.preventCustomCursor}},{key:"getImageDragModeStatus",value:function(){return wa.getState().general.imageDragMode}},{key:"getCrossHairVisibleStatus",value:function(){return wa.getState().general.crossHairVisible}},{key:"getCustomCursorStyle",value:function(){return wa.getState().general.customCursorStyle}},{key:"getProjectName",value:function(){return wa.getState().general.projectData.name}},{key:"getProjectType",value:function(){return wa.getState().general.projectData.type}},{key:"getZoom",value:function(){return wa.getState().general.zoom}},{key:"getEnablePerClassColorationStatus",value:function(){return wa.getState().general.enablePerClassColoration}}]),e}(),fe=function(){function e(t){Object(d.a)(this,e),this.canvas=void 0,this.labelType=void 0,this.canvas=t}return Object(h.a)(e,[{key:"update",value:function(e){if(e.event)switch(be.getEventType(e.event)){case ue.MOUSE_MOVE:this.mouseMoveHandler(e);break;case ue.MOUSE_UP:this.mouseUpHandler(e);break;case ue.MOUSE_DOWN:this.mouseDownHandler(e)}}}],[{key:"resolveLabelLineColor",value:function(e,t){if(he.getEnablePerClassColorationStatus()){var n=de.getLabelNameById(e);return n?n.color:le.DEFAULT_LINE_COLOR}return t?le.ACTIVE_LINE_COLOR:le.INACTIVE_LINE_COLOR}},{key:"resolveLabelAnchorColor",value:function(e){return he.getEnablePerClassColorationStatus()?le.DEFAULT_ANCHOR_COLOR:e?le.ACTIVE_ANCHOR_COLOR:le.INACTIVE_ANCHOR_COLOR}}]),e}(),Oe=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"getDistanceFromLine",value:function(e,t){return e.start.x!==e.end.x||e.start.y!==e.end.y?Math.abs((e.end.y-e.start.y)*t.x-(e.end.x-e.start.x)*t.y+e.end.x*e.start.y-e.end.y*e.start.x)/Math.sqrt(Math.pow(e.end.y-e.start.y,2)+Math.pow(e.end.x-e.start.x,2)):null}},{key:"getCenter",value:function(e){return{x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2}}},{key:"getPoints",value:function(e){return[e.start,e.end]}}]),e}(),ve=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"calculateImageScale",value:function(e){return e.realImageSize.width/e.viewPortContentImageRect.width}},{key:"isMouseOverImage",value:function(e){return I.isPointInside(e.viewPortContentImageRect,e.mousePositionOnViewPortContent)}},{key:"isMouseOverCanvas",value:function(e){return I.isPointInside(Object(j.a)({x:0,y:0},e.viewPortContentSize),e.mousePositionOnViewPortContent)}},{key:"transferPointFromImageToViewPortContent",value:function(t,n){var a=e.calculateImageScale(n);return se.add(se.multiply(t,1/a),n.viewPortContentImageRect)}},{key:"transferPolygonFromImageToViewPortContent",value:function(t,n){return t.map((function(t){return e.transferPointFromImageToViewPortContent(t,n)}))}},{key:"transferLineFromImageToViewPortContent",value:function(t,n){return{start:e.transferPointFromImageToViewPortContent(t.start,n),end:e.transferPointFromImageToViewPortContent(t.end,n)}}},{key:"transferPointFromViewPortContentToImage",value:function(t,n){var a=e.calculateImageScale(n);return se.multiply(se.subtract(t,n.viewPortContentImageRect),a)}},{key:"transferPolygonFromViewPortContentToImage",value:function(t,n){return t.map((function(t){return e.transferPointFromViewPortContentToImage(t,n)}))}},{key:"transferLineFromViewPortContentToImage",value:function(t,n){return{start:e.transferPointFromViewPortContentToImage(t.start,n),end:e.transferPointFromViewPortContentToImage(t.end,n)}}},{key:"transferRectFromViewPortContentToImage",value:function(t,n){var a=e.calculateImageScale(n);return I.translate(I.scaleRect(t,1/a),n.viewPortContentImageRect)}},{key:"transferRectFromImageToViewPortContent",value:function(t,n){var a=e.calculateImageScale(n),i={x:-n.viewPortContentImageRect.x,y:-n.viewPortContentImageRect.y};return I.scaleRect(I.translate(t,i),a)}},{key:"wrapDefaultCursorStyleInCancel",value:function(e){I.isPointInside(e.viewPortContentImageRect,e.mousePositionOnViewPortContent)?wa.dispatch(te(oe.DEFAULT)):wa.dispatch(te(oe.CANCEL))}},{key:"setValueBetweenPixels",value:function(e){return Math.floor(e)+.5}},{key:"setPointBetweenPixels",value:function(t){return{x:e.setValueBetweenPixels(t.x),y:e.setValueBetweenPixels(t.y)}}},{key:"setRectBetweenPixels",value:function(t){var n={x:t.x,y:t.y},a={x:t.x+t.width,y:t.y+t.height},i=e.setPointBetweenPixels(n),o=e.setPointBetweenPixels(a);return{x:i.x,y:i.y,width:o.x-i.x,height:o.y-i.y}}},{key:"isMouseOverLine",value:function(e,t,n){var a=Math.min(t.start.x,t.end.x),i=Math.max(t.start.x,t.end.x),o=Math.min(t.start.y,t.end.y),r=Math.max(t.start.y,t.end.y);return a-n<=e.x&&i+n>=e.x&&o-n<=e.y&&r+n>=e.y&&Oe.getDistanceFromLine(t,e)<n}},{key:"isMouseOverAnchor",value:function(e,t,n){return e&&t?I.isPointInside(I.getRectWithCenterAndSize(t,n),e):null}}]),e}();!function(e){e.ACCEPTED="ACCEPTED",e.REJECTED="REJECTED",e.UNDECIDED="UNDECIDED"}(ge||(ge={}));var pe=n(557),me=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"createLabelName",value:function(e){return{id:Object(pe.a)(),name:e,color:Object(N.sample)(g.LABEL_COLORS_PALETTE)}}},{key:"createLabelRect",value:function(e,t){return{id:Object(pe.a)(),labelId:e,rect:t,isCreatedByAI:!1,status:ge.ACCEPTED,suggestedLabel:null}}},{key:"createLabelPolygon",value:function(e,t){return{id:Object(pe.a)(),labelId:e,vertices:t,isCreatedByAI:!1,status:ge.ACCEPTED,suggestedLabel:null}}},{key:"labelNamesIdsDiff",value:function(e,t){return e.reduce((function(e,n){return Object(N.find)(t,{id:n.id})||e.push(n.id),e}),[])}}]),e}(),je=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).startCreateRectPoint=void 0,a.startResizeRectAnchor=void 0,a.mouseDownHandler=function(e){var t=ve.isMouseOverImage(e);if(ve.isMouseOverCanvas(e)){var n=a.getRectUnderMouse(e);if(n){var i=a.calculateRectRelativeToActiveImage(n.rect,e),o=a.getAnchorUnderMouseByRect(i,e.mousePositionOnViewPortContent,e.viewPortContentImageRect);o&&n.status===ge.ACCEPTED?(wa.dispatch(B(n.id)),a.startRectResize(o)):de.getHighlightedLabelId()?wa.dispatch(B(de.getHighlightedLabelId())):a.startRectCreation(e.mousePositionOnViewPortContent)}else t&&a.startRectCreation(e.mousePositionOnViewPortContent)}},a.mouseUpHandler=function(e){if(e.viewPortContentImageRect){var t=I.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),n=de.getActiveRectLabel();if(a.startCreateRectPoint&&!se.equals(a.startCreateRectPoint,t)){var i=Math.min(a.startCreateRectPoint.x,t.x),o=Math.min(a.startCreateRectPoint.y,t.y),r={x:i,y:o,width:Math.max(a.startCreateRectPoint.x,t.x)-i,height:Math.max(a.startCreateRectPoint.y,t.y)-o};a.addRectLabel(ve.transferRectFromImageToViewPortContent(r,e))}if(a.startResizeRectAnchor&&n){var c=a.calculateRectRelativeToActiveImage(n.rect,e),s=se.add(a.startResizeRectAnchor.position,e.viewPortContentImageRect),l=se.subtract(t,s),u=I.resizeRect(c,a.startResizeRectAnchor.type,l),d=ve.calculateImageScale(e),g=I.scaleRect(u,d),b=de.getActiveImageData();b.labelRects=b.labelRects.map((function(e){return e.id===n.id?Object(j.a)(Object(j.a)({},e),{},{rect:g}):e})),wa.dispatch(z(b.id,b))}}a.endRectTransformation()},a.mouseMoveHandler=function(e){if(e.viewPortContentImageRect&&e.mousePositionOnViewPortContent&&(ve.isMouseOverImage(e)&&!a.startResizeRectAnchor)){var t=a.getRectUnderMouse(e);t&&!a.isInProgress()?de.getHighlightedLabelId()!==t.id&&wa.dispatch(U(t.id)):null!==de.getHighlightedLabelId()&&wa.dispatch(U(null))}},a.addRectLabel=function(e){var t=de.getActiveLabelNameId(),n=de.getActiveImageData(),a=me.createLabelRect(t,e);n.labelRects.push(a),wa.dispatch(z(n.id,n)),wa.dispatch(W(!0)),wa.dispatch(B(a.id))},a.labelType=b.RECT,a}return Object(h.a)(n,[{key:"render",value:function(e){var t=this,n=de.getActiveLabelId(),a=de.getActiveImageData();a&&(a.labelRects.forEach((function(a){a.status===ge.ACCEPTED&&a.id===n?t.drawActiveRect(a,e):t.drawInactiveRect(a,e)})),this.drawCurrentlyCreatedRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),this.updateCursorStyle(e))}},{key:"drawCurrentlyCreatedRect",value:function(e,t){if(this.startCreateRectPoint){var n=I.snapPointToRect(e,t),a={x:this.startCreateRectPoint.x,y:this.startCreateRectPoint.y,width:n.x-this.startCreateRectPoint.x,height:n.y-this.startCreateRectPoint.y},i=ve.setRectBetweenPixels(a),o=fe.resolveLabelLineColor(null,!0);ce.drawRect(this.canvas,i,o,le.LINE_THICKNESS)}}},{key:"drawInactiveRect",value:function(e,t){var n=ve.transferRectFromViewPortContentToImage(e.rect,t),a=de.getHighlightedLabelId(),i=e.status===ge.ACCEPTED&&e.id===a,o=fe.resolveLabelLineColor(e.labelId,i),r=fe.resolveLabelAnchorColor(i);this.renderRect(n,i,o,r)}},{key:"drawActiveRect",value:function(e,t){var n=this.calculateRectRelativeToActiveImage(e.rect,t);if(this.startResizeRectAnchor){var a=se.add(this.startResizeRectAnchor.position,t.viewPortContentImageRect),i=I.snapPointToRect(t.mousePositionOnViewPortContent,t.viewPortContentImageRect),o=se.subtract(i,a);n=I.resizeRect(n,this.startResizeRectAnchor.type,o)}var r=I.translate(n,t.viewPortContentImageRect),c=fe.resolveLabelLineColor(e.labelId,!0),s=fe.resolveLabelAnchorColor(!0);this.renderRect(r,!0,c,s)}},{key:"renderRect",value:function(e,t,n,a){var i=this,o=ve.setRectBetweenPixels(e);(ce.drawRectWithFill(this.canvas,o,ce.hexToRGB(n,.2)),ce.drawRect(this.canvas,o,n,le.LINE_THICKNESS),t)&&I.mapRectToAnchors(e).map((function(e){return e.position})).forEach((function(e){var t=I.getRectWithCenterAndSize(e,le.anchorSize),n=ve.setRectBetweenPixels(t);ce.drawRectWithFill(i.canvas,n,a)}))}},{key:"updateCursorStyle",value:function(e){if(this.canvas&&e.mousePositionOnViewPortContent&&!he.getImageDragModeStatus()){var t=this.getRectUnderMouse(e);if(this.getAnchorUnderMouse(e)&&t&&t.status===ge.ACCEPTED||this.startResizeRectAnchor)return void wa.dispatch(te(oe.MOVE));ve.isMouseOverCanvas(e)?(!ve.isMouseOverImage(e)&&this.startCreateRectPoint?wa.dispatch(te(oe.MOVE)):ve.wrapDefaultCursorStyleInCancel(e),this.canvas.style.cursor="none"):this.canvas.style.cursor="default"}}},{key:"isInProgress",value:function(){return!!this.startCreateRectPoint||!!this.startResizeRectAnchor}},{key:"calculateRectRelativeToActiveImage",value:function(e,t){var n=ve.calculateImageScale(t);return I.scaleRect(e,1/n)}},{key:"getRectUnderMouse",value:function(e){var t=de.getActiveRectLabel();if(t&&this.isMouseOverRectEdges(t.rect,e))return t;for(var n=de.getActiveImageData().labelRects,a=0;a<n.length;a++)if(this.isMouseOverRectEdges(n[a].rect,e))return n[a];return null}},{key:"isMouseOverRectEdges",value:function(e,t){var n=I.translate(this.calculateRectRelativeToActiveImage(e,t),t.viewPortContentImageRect),a={x:le.anchorHoverSize.width/2,y:le.anchorHoverSize.height/2},i=I.expand(n,a),o={x:-le.anchorHoverSize.width/2,y:-le.anchorHoverSize.height/2},r=I.expand(n,o);return I.isPointInside(i,t.mousePositionOnViewPortContent)&&!I.isPointInside(r,t.mousePositionOnViewPortContent)}},{key:"getAnchorUnderMouseByRect",value:function(e,t,n){for(var a=I.mapRectToAnchors(e),i=0;i<a.length;i++){var o=I.translate(I.getRectWithCenterAndSize(a[i].position,le.anchorHoverSize),n);if(t&&I.isPointInside(o,t))return a[i]}return null}},{key:"getAnchorUnderMouse",value:function(e){for(var t=de.getActiveImageData().labelRects,n=0;n<t.length;n++){var a=this.calculateRectRelativeToActiveImage(t[n].rect,e),i=this.getAnchorUnderMouseByRect(a,e.mousePositionOnViewPortContent,e.viewPortContentImageRect);if(i)return i}return null}},{key:"startRectCreation",value:function(e){this.startCreateRectPoint=e,wa.dispatch(B(null)),Ne.setViewPortActionsDisabledStatus(!0)}},{key:"startRectResize",value:function(e){this.startResizeRectAnchor=e,Ne.setViewPortActionsDisabledStatus(!0)}},{key:"endRectTransformation",value:function(){this.startCreateRectPoint=null,this.startResizeRectAnchor=null,Ne.setViewPortActionsDisabledStatus(!1)}}]),n}(fe),ye=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"getMousePositionOnCanvasFromEvent",value:function(e,t){if(t&&e){var n=t.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}}return null}},{key:"getClientRect",value:function(e){if(e){var t=e.getBoundingClientRect();return{x:t.left,y:t.top,width:t.width,height:t.height}}return null}},{key:"getSize",value:function(e){if(e){var t=e.getBoundingClientRect();return{width:t.width,height:t.height}}return null}}]),e}(),Ie=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).addPointLabel=function(e){var t=de.getActiveLabelNameId(),n=de.getActiveImageData(),a={id:Object(pe.a)(),labelId:t,point:e,isCreatedByAI:!1,status:ge.ACCEPTED,suggestedLabel:null};n.labelPoints.push(a),wa.dispatch(z(n.id,n)),wa.dispatch(W(!0)),wa.dispatch(B(a.id))},a.labelType=b.POINT,a}return Object(h.a)(n,[{key:"mouseDownHandler",value:function(e){var t=ve.isMouseOverImage(e);if(ve.isMouseOverCanvas(e)){var n=this.getLabelPointUnderMouse(e.mousePositionOnViewPortContent,e);if(n){var a=ve.transferPointFromImageToViewPortContent(n.point,e),i=ve.setPointBetweenPixels(a),o=I.getRectWithCenterAndSize(i,le.anchorHoverSize);if(I.isPointInside(o,e.mousePositionOnViewPortContent))return wa.dispatch(B(n.id)),void Ne.setViewPortActionsDisabledStatus(!0);wa.dispatch(B(null));var r=ve.transferPointFromViewPortContentToImage(e.mousePositionOnViewPortContent,e);this.addPointLabel(r)}else if(t){var c=ve.transferPointFromViewPortContentToImage(e.mousePositionOnViewPortContent,e);this.addPointLabel(c)}}}},{key:"mouseUpHandler",value:function(e){if(this.isInProgress()){var t=de.getActivePointLabel(),n=I.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),a=ve.transferPointFromViewPortContentToImage(n,e),i=de.getActiveImageData();i.labelPoints=i.labelPoints.map((function(e){return e.id===t.id?Object(j.a)(Object(j.a)({},e),{},{point:a}):e})),wa.dispatch(z(i.id,i))}Ne.setViewPortActionsDisabledStatus(!1)}},{key:"mouseMoveHandler",value:function(e){if(ve.isMouseOverImage(e)){var t=this.getLabelPointUnderMouse(e.mousePositionOnViewPortContent,e);t?de.getHighlightedLabelId()!==t.id&&wa.dispatch(U(t.id)):null!==de.getHighlightedLabelId()&&wa.dispatch(U(null))}}},{key:"render",value:function(e){var t=this,n=de.getActiveLabelId(),a=de.getHighlightedLabelId(),i=de.getActiveImageData();i&&i.labelPoints.forEach((function(i){if(i.id===n)if(t.isInProgress()){var o=I.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),r=ve.setPointBetweenPixels(o),c=fe.resolveLabelAnchorColor(!0);ce.drawCircleWithFill(t.canvas,r,g.RESIZE_HANDLE_DIMENSION_PX/2,c)}else t.renderPoint(i,!0,e);else t.renderPoint(i,i.id===n||i.id===a,e)})),this.updateCursorStyle(e)}},{key:"renderPoint",value:function(e,t,n){var a=ve.transferPointFromImageToViewPortContent(e.point,n),i=ve.setPointBetweenPixels(a),o=fe.resolveLabelAnchorColor(t);ce.drawCircleWithFill(this.canvas,i,g.RESIZE_HANDLE_DIMENSION_PX/2,o)}},{key:"updateCursorStyle",value:function(e){if(this.canvas&&e.mousePositionOnViewPortContent&&!he.getImageDragModeStatus()){var t=this.getLabelPointUnderMouse(e.mousePositionOnViewPortContent,e);if(t&&t.status===ge.ACCEPTED){var n=ve.transferPointFromImageToViewPortContent(t.point,e),a=ve.setPointBetweenPixels(n),i=I.getRectWithCenterAndSize(a,le.anchorHoverSize);if(I.isPointInside(i,e.mousePositionOnViewPortContent))return void wa.dispatch(te(oe.MOVE))}else if(this.isInProgress())return void wa.dispatch(te(oe.MOVE));I.isPointInside(Object(j.a)({x:0,y:0},ye.getSize(this.canvas)),e.mousePositionOnViewPortContent)?(ve.wrapDefaultCursorStyleInCancel(e),this.canvas.style.cursor="none"):this.canvas.style.cursor="default"}}},{key:"isInProgress",value:function(){return ie.viewPortActionsDisabled}},{key:"getLabelPointUnderMouse",value:function(e,t){for(var n=de.getActiveImageData().labelPoints,a=0;a<n.length;a++){var i=ve.transferPointFromImageToViewPortContent(n[a].point,t),o=I.getRectWithCenterAndSize(i,le.anchorHoverSize);if(I.isPointInside(o,e))return n[a]}return null}}]),n}(fe),Ae=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).activePath=[],a.resizeAnchorIndex=null,a.suggestedAnchorPositionOnCanvas=null,a.suggestedAnchorIndexInPolygon=null,a.labelType=b.POLYGON,a}return Object(h.a)(n,[{key:"update",value:function(e){if(e.event)switch(be.getEventType(e.event)){case ue.MOUSE_MOVE:this.mouseMoveHandler(e);break;case ue.MOUSE_UP:this.mouseUpHandler(e);break;case ue.MOUSE_DOWN:this.mouseDownHandler(e)}}},{key:"mouseDownHandler",value:function(e){var t=this;if(ve.isMouseOverCanvas(e))if(this.isCreationInProgress()){ve.isMouseOverAnchor(e.mousePositionOnViewPortContent,this.activePath[0],le.anchorSize)?this.addLabelAndFinishCreation(e):this.updateActivelyCreatedLabel(e)}else{var n=this.getPolygonUnderMouse(e);if(n){var a=n.vertices.reduce((function(n,a,i){if(null===n){var o=ve.transferPointFromImageToViewPortContent(a,e);if(t.isMouseOverAnchor(e.mousePositionOnViewPortContent,o))return i}return n}),null);if(null!==a)this.startExistingLabelResize(e,n.id,a);else wa.dispatch(B(n.id)),this.isMouseOverAnchor(e.mousePositionOnViewPortContent,this.suggestedAnchorPositionOnCanvas)&&this.addSuggestedAnchorToPolygonLabel(e)}else this.updateActivelyCreatedLabel(e)}}},{key:"mouseUpHandler",value:function(e){this.isResizeInProgress()&&this.endExistingLabelResize(e)}},{key:"mouseMoveHandler",value:function(e){if(e.viewPortContentImageRect&&e.mousePositionOnViewPortContent&&(ve.isMouseOverImage(e)&&!this.isCreationInProgress())){var t=this.getPolygonUnderMouse(e);if(t&&!this.isResizeInProgress()){de.getHighlightedLabelId()!==t.id&&wa.dispatch(U(t.id));for(var n=ve.transferPolygonFromImageToViewPortContent(t.vertices,e),a=this.mapPointsToLines(n.concat(n[0])),i=0;i<a.length;i++){if(ve.isMouseOverLine(e.mousePositionOnViewPortContent,a[i],le.anchorHoverSize.width/2)){this.suggestedAnchorPositionOnCanvas=Oe.getCenter(a[i]),this.suggestedAnchorIndexInPolygon=i+1;break}}}else null!==de.getHighlightedLabelId()&&(wa.dispatch(U(null)),this.discardSuggestedPoint())}}},{key:"render",value:function(e){de.getActiveImageData()&&(this.drawExistingLabels(e),this.drawActivelyCreatedLabel(e),this.drawActivelyResizeLabel(e),this.updateCursorStyle(e),this.drawSuggestedAnchor(e))}},{key:"updateCursorStyle",value:function(e){if(this.canvas&&e.mousePositionOnViewPortContent&&!he.getImageDragModeStatus())if(ve.isMouseOverCanvas(e)){if(this.isCreationInProgress()){this.isMouseOverAnchor(e.mousePositionOnViewPortContent,this.activePath[0])&&this.activePath.length>2?wa.dispatch(te(oe.CLOSE)):wa.dispatch(te(oe.DEFAULT))}else{var t=this.getAnchorUnderMouse(e);this.isMouseOverAnchor(e.mousePositionOnViewPortContent,this.suggestedAnchorPositionOnCanvas)?wa.dispatch(te(oe.ADD)):this.isResizeInProgress()||t?wa.dispatch(te(oe.MOVE)):ve.wrapDefaultCursorStyleInCancel(e)}this.canvas.style.cursor="none"}else this.canvas.style.cursor="default"}},{key:"drawActivelyCreatedLabel",value:function(e){var t=this,n=this.activePath.map((function(e){return ve.setPointBetweenPixels(e)})),a=n.concat(e.mousePositionOnViewPortContent),i=this.mapPointsToLines(a),o=fe.resolveLabelLineColor(null,!0),r=fe.resolveLabelAnchorColor(!0);ce.drawPolygonWithFill(this.canvas,a,ce.hexToRGB(o,.2)),i.forEach((function(e){ce.drawLine(t.canvas,e.start,e.end,o,le.LINE_THICKNESS)})),n.forEach((function(e){ce.drawCircleWithFill(t.canvas,e,g.RESIZE_HANDLE_DIMENSION_PX/2,r)}))}},{key:"drawActivelyResizeLabel",value:function(e){var t=this,n=de.getActivePolygonLabel();if(n&&this.isResizeInProgress()){var a=I.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),i=n.vertices.map((function(n,i){return i===t.resizeAnchorIndex?a:ve.transferPointFromImageToViewPortContent(n,e)}));this.drawPolygon(n.labelId,i,!0)}}},{key:"drawExistingLabels",value:function(e){var t=this,n=de.getActiveLabelId(),a=de.getHighlightedLabelId();de.getActiveImageData().labelPolygons.forEach((function(i){var o=i.id===n||i.id===a,r=ve.transferPolygonFromImageToViewPortContent(i.vertices,e);i.id===n&&t.isResizeInProgress()||t.drawPolygon(i.labelId,r,o)}))}},{key:"drawPolygon",value:function(e,t,n){var a=this,i=fe.resolveLabelLineColor(e,!0),o=fe.resolveLabelAnchorColor(!0),r=t.map((function(e){return ve.setPointBetweenPixels(e)}));n&&ce.drawPolygonWithFill(this.canvas,r,ce.hexToRGB(i,.2)),ce.drawPolygon(this.canvas,r,i,le.LINE_THICKNESS),n&&r.forEach((function(e){ce.drawCircleWithFill(a.canvas,e,g.RESIZE_HANDLE_DIMENSION_PX/2,o)}))}},{key:"drawSuggestedAnchor",value:function(e){var t=fe.resolveLabelAnchorColor(!0);if(this.suggestedAnchorPositionOnCanvas){var n=I.getRectWithCenterAndSize(this.suggestedAnchorPositionOnCanvas,le.suggestedAnchorDetectionSize);I.isPointInside(n,e.mousePositionOnViewPortContent)&&ce.drawCircleWithFill(this.canvas,this.suggestedAnchorPositionOnCanvas,g.RESIZE_HANDLE_DIMENSION_PX/2,t)}}},{key:"updateActivelyCreatedLabel",value:function(e){if(this.isCreationInProgress()){var t=I.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect);this.activePath.push(t)}else{I.isPointInside(e.viewPortContentImageRect,e.mousePositionOnViewPortContent)&&(Ne.setViewPortActionsDisabledStatus(!0),this.activePath.push(e.mousePositionOnViewPortContent),wa.dispatch(B(null)))}}},{key:"cancelLabelCreation",value:function(){this.activePath=[],Ne.setViewPortActionsDisabledStatus(!1)}},{key:"finishLabelCreation",value:function(){this.activePath=[],Ne.setViewPortActionsDisabledStatus(!1)}},{key:"addLabelAndFinishCreation",value:function(e){if(this.isCreationInProgress()&&this.activePath.length>2){var t=ve.transferPolygonFromViewPortContentToImage(this.activePath,e);this.addPolygonLabel(t),this.finishLabelCreation()}}},{key:"addPolygonLabel",value:function(e){var t=de.getActiveLabelNameId(),n=de.getActiveImageData(),a=me.createLabelPolygon(t,e);n.labelPolygons.push(a),wa.dispatch(z(n.id,n)),wa.dispatch(W(!0)),wa.dispatch(B(a.id))}},{key:"startExistingLabelResize",value:function(e,t,n){wa.dispatch(B(t)),this.resizeAnchorIndex=n,Ne.setViewPortActionsDisabledStatus(!0)}},{key:"endExistingLabelResize",value:function(e){this.applyResizeToPolygonLabel(e),this.resizeAnchorIndex=null,Ne.setViewPortActionsDisabledStatus(!1)}},{key:"applyResizeToPolygonLabel",value:function(e){var t=this,n=de.getActiveImageData(),a=de.getActivePolygonLabel();n.labelPolygons=n.labelPolygons.map((function(n){return n.id!==a.id?n:Object(j.a)(Object(j.a)({},n),{},{vertices:n.vertices.map((function(n,a){if(a!==t.resizeAnchorIndex)return n;var i=I.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect);return ve.transferPointFromViewPortContentToImage(i,e)}))})})),wa.dispatch(z(n.id,n)),wa.dispatch(B(a.id))}},{key:"discardSuggestedPoint",value:function(){this.suggestedAnchorIndexInPolygon=null,this.suggestedAnchorPositionOnCanvas=null}},{key:"addSuggestedAnchorToPolygonLabel",value:function(e){var t=this,n=de.getActiveImageData(),a=de.getActivePolygonLabel(),i=ve.transferPointFromViewPortContentToImage(this.suggestedAnchorPositionOnCanvas,e),o=Object(j.a)(Object(j.a)({},n),{},{labelPolygons:n.labelPolygons.map((function(e){return e.id!==a.id?e:Object(j.a)(Object(j.a)({},e),{},{vertices:(n=e.vertices,o=t.suggestedAnchorIndexInPolygon,r=i,[].concat(Object(R.a)(n.slice(0,o)),[r],Object(R.a)(n.slice(o))))});var n,o,r}))});wa.dispatch(z(o.id,o)),this.startExistingLabelResize(e,a.id,this.suggestedAnchorIndexInPolygon),this.discardSuggestedPoint()}},{key:"isInProgress",value:function(){return this.isCreationInProgress()||this.isResizeInProgress()}},{key:"isCreationInProgress",value:function(){return null!==this.activePath&&0!==this.activePath.length}},{key:"isResizeInProgress",value:function(){return null!==this.resizeAnchorIndex}},{key:"isMouseOverAnchor",value:function(e,t){return e&&t?I.isPointInside(I.getRectWithCenterAndSize(t,le.anchorSize),e):null}},{key:"mapPointsToLines",value:function(e){for(var t=[],n=0;n<e.length-1;n++)t.push({start:e[n],end:e[n+1]});return t}},{key:"getPolygonUnderMouse",value:function(e){for(var t=de.getActiveImageData().labelPolygons,n=0;n<t.length;n++){for(var a=ve.transferPolygonFromImageToViewPortContent(t[n].vertices,e),i=this.mapPointsToLines(a.concat(a[0])),o=0;o<i.length;o++){if(ve.isMouseOverLine(e.mousePositionOnViewPortContent,i[o],le.anchorHoverSize.width/2))return t[n]}for(var r=0;r<a.length;r++)if(this.isMouseOverAnchor(e.mousePositionOnViewPortContent,a[r]))return t[n]}return null}},{key:"getAnchorUnderMouse",value:function(e){for(var t=de.getActiveImageData().labelPolygons,n=0;n<t.length;n++)for(var a=ve.transferPolygonFromImageToViewPortContent(t[n].vertices,e),i=0;i<a.length;i++)if(this.isMouseOverAnchor(e.mousePositionOnViewPortContent,a[i]))return a[i];return null}}]),n}(fe),Ee=function e(){Object(d.a)(this,e)};Ee.CANVAS_MIN_MARGIN_PX=20,Ee.MIN_ZOOM=1,Ee.MAX_ZOOM=4,Ee.ZOOM_STEP=.1,Ee.TRANSLATION_STEP_PX=20;var Pe,Ce=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"getSize",value:function(e){return e?{width:e.width,height:e.height}:null}}]),e}(),Le=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"scale",value:function(e,t){return{width:e.width*t,height:e.height*t}}}]),e}(),Te=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"convertDirectionToVector",value:function(e){switch(e){case a.RIGHT:return{x:1,y:0};case a.LEFT:return{x:-1,y:0};case a.TOP:return{x:0,y:1};case a.BOTTOM:return{x:0,y:-1};case a.TOP_RIGHT:return{x:1,y:1};case a.TOP_LEFT:return{x:-1,y:1};case a.BOTTOM_RIGHT:return{x:1,y:-1};case a.BOTTOM_LEFT:return{x:-1,y:-1};case a.CENTER:return{x:0,y:0};default:return null}}}]),e}(),Se=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"updateViewPortSize",value:function(){ie.editor&&(ie.viewPortSize={width:ie.editor.offsetWidth,height:ie.editor.offsetHeight})}},{key:"updateDefaultViewPortImageRect",value:function(){if(ie.viewPortSize&&ie.image){var e={x:Ee.CANVAS_MIN_MARGIN_PX,y:Ee.CANVAS_MIN_MARGIN_PX},t=Object(j.a)({x:0,y:0},Ce.getSize(ie.image)),n=Object(j.a)({x:0,y:0},ie.viewPortSize),a=I.expand(n,se.multiply(e,-1));ie.defaultRenderImageRect=I.fitInsideRectWithRatio(a,I.getRatio(t))}}},{key:"calculateViewPortContentSize",value:function(){if(ie.viewPortSize&&ie.image){var e=ie.defaultRenderImageRect,t=Le.scale(ie.defaultRenderImageRect,he.getZoom());return{width:t.width+2*e.x,height:t.height+2*e.y}}return null}},{key:"calculateViewPortContentImageRect",value:function(){if(ie.viewPortSize&&ie.image){var t=ie.defaultRenderImageRect,n=e.calculateViewPortContentSize();return Object(j.a)(Object(j.a)({},t),{},{width:n.width-2*t.x,height:n.height-2*t.y})}return null}},{key:"resizeCanvas",value:function(e){e&&ie.canvas&&(ie.canvas.width=e.width,ie.canvas.height=e.height)}},{key:"resizeViewPortContent",value:function(){var t=e.calculateViewPortContentSize();t&&e.resizeCanvas(t)}},{key:"calculateAbsoluteScrollPosition",value:function(t){var n=e.calculateViewPortContentSize(),a=ie.viewPortSize;return{x:t.x*(n.width-a.width),y:t.y*(n.height-a.height)}}},{key:"getRelativeScrollPosition",value:function(){if(ie.viewPortScrollbars){var e=ie.viewPortScrollbars.getValues();return{x:e.left,y:e.top}}return null}},{key:"getAbsoluteScrollPosition",value:function(){if(ie.viewPortScrollbars){var e=ie.viewPortScrollbars.getValues();return{x:e.scrollLeft,y:e.scrollTop}}return null}},{key:"setScrollPosition",value:function(e){ie.viewPortScrollbars.scrollLeft(e.x),ie.viewPortScrollbars.scrollTop(e.y)}},{key:"translateViewPortPosition",value:function(t){if(!ie.viewPortActionsDisabled&&he.getZoom()!==Ee.MIN_ZOOM){var n=Te.convertDirectionToVector(t),a=se.multiply(n,Ee.TRANSLATION_STEP_PX),i=e.getAbsoluteScrollPosition(),o=se.add(i,a);e.setScrollPosition(o),ie.mousePositionOnViewPortContent=se.add(ie.mousePositionOnViewPortContent,a),Ne.fullRender()}}},{key:"zoomIn",value:function(){if(!ie.viewPortActionsDisabled){var t=he.getZoom(),n=e.getRelativeScrollPosition(),a=1===t?{x:.5,y:.5}:n;e.setZoom(t+Ee.ZOOM_STEP),e.resizeViewPortContent(),e.setScrollPosition(e.calculateAbsoluteScrollPosition(a)),Ne.fullRender()}}},{key:"zoomOut",value:function(){if(!ie.viewPortActionsDisabled){var t=he.getZoom(),n=e.getRelativeScrollPosition();e.setZoom(t-Ee.ZOOM_STEP),e.resizeViewPortContent(),e.setScrollPosition(e.calculateAbsoluteScrollPosition(n)),Ne.fullRender()}}},{key:"setDefaultZoom",value:function(){var t=e.getRelativeScrollPosition();e.setZoom(Ee.MIN_ZOOM),e.resizeViewPortContent(),e.setScrollPosition(e.calculateAbsoluteScrollPosition(t)),Ne.fullRender()}},{key:"setOneForOneZoom",value:function(){var t=he.getZoom(),n=e.getRelativeScrollPosition(),a=1===t?{x:.5,y:.5}:n,i=ie.image.width/ie.defaultRenderImageRect.width;e.setZoom(i),e.resizeViewPortContent(),e.setScrollPosition(e.calculateAbsoluteScrollPosition(a)),Ne.fullRender()}},{key:"setZoom",value:function(e){var t,n=he.getZoom();y.isValueInRange(e,Ee.MIN_ZOOM,Ee.MAX_ZOOM)&&e!==n&&wa.dispatch((t=e,{type:D.UPDATE_ZOOM,payload:{zoom:t}}))}}]),e}();!function(e){e.IMAGE_RECOGNITION="IMAGE_RECOGNITION",e.OBJECT_DETECTION="OBJECT_DETECTION"}(Pe||(Pe={}));var xe,we=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){return Object(d.a)(this,n),t.call(this,e)}return Object(h.a)(n,[{key:"mouseMoveHandler",value:function(e){}},{key:"mouseDownHandler",value:function(e){}},{key:"mouseUpHandler",value:function(e){}},{key:"render",value:function(e){this.drawImage(ie.image,Se.calculateViewPortContentImageRect()),this.renderCrossHair(e)}},{key:"renderCrossHair",value:function(e){var t=this;if(this.shouldRenderCrossHair(e)){var n=ve.setPointBetweenPixels(e.mousePositionOnViewPortContent),a=function(e,n){ce.drawLine(t.canvas,e,n,le.CROSS_HAIR_LINE_COLOR,2)};a({x:n.x,y:0},{x:n.x-1,y:n.y-le.crossHairPadding}),a({x:n.x,y:n.y+le.crossHairPadding},{x:n.x-1,y:e.viewPortContentSize.height}),a({x:0,y:n.y},{x:n.x-le.crossHairPadding,y:n.y-1}),a({x:n.x+le.crossHairPadding,y:n.y},{x:e.viewPortContentSize.width,y:n.y-1})}}},{key:"shouldRenderCrossHair",value:function(e){var t=he.getCrossHairVisibleStatus(),n=he.getImageDragModeStatus(),a=he.getProjectType(),i=he.getActivePopupType(),o=ve.isMouseOverCanvas(e),r=he.getPreventCustomCursorStatus();return[!!this.canvas,t,!n,a!==Pe.IMAGE_RECOGNITION,!i,o,!r].every(Boolean)}},{key:"drawImage",value:function(e,t){e&&this.canvas&&this.canvas.getContext("2d").drawImage(e,t.x,t.y,t.width,t.height)}},{key:"isInProgress",value:function(){return!1}}]),n}(fe),De=function(){function e(){Object(d.a)(this,e),this.startScrollPosition=void 0,this.mouseStartPosition=void 0}return Object(h.a)(e,[{key:"update",value:function(e){if(e.event)switch(be.getEventType(e.event)){case ue.MOUSE_MOVE:this.mouseMoveHandler(e);break;case ue.MOUSE_UP:this.mouseUpHandler(e);break;case ue.MOUSE_DOWN:this.mouseDownHandler(e)}}},{key:"mouseDownHandler",value:function(e){var t=e.event;this.startScrollPosition=e.absoluteViewPortContentScrollPosition,this.mouseStartPosition={x:t.screenX,y:t.screenY},wa.dispatch(te(oe.GRABBING)),ie.canvas.style.cursor="none"}},{key:"mouseUpHandler",value:function(e){this.startScrollPosition=null,this.mouseStartPosition=null,wa.dispatch(te(oe.GRAB)),ie.canvas.style.cursor="none"}},{key:"mouseMoveHandler",value:function(e){if(this.startScrollPosition&&this.mouseStartPosition){var t=e.event,n={x:t.screenX,y:t.screenY},a=se.subtract(n,this.mouseStartPosition),i=se.subtract(this.startScrollPosition,a);Se.setScrollPosition(i),wa.dispatch(te(oe.GRABBING))}else wa.dispatch(te(oe.GRAB));ie.canvas.style.cursor="none"}}]),e}();!function(e){e.START="START",e.END="END"}(xe||(xe={}));var Re=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).lineCreationStartPoint=void 0,a.lineUpdateAnchorType=void 0,a.startNewLabelCreation=function(e){a.lineCreationStartPoint=ve.setPointBetweenPixels(e.mousePositionOnViewPortContent),Ne.setViewPortActionsDisabledStatus(!0)},a.finishNewLabelCreation=function(e){var t=I.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),n={start:a.lineCreationStartPoint,end:t},i=ve.transferLineFromViewPortContentToImage(n,e),o=de.getActiveLabelNameId(),r=de.getActiveImageData(),c={id:Object(pe.a)(),labelId:o,line:i};r.labelLines.push(c),wa.dispatch(z(r.id,r)),wa.dispatch(W(!0)),wa.dispatch(B(c.id)),a.lineCreationStartPoint=null,Ne.setViewPortActionsDisabledStatus(!1)},a.labelType=b.LINE,a}return Object(h.a)(n,[{key:"mouseDownHandler",value:function(e){var t=ve.isMouseOverImage(e),n=ve.isMouseOverCanvas(e),a=this.getAnchorTypeUnderMouse(e),i=this.getLineUnderMouse(e);if(n)if(a&&!this.isResizeInProgress()){var o=this.getLineUnderMouse(e);this.startExistingLabelUpdate(o.id,a)}else i?wa.dispatch(B(i.id)):!this.isInProgress()&&t?this.startNewLabelCreation(e):this.isInProgress()&&this.finishNewLabelCreation(e)}},{key:"mouseUpHandler",value:function(e){this.isResizeInProgress()&&this.endExistingLabelUpdate(e)}},{key:"mouseMoveHandler",value:function(e){if(ve.isMouseOverImage(e)){var t=this.getLineUnderMouse(e);t?de.getHighlightedLabelId()!==t.id&&wa.dispatch(U(t.id)):null!==de.getHighlightedLabelId()&&wa.dispatch(U(null))}}},{key:"render",value:function(e){this.drawExistingLabels(e),this.drawActivelyCreatedLabel(e),this.drawActivelyResizeLabel(e),this.updateCursorStyle(e)}},{key:"drawExistingLabels",value:function(e){var t=this,n=de.getActiveLabelId(),a=de.getHighlightedLabelId();de.getActiveImageData().labelLines.forEach((function(i){var o=i.id===n||i.id===a,r=ve.transferLineFromImageToViewPortContent(i.line,e);i.id===n&&t.isResizeInProgress()||t.drawLine(i.labelId,r,o)}))}},{key:"drawActivelyCreatedLabel",value:function(e){if(this.isInProgress()){var t={start:this.lineCreationStartPoint,end:e.mousePositionOnViewPortContent};ce.drawLine(this.canvas,t.start,t.end,le.lineActiveColor,le.LINE_THICKNESS),ce.drawCircleWithFill(this.canvas,this.lineCreationStartPoint,g.RESIZE_HANDLE_DIMENSION_PX/2,le.defaultAnchorColor)}}},{key:"drawActivelyResizeLabel",value:function(e){var t=de.getActiveLineLabel();if(t&&this.isResizeInProgress()){var n=I.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),a=ve.transferLineFromImageToViewPortContent(t.line,e),i={start:this.lineUpdateAnchorType===xe.START?n:a.start,end:this.lineUpdateAnchorType===xe.END?n:a.end};this.drawLine(t.labelId,i,!0)}}},{key:"updateCursorStyle",value:function(e){if(this.canvas&&e.mousePositionOnViewPortContent&&!he.getImageDragModeStatus())if(ve.isMouseOverCanvas(e)){var t=this.getAnchorTypeUnderMouse(e);!this.isInProgress()&&t||this.isResizeInProgress()?wa.dispatch(te(oe.MOVE)):ve.wrapDefaultCursorStyleInCancel(e),this.canvas.style.cursor="none"}else this.canvas.style.cursor="default"}},{key:"drawLine",value:function(e,t,n){var a=this,i=fe.resolveLabelLineColor(e,n),o=fe.resolveLabelAnchorColor(n),r={start:ve.setPointBetweenPixels(t.start),end:ve.setPointBetweenPixels(t.end)};ce.drawLine(this.canvas,r.start,r.end,i,le.LINE_THICKNESS),n&&Oe.getPoints(t).forEach((function(e){return ce.drawCircleWithFill(a.canvas,e,g.RESIZE_HANDLE_DIMENSION_PX/2,o)}))}},{key:"isInProgress",value:function(){return!!this.lineCreationStartPoint}},{key:"isResizeInProgress",value:function(){return!!this.lineUpdateAnchorType}},{key:"isMouseOverAnchor",value:function(e,t){return e&&t?I.isPointInside(I.getRectWithCenterAndSize(t,le.anchorSize),e):null}},{key:"cancelLabelCreation",value:function(){this.lineCreationStartPoint=null,Ne.setViewPortActionsDisabledStatus(!1)}},{key:"startExistingLabelUpdate",value:function(e,t){wa.dispatch(B(e)),this.lineUpdateAnchorType=t,Ne.setViewPortActionsDisabledStatus(!0)}},{key:"endExistingLabelUpdate",value:function(e){this.applyUpdateToLineLabel(e),this.lineUpdateAnchorType=null,Ne.setViewPortActionsDisabledStatus(!1)}},{key:"applyUpdateToLineLabel",value:function(e){var t=this,n=de.getActiveImageData(),a=de.getActiveLineLabel();n.labelLines=n.labelLines.map((function(n){if(n.id!==a.id)return n;var i=I.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),o=ve.transferPointFromViewPortContentToImage(i,e);return Object(j.a)(Object(j.a)({},n),{},{line:{start:t.lineUpdateAnchorType===xe.START?o:n.line.start,end:t.lineUpdateAnchorType===xe.END?o:n.line.end}})})),wa.dispatch(z(n.id,n)),wa.dispatch(B(a.id))}},{key:"getLineUnderMouse",value:function(e){for(var t=de.getActiveImageData().labelLines,n=0;n<t.length;n++){var a=ve.transferLineFromImageToViewPortContent(t[n].line,e);if(ve.isMouseOverLine(e.mousePositionOnViewPortContent,a,le.anchorHoverSize.width/2))return t[n]}return null}},{key:"getAnchorTypeUnderMouse",value:function(e){for(var t=de.getActiveImageData().labelLines,n=0;n<t.length;n++){var a=ve.transferLineFromImageToViewPortContent(t[n].line,e);if(this.isMouseOverAnchor(e.mousePositionOnViewPortContent,a.start))return xe.START;if(this.isMouseOverAnchor(e.mousePositionOnViewPortContent,a.end))return xe.END}return null}}]),n}(fe),Ne=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"mountSupportRenderingEngine",value:function(e){switch(e){case b.RECT:ie.supportRenderingEngine=new je(ie.canvas);break;case b.POINT:ie.supportRenderingEngine=new Ie(ie.canvas);break;case b.LINE:ie.supportRenderingEngine=new Re(ie.canvas);break;case b.POLYGON:ie.supportRenderingEngine=new Ae(ie.canvas);break;default:ie.supportRenderingEngine=null}}},{key:"swapSupportRenderingEngine",value:function(t){e.mountSupportRenderingEngine(t)}},{key:"mountRenderEnginesAndHelpers",value:function(t){ie.viewPortHelper=new De,ie.primaryRenderingEngine=new we(ie.canvas),e.mountSupportRenderingEngine(t)}},{key:"fullRender",value:function(){ce.clearCanvas(ie.canvas),ie.primaryRenderingEngine.render(e.getEditorData()),ie.supportRenderingEngine&&ie.supportRenderingEngine.render(e.getEditorData())}},{key:"setLoadingStatus",value:function(e){ie.isLoading=e}},{key:"setActiveImage",value:function(e){ie.image=e}},{key:"setViewPortActionsDisabledStatus",value:function(e){ie.viewPortActionsDisabled=e}},{key:"getEditorData",value:function(e){return{mousePositionOnViewPortContent:ie.mousePositionOnViewPortContent,viewPortContentSize:ye.getSize(ie.canvas),activeKeyCombo:He.getActiveCombo(),event:e,zoom:he.getZoom(),viewPortSize:ie.viewPortSize,defaultRenderImageRect:ie.defaultRenderImageRect,viewPortContentImageRect:Se.calculateViewPortContentImageRect(),realImageSize:Ce.getSize(ie.image),absoluteViewPortContentScrollPosition:Se.getAbsoluteScrollPosition()}}},{key:"updateMousePositionIndicator",value:function(e){if(!ie.image||!ie.canvas)return ie.mousePositionIndicator.style.display="none",void(ie.cursor.style.display="none");var t=ye.getMousePositionOnCanvasFromEvent(e,ie.canvas),n=Se.getAbsoluteScrollPosition(),a=Se.calculateViewPortContentImageRect(),i=se.subtract(t,n),o=I.isPointInside(a,t);if(I.isPointInside(Object(j.a)({x:0,y:0},ie.viewPortSize),i)&&!he.getPreventCustomCursorStatus())if(ie.cursor.style.left=i.x+"px",ie.cursor.style.top=i.y+"px",ie.cursor.style.display="block",o&&![oe.GRAB,oe.GRABBING].includes(he.getCustomCursorStyle())){var r=Ce.getSize(ie.image).width/a.width,c=se.multiply(se.subtract(t,a),r),s="x: "+Math.round(c.x)+", y: "+Math.round(c.y);ie.mousePositionIndicator.innerHTML=s,ie.mousePositionIndicator.style.left=i.x+15+"px",ie.mousePositionIndicator.style.top=i.y+15+"px",ie.mousePositionIndicator.style.display="block"}else ie.mousePositionIndicator.style.display="none";else ie.cursor.style.display="none",ie.mousePositionIndicator.style.display="none"}}]),e}(),_e=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"getActions",value:function(){return this.actions}}]),e}();_e.actions=[];var ke=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"getPreviousImage",value:function(){var t=de.getActiveImageIndex();e.getImageByIndex(t-1)}},{key:"getNextImage",value:function(){var t=de.getActiveImageIndex();e.getImageByIndex(t+1)}},{key:"getImageByIndex",value:function(e){if(!ie.viewPortActionsDisabled){var t=de.getImagesData().length;e<0||e>t-1||(Se.setZoom(1),wa.dispatch(k(e)),wa.dispatch(B(null)))}}},{key:"setActiveLabelOnActiveImage",value:function(t){var n=de.getLabelNames();if(!(n.length<t+1)){var a=de.getActiveImageData();wa.dispatch(z(a.id,e.mapNewImageData(a,t))),wa.dispatch(M(n[1].id))}}},{key:"mapNewImageData",value:function(e,t){var n=de.getActiveLabelType(),a=de.getLabelNames(),i=Object(j.a)({},e);switch(n){case b.POINT:var o=de.getActivePointLabel();i.labelPoints=e.labelPoints.map((function(e){return e.id===o.id?Object(j.a)(Object(j.a)({},e),{},{labelId:a[t].id,status:ge.ACCEPTED}):e})),wa.dispatch(B(o.id));break;case b.LINE:var r=de.getActiveLineLabel();i.labelLines=e.labelLines.map((function(e){return e.id===r.id?Object(j.a)(Object(j.a)({},e),{},{labelId:a[t].id,status:ge.ACCEPTED}):e})),wa.dispatch(B(r.id));break;case b.RECT:var c=de.getActiveRectLabel();i.labelRects=e.labelRects.map((function(e){return e.id===c.id?Object(j.a)(Object(j.a)({},e),{},{labelId:a[t].id,status:ge.ACCEPTED}):e})),wa.dispatch(B(c.id));break;case b.POLYGON:var s=de.getActivePolygonLabel();i.labelPolygons=e.labelPolygons.map((function(e){return e.id===s.id?Object(j.a)(Object(j.a)({},e),{},{labelId:a[t].id,status:ge.ACCEPTED}):e})),wa.dispatch(B(s.id));break;case b.IMAGE_RECOGNITION:var l=a[t].id;e.labelNameIds.includes(l)?i.labelNameIds=Object(N.remove)(e.labelNameIds,(function(e){return e!==l})):i.labelNameIds=e.labelNameIds.concat(l)}return i}}]),e}(),Me=n(319),Be=n.n(Me),Ue=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"getMobileDeviceData",value:function(e){var t=new Be.a(e);return{manufacturer:t.mobile(),browser:t.userAgent(),os:t.os()}}},{key:"isMac",value:function(e){return!!e.toLowerCase().match("mac")}},{key:"isSafari",value:function(e){return!!e.toLowerCase().match("safari")}},{key:"isFirefox",value:function(e){return!!e.toLowerCase().match("firefox")}}]),e}(),Ve=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"deleteActiveLabel",value:function(){var t=de.getActiveImageData(),n=de.getActiveLabelId();e.deleteImageLabelById(t.id,n)}},{key:"deleteImageLabelById",value:function(t,n){switch(de.getActiveLabelType()){case b.POINT:e.deletePointLabelById(t,n);break;case b.RECT:e.deleteRectLabelById(t,n);break;case b.POLYGON:e.deletePolygonLabelById(t,n)}}},{key:"deleteRectLabelById",value:function(e,t){var n=de.getImageDataById(e),a=Object(j.a)(Object(j.a)({},n),{},{labelRects:Object(N.filter)(n.labelRects,(function(e){return e.id!==t}))});wa.dispatch(z(n.id,a))}},{key:"deletePointLabelById",value:function(e,t){var n=de.getImageDataById(e),a=Object(j.a)(Object(j.a)({},n),{},{labelPoints:Object(N.filter)(n.labelPoints,(function(e){return e.id!==t}))});wa.dispatch(z(n.id,a))}},{key:"deleteLineLabelById",value:function(e,t){var n=de.getImageDataById(e),a=Object(j.a)(Object(j.a)({},n),{},{labelLines:Object(N.filter)(n.labelLines,(function(e){return e.id!==t}))});wa.dispatch(z(n.id,a))}},{key:"deletePolygonLabelById",value:function(e,t){var n=de.getImageDataById(e),a=Object(j.a)(Object(j.a)({},n),{},{labelPolygons:Object(N.filter)(n.labelPolygons,(function(e){return e.id!==t}))});wa.dispatch(z(n.id,a))}},{key:"removeLabelNames",value:function(t){var n=de.getImagesData().map((function(n){return e.removeLabelNamesFromImageData(n,t)}));wa.dispatch(G(n))}},{key:"removeLabelNamesFromImageData",value:function(e,t){return Object(j.a)(Object(j.a)({},e),{},{labelRects:e.labelRects.map((function(e){return t.includes(e.id)?Object(j.a)(Object(j.a)({},e),{},{id:null}):e})),labelPoints:e.labelPoints.map((function(e){return t.includes(e.id)?Object(j.a)(Object(j.a)({},e),{},{id:null}):e})),labelPolygons:e.labelPolygons.map((function(e){return t.includes(e.id)?Object(j.a)(Object(j.a)({},e),{},{id:null}):e})),labelNameIds:e.labelNameIds.filter((function(e){return!t.includes(e)}))})}},{key:"labelExistsInLabelNames",value:function(e){return de.getLabelNames().map((function(e){return e.name})).includes(e)}}]),e}(),ze=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return n}(_e);ze.actions=[{keyCombo:["Enter"],action:function(e){if(ie.supportRenderingEngine&&ie.supportRenderingEngine.labelType===b.POLYGON){var t=Ne.getEditorData();ie.supportRenderingEngine.addLabelAndFinishCreation(t)}Ne.fullRender()}},{keyCombo:["Escape"],action:function(e){if(ie.supportRenderingEngine)switch(ie.supportRenderingEngine.labelType){case b.POLYGON:case b.LINE:ie.supportRenderingEngine.cancelLabelCreation()}Ne.fullRender()}},{keyCombo:Ue.isMac(window.navigator.userAgent)?["Alt","ArrowLeft"]:["Control","ArrowLeft"],action:function(e){ke.getPreviousImage()}},{keyCombo:Ue.isMac(window.navigator.userAgent)?["Alt","ArrowRight"]:["Control","ArrowRight"],action:function(e){ke.getNextImage()}},{keyCombo:Ue.isMac(window.navigator.userAgent)?["Alt","+"]:["Control","+"],action:function(e){Se.zoomIn()}},{keyCombo:Ue.isMac(window.navigator.userAgent)?["Alt","-"]:["Control","-"],action:function(e){Se.zoomOut()}},{keyCombo:["ArrowRight"],action:function(e){e.preventDefault(),Se.translateViewPortPosition(a.RIGHT)}},{keyCombo:["ArrowLeft"],action:function(e){e.preventDefault(),Se.translateViewPortPosition(a.LEFT)}},{keyCombo:["ArrowUp"],action:function(e){e.preventDefault(),Se.translateViewPortPosition(a.BOTTOM)}},{keyCombo:["ArrowDown"],action:function(e){e.preventDefault(),Se.translateViewPortPosition(a.TOP)}},{keyCombo:Ue.isMac(window.navigator.userAgent)?["Backspace"]:["Delete"],action:function(e){Ve.deleteActiveLabel()}},{keyCombo:Ue.isMac(window.navigator.userAgent)?["Alt","0"]:["Control","0"],action:function(e){ke.setActiveLabelOnActiveImage(0),Ne.fullRender()}},{keyCombo:Ue.isMac(window.navigator.userAgent)?["Alt","1"]:["Control","1"],action:function(e){ke.setActiveLabelOnActiveImage(1),Ne.fullRender()}},{keyCombo:Ue.isMac(window.navigator.userAgent)?["Alt","2"]:["Control","2"],action:function(e){ke.setActiveLabelOnActiveImage(2),Ne.fullRender()}},{keyCombo:Ue.isMac(window.navigator.userAgent)?["Alt","3"]:["Control","3"],action:function(e){ke.setActiveLabelOnActiveImage(3),Ne.fullRender()}},{keyCombo:Ue.isMac(window.navigator.userAgent)?["Alt","4"]:["Control","4"],action:function(e){ke.setActiveLabelOnActiveImage(4),Ne.fullRender()}},{keyCombo:Ue.isMac(window.navigator.userAgent)?["Alt","5"]:["Control","5"],action:function(e){ke.setActiveLabelOnActiveImage(5),Ne.fullRender()}},{keyCombo:Ue.isMac(window.navigator.userAgent)?["Alt","6"]:["Control","6"],action:function(e){ke.setActiveLabelOnActiveImage(6),Ne.fullRender()}},{keyCombo:Ue.isMac(window.navigator.userAgent)?["Alt","7"]:["Control","7"],action:function(e){ke.setActiveLabelOnActiveImage(7),Ne.fullRender()}},{keyCombo:Ue.isMac(window.navigator.userAgent)?["Alt","8"]:["Control","8"],action:function(e){ke.setActiveLabelOnActiveImage(8),Ne.fullRender()}},{keyCombo:Ue.isMac(window.navigator.userAgent)?["Alt","9"]:["Control","9"],action:function(e){ke.setActiveLabelOnActiveImage(9),Ne.fullRender()}}];var Fe=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"close",value:function(){wa.dispatch(ee(null)),He.restoreCtx()}}]),e}(),Ge=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return n}(_e);Ge.actions=[{keyCombo:["Escape"],action:function(e){var t=he.getActivePopupType();g.CLOSEABLE_POPUPS.includes(t)&&Fe.close()}}];var He=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"getActiveCombo",value:function(){return e.activeCombo}},{key:"init",value:function(){window.addEventListener(ue.KEY_DOWN,e.onDown),window.addEventListener(ue.KEY_UP,e.onUp),window.addEventListener(ue.FOCUS,e.onFocus)}},{key:"switchCtx",value:function(t){var n=he.getActiveContext();n!==t&&(e.contextHistory.push(n),e.updateCtx(t))}},{key:"updateCtx",value:function(t){var n;switch(wa.dispatch((n=t,{type:D.UPDATE_CONTEXT,payload:{activeContext:n}})),t){case Y.EDITOR:e.actions=ze.getActions();break;case Y.POPUP:e.actions=Ge.getActions();break;default:e.actions=[]}}},{key:"restoreCtx",value:function(){e.updateCtx(e.contextHistory.pop())}},{key:"onDown",value:function(t){var n=e.getKeyCodeFromEvent(t);e.isInCombo(n)||e.addToCombo(n),e.execute(t)}},{key:"onUp",value:function(t){var n=e.getKeyCodeFromEvent(t);e.removeFromCombo(n)}},{key:"onFocus",value:function(){e.activeCombo=[]}},{key:"execute",value:function(t){for(var n=0;n<e.actions.length;n++){var a=e.actions[n];e.matchCombo(e.activeCombo,a.keyCombo)&&a.action(t)}}},{key:"isInCombo",value:function(t){return e.activeCombo.indexOf(t)>=0}},{key:"addToCombo",value:function(t){e.activeCombo.push(t)}},{key:"removeFromCombo",value:function(t){var n=e.activeCombo.indexOf(t);n>=0&&e.activeCombo.splice(n,1)}},{key:"getKeyCodeFromEvent",value:function(e){return e.key}},{key:"matchCombo",value:function(e,t){return Object(N.isEmpty)(Object(N.xor)(e,t))}}]),e}();He.activeCombo=[],He.actions=[],He.contextHistory=[];var We=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).imagesListRef=void 0,a.updateListSize=function(){if(a.imagesListRef){var e=a.imagesListRef.getBoundingClientRect();a.setState({size:{width:e.width,height:e.height}})}},a.isImageChecked=function(e){var t=a.props.imagesData[e];switch(a.props.activeLabelType){case b.LINE:return t.labelLines.length>0;case b.IMAGE_RECOGNITION:return t.labelNameIds.length>0;case b.POINT:return t.labelPoints.filter((function(e){return e.status===ge.ACCEPTED})).length>0;case b.POLYGON:return t.labelPolygons.length>0;case b.RECT:return t.labelRects.filter((function(e){return e.status===ge.ACCEPTED})).length>0}},a.onClickHandler=function(e){ke.getImageByIndex(e)},a.renderImagePreview=function(e,t,n,i){return Object(A.jsx)($,{style:i,size:{width:150,height:150},isScrolling:t,isChecked:a.isImageChecked(e),imageData:a.props.imagesData[e],onClick:function(){return a.onClickHandler(e)},isSelected:a.props.activeImageIndex===e},e)},a.state={size:null},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.updateListSize(),window.addEventListener(ue.RESIZE,this.updateListSize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(ue.RESIZE,this.updateListSize)}},{key:"render",value:function(){var e=this,t=this.state.size;return Object(A.jsx)("div",{className:"ImagesList",ref:function(t){return e.imagesListRef=t},onClick:function(){return He.switchCtx(Y.LEFT_NAVBAR)},children:!!t&&Object(A.jsx)(E,{size:t,childSize:{width:150,height:150},childCount:this.props.imagesData.length,childRender:this.renderImagePreview,overScanHeight:200})})}}]),n}(o.a.Component),Ye=Object(l.b)((function(e){return{activeImageIndex:e.labels.activeImageIndex,imagesData:e.labels.imagesData,activeLabelType:e.labels.activeLabelType}}),{})(We),Ze=(n(446),[{labelType:b.IMAGE_RECOGNITION,headerText:"Image recognition",imageSrc:"ico/object.png",imageAlt:"object",projectType:Pe.IMAGE_RECOGNITION},{labelType:b.RECT,headerText:"Rect",imageSrc:"ico/rectangle.png",imageAlt:"rectangle",projectType:Pe.OBJECT_DETECTION},{labelType:b.POLYGON,headerText:"Polygon",imageSrc:"ico/polygon.png",imageAlt:"polygon",projectType:Pe.OBJECT_DETECTION}]),Xe=(n(447),n(448),n(449),i.forwardRef((function(e,t){var n=e.buttonSize,a=e.padding,i=e.image,o=e.imageAlt,r=e.href,c=e.onClick,s=e.style,l=e.isActive,u=e.isDisabled,d=e.externalClassName,g=a||10,b=Object(j.a)(Object(j.a)({},s),{},{width:n.width,height:n.height}),h={maxWidth:n.width-g,maxHeight:n.height-g};return Object(A.jsxs)("div",{className:S()("ImageButton",d,{active:l,disabled:u}),style:b,onClick:function(e){e.stopPropagation(),c&&c()},ref:t,children:[!!r&&Object(A.jsx)("a",{href:r,style:h,target:"_blank",rel:"noopener noreferrer",children:Object(A.jsx)("img",{draggable:!1,alt:o,src:i,style:h})}),!r&&Object(A.jsx)("img",{draggable:!1,alt:o,src:i,style:h})]})}))),Ke=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).dropdownOptionHeight=30,a.dropdownOptionCount=6,a.dropdownMargin=4,a.dropdownLabel=void 0,a.dropdown=void 0,a.openDropdown=function(){0===de.getLabelNames().length?a.props.updateActivePopupType(u.UPDATE_LABEL):(a.setState({isOpen:!0}),window.addEventListener(ue.MOUSE_DOWN,a.closeDropdown))},a.closeDropdown=function(e){var t={x:e.clientX,y:e.clientY},n=a.dropdown.getBoundingClientRect(),i={x:n.left,y:n.top,width:n.width,height:n.height};I.isPointInside(i,t)||(a.setState({isOpen:!1}),window.removeEventListener(ue.MOUSE_DOWN,a.closeDropdown))},a.getDropdownStyle=function(){var e=a.dropdownLabel.getBoundingClientRect(),t=Math.min(a.props.options.length,a.dropdownOptionCount)*a.dropdownOptionHeight,n={width:e.width,height:t,left:e.left};return 2*window.innerHeight/3<e.top?Object.assign(n,{top:e.top-a.dropdownMargin-t}):Object.assign(n,{top:e.bottom+a.dropdownMargin})},a.getDropdownOptions=function(){return a.props.options.map((function(e){return Object(A.jsx)("div",{className:"DropdownOption",style:{height:a.dropdownOptionHeight},onClick:function(t){return function(e,t){a.setState({isOpen:!1}),window.removeEventListener(ue.MOUSE_DOWN,a.closeDropdown),a.props.onSelectLabel(a.props.id,e),a.props.updateHighlightedLabelId(null),a.props.updateActiveLabelId(a.props.id),t.stopPropagation()}(e.id,t)},children:e.name},e.id)}))},a.mouseEnterHandler=function(){a.props.updateHighlightedLabelId(a.props.id)},a.mouseLeaveHandler=function(){a.props.updateHighlightedLabelId(null)},a.onClickHandler=function(){a.props.updateActiveLabelId(a.props.id)},a.state={animate:!1,isOpen:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this;requestAnimationFrame((function(){e.setState({animate:!0})}))}},{key:"getClassName",value:function(){return S()("LabelInputField",{loaded:this.state.animate,active:this.props.isActive,highlighted:this.props.isHighlighted})}},{key:"render",value:function(){var e=this,t=this.props,n=t.size,a=t.id,i=t.value,o=t.onDelete;return Object(A.jsx)("div",{className:this.getClassName(),style:{width:n.width,height:n.height},onMouseEnter:this.mouseEnterHandler,onMouseLeave:this.mouseLeaveHandler,onClick:this.onClickHandler,children:Object(A.jsxs)("div",{className:"LabelInputFieldWrapper",style:{width:n.width,height:n.height},children:[Object(A.jsx)("div",{className:"Marker"}),Object(A.jsxs)("div",{className:"Content",children:[Object(A.jsxs)("div",{className:"ContentWrapper",children:[Object(A.jsx)("div",{className:"DropdownLabel",ref:function(t){return e.dropdownLabel=t},onClick:this.openDropdown,children:i?i.name:"Select label"}),this.state.isOpen&&Object(A.jsx)("div",{className:"Dropdown",style:this.getDropdownStyle(),ref:function(t){return e.dropdown=t},children:Object(A.jsx)(p.a,{renderTrackHorizontal:function(e){return Object(A.jsx)("div",Object(j.a)(Object(j.a)({},e),{},{className:"track-horizontal"}))},children:Object(A.jsx)("div",{children:this.getDropdownOptions()})})})]}),Object(A.jsx)("div",{className:"ContentWrapper",children:Object(A.jsx)(Xe,{externalClassName:"trash",image:"ico/trash.png",imageAlt:"remove_rect",buttonSize:{width:30,height:30},onClick:function(){return o(a)}})})]})]})},a)}}]),n}(o.a.Component),Je={updateHighlightedLabelId:U,updateActiveLabelId:B,updateActivePopupType:ee},qe=Object(l.b)((function(e){return{}}),Je)(Ke),Qe=(n(450),Object(l.b)((function(e){return{firstLabelCreatedFlag:e.labels.firstLabelCreatedFlag}}),{})((function(e){var t=e.firstLabelCreatedFlag,n=e.labelBefore,a=e.labelAfter,i=Object(A.jsx)(A.Fragment,{children:Object(A.jsx)("p",{className:"extraBold",children:n})}),o=Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("img",{draggable:!1,alt:"no_labels",src:"ico/box-opened.png"}),Object(A.jsx)("p",{className:"extraBold",children:a})]});return Object(A.jsx)("div",{className:"EmptyLabelList",children:t?o:i})}))),$e={updateImageDataById:z,updateActiveLabelNameId:M,updateActiveLabelId:B},et=Object(l.b)((function(e){return{activeLabelId:e.labels.activeLabelId,highlightedLabelId:e.labels.highlightedLabelId,labelNames:e.labels.labels}}),$e)((function(e){var t=e.size,n=e.imageData,a=e.updateImageDataById,i=e.labelNames,o=e.updateActiveLabelNameId,r=e.activeLabelId,c=e.highlightedLabelId,s=e.updateActiveLabelId,l={width:t.width,height:t.height},u={width:t.width,height:40*n.labelRects.length},d=function(e){Ve.deleteRectLabelById(n.id,e)},g=function(e,t){var i=Object(j.a)(Object(j.a)({},n),{},{labelRects:n.labelRects.map((function(n){return n.id===e?Object(j.a)(Object(j.a)({},n),{},{labelId:t,status:ge.ACCEPTED}):n}))});a(n.id,i),o(t)};return Object(A.jsx)("div",{className:"RectLabelsList",style:l,onClickCapture:function(){s(null)},children:0===n.labelRects.filter((function(e){return e.status===ge.ACCEPTED})).length?Object(A.jsx)(Qe,{labelBefore:"draw your first bounding box",labelAfter:"no labels created for this image yet"}):Object(A.jsx)(p.a,{children:Object(A.jsx)("div",{className:"RectLabelsListContent",style:u,children:n.labelRects.filter((function(e){return e.status===ge.ACCEPTED})).map((function(e){return Object(A.jsx)(qe,{size:{width:t.width,height:40},isActive:e.id===r,isHighlighted:e.id===c,id:e.id,onDelete:d,value:null!==e.labelId?Object(N.findLast)(i,{id:e.labelId}):null,options:i,onSelectLabel:g},e.id)}))})})})})),tt=(n(451),{updateImageDataById:z,updateActiveLabelNameId:M,updateActiveLabelId:B}),nt=Object(l.b)((function(e){return{activeLabelId:e.labels.activeLabelId,highlightedLabelId:e.labels.highlightedLabelId,labelNames:e.labels.labels}}),tt)((function(e){var t=e.size,n=e.imageData,a=e.updateImageDataById,i=e.labelNames,o=e.updateActiveLabelNameId,r=e.activeLabelId,c=e.highlightedLabelId,s=e.updateActiveLabelId,l={width:t.width,height:t.height},u={width:t.width,height:40*n.labelPolygons.length},d=function(e){Ve.deletePolygonLabelById(n.id,e)},g=function(e,t){var i=Object(j.a)(Object(j.a)({},n),{},{labelPolygons:n.labelPolygons.map((function(n){return n.id===e?Object(j.a)(Object(j.a)({},n),{},{labelId:t}):n}))});a(n.id,i),o(t)};return Object(A.jsx)("div",{className:"PolygonLabelsList",style:l,onClickCapture:function(){s(null)},children:0===n.labelPolygons.length?Object(A.jsx)(Qe,{labelBefore:"draw your first polygon",labelAfter:"no labels created for this image yet"}):Object(A.jsx)(p.a,{children:Object(A.jsx)("div",{className:"PolygonLabelsListContent",style:u,children:n.labelPolygons.map((function(e){return Object(A.jsx)(qe,{size:{width:t.width,height:40},isActive:e.id===r,isHighlighted:e.id===c,id:e.id,onDelete:d,value:null!==e.labelId?Object(N.findLast)(i,{id:e.labelId}):null,options:i,onSelectLabel:g},e.id)}))})})})})),at=(n(452),{updateImageDataById:z,updateActivePopupType:ee}),it=Object(l.b)((function(e){return{labelNames:e.labels.labels}}),at)((function(e){var t=e.size,n=e.imageData,a=e.updateImageDataById,i=e.labelNames,o=e.updateActivePopupType,r={width:t.width,height:t.height},c={width:t.width,height:40*n.labelPolygons.length},s=function(){o(u.UPDATE_LABEL)};return Object(A.jsx)("div",{className:"TagLabelsList",style:r,children:0===i.length?Object(A.jsxs)("div",{className:"EmptyLabelList",onClick:s,children:[Object(A.jsx)("img",{draggable:!1,alt:"upload",src:"ico/type-writer.png"}),Object(A.jsx)("p",{className:"extraBold",children:"Your label list is empty"})]},"empty-label-list"):Object(A.jsx)(p.a,{children:Object(A.jsx)("div",{className:"TagLabelsListContent",style:c,children:[].concat(Object(R.a)(i.map((function(e){return Object(A.jsx)("div",{className:(t=e.id,S()("TagItem",{active:n.labelNameIds.includes(t)})),onClickCapture:function(){return function(e){n.labelNameIds.includes(e)?a(n.id,Object(j.a)(Object(j.a)({},n),{},{labelNameIds:Object(N.remove)(n.labelNameIds,(function(t){return t!==e}))})):a(n.id,Object(j.a)(Object(j.a)({},n),{},{labelNameIds:n.labelNameIds.concat(e)}))}(e.id)},children:e.name},e.id);var t}))),[Object(A.jsx)(Xe,{image:"ico/plus.png",imageAlt:"plus",buttonSize:{width:32,height:32},onClick:s})])},"tag-labels-list-content")})},"tag-labels-list")})),ot=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;Object(d.a)(this,n),(a=t.call(this,e)).labelsToolkitRef=void 0,a.tabs=void 0,a.updateToolkitSize=function(){if(a.labelsToolkitRef){var e=a.labelsToolkitRef.getBoundingClientRect();a.setState({size:{width:e.width,height:e.height}})}},a.headerClickHandler=function(e){a.props.updateActiveLabelType(e),a.props.updateActiveLabelId(null)},a.renderChildren=function(){var e=a.state.size,t=a.props,n=t.activeImageIndex,i=t.imagesData,o=t.activeLabelType;return a.tabs.reduce((function(t,r,c){var s=r===o,l=Object(N.find)(Ze,{labelType:r}),u=e.height-a.tabs.length*g.TOOLKIT_TAB_HEIGHT_PX,d=function(e){return S()(e,{active:s})},h=Object(A.jsxs)("div",{className:d("Header"),onClick:function(){return a.headerClickHandler(r)},style:{height:g.TOOLKIT_TAB_HEIGHT_PX},children:[Object(A.jsx)("div",{className:"Marker"}),Object(A.jsxs)("div",{className:"HeaderGroupWrapper",children:[Object(A.jsx)("img",{draggable:!1,className:"Ico",src:l.imageSrc,alt:l.imageAlt}),l.headerText]}),Object(A.jsx)("div",{className:"HeaderGroupWrapper",children:Object(A.jsx)("img",{draggable:!1,className:"Arrow",src:"ico/down.png",alt:"down_arrow"})})]},"Header_"+c),f=Object(A.jsxs)("div",{className:d("Content"),style:{height:s?u:0},children:[r===b.RECT&&Object(A.jsx)(et,{size:{width:e.width-20,height:u-20},imageData:i[n]}),r===b.POLYGON&&Object(A.jsx)(nt,{size:{width:e.width-20,height:u-20},imageData:i[n]}),r===b.IMAGE_RECOGNITION&&Object(A.jsx)(it,{size:{width:e.width-20,height:u-20},imageData:i[n]})]},"Content_"+c);return t.push([h,f]),t}),[])},a.state={size:null},a.tabs=e.projectType===Pe.IMAGE_RECOGNITION?[b.IMAGE_RECOGNITION]:[b.RECT,b.POLYGON];var i=e.activeLabelType?e.activeLabelType:a.tabs[0];return e.updateActiveLabelType(i),a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.updateToolkitSize(),window.addEventListener(ue.RESIZE,this.updateToolkitSize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(ue.RESIZE,this.updateToolkitSize)}},{key:"render",value:function(){var e=this;return Object(A.jsx)("div",{className:"LabelsToolkit",ref:function(t){return e.labelsToolkitRef=t},onClick:function(){return He.switchCtx(Y.RIGHT_NAVBAR)},children:this.state.size&&this.renderChildren()})}}]),n}(o.a.Component),rt={updateImageDataById:z,updateActiveLabelType:V,updateActiveLabelId:B},ct=Object(l.b)((function(e){return{activeImageIndex:e.labels.activeImageIndex,activeLabelType:e.labels.activeLabelType,imagesData:e.labels.imagesData,projectType:e.general.projectData.type}}),rt)(ot),st=(n(453),function(e){var t=e.direction,n=e.isOpen,i=e.isWithContext,o=e.renderContent,r=e.renderCompanion;return Object(A.jsxs)("div",{className:S()("SideNavigationBar",{left:t===a.LEFT,right:t===a.RIGHT,"with-context":i,closed:!n}),children:[Object(A.jsx)("div",{className:"CompanionBar",children:r&&r()}),n&&Object(A.jsx)("div",{className:"NavigationBarContentWrapper",children:o&&o()})]})}),lt=(n(454),function(e){var t=e.key,n=e.label,a=e.onClick,i=e.style,o=e.isActive,r=e.isDisabled,c=e.image,s=e.imageAlt;return Object(A.jsxs)("div",{className:S()("VerticalEditorButton",{active:o,disabled:r}),onClick:a||void 0,style:i,children:[c&&Object(A.jsx)("img",{draggable:!1,alt:s,src:c}),n]},t)}),ut=(n(455),n(456),function e(){Object(d.a)(this,e)});ut.getIndicator=function(e){switch(e){case oe.ADD:return"ico/plus.png";case oe.RESIZE:return"ico/resize.png";case oe.CLOSE:return"ico/close.png";case oe.MOVE:return"ico/move.png";case oe.CANCEL:return"ico/cancel.png";case oe.GRAB:return"ico/hand-fill.png";case oe.GRABBING:return"ico/hand-fill-grab.png";default:return null}},ut.getCursorStyle=function(e){return S()("Cursor",{move:e===oe.MOVE,add:e===oe.ADD,resize:e===oe.RESIZE,close:e===oe.CLOSE,cancel:e===oe.CANCEL,grab:e===oe.GRAB,grabbing:e===oe.GRABBING})};var dt=function e(){Object(d.a)(this,e)};dt.mobileDeviceData=void 0,dt.isMac=void 0,dt.isSafari=void 0,dt.isFirefox=void 0;n(457);var gt={updatePreventCustomCursorStatus:ne,updateImageDataById:z},bt=Object(l.b)((function(e){return{activeLabelId:e.labels.activeLabelId,highlightedLabelId:e.labels.highlightedLabelId}}),gt)((function(e){var t=e.position,n=e.updatePreventCustomCursorStatus,a=e.activeLabelId,o=e.highlightedLabelId,r=e.labelData,c=e.imageData,l=e.updateImageDataById,u=Object(i.useState)(!1),d=Object(s.a)(u,2),g=d[0],b=d[1],h=function(){return g||r.id===a||r.id===o};return Object(A.jsx)("div",{className:S()("LabelControlPanel",{"is-active":h()}),style:{top:t.y,left:t.x},onMouseEnter:function(){n(!0),b(!0)},onMouseLeave:function(){n(!1),b(!1)},children:h()&&Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(Xe,{image:"ico/plus.png",imageAlt:"plus",buttonSize:{width:30,height:30},padding:15,onClick:function(){var e=Object(j.a)(Object(j.a)({},c),{},{labelRects:c.labelRects.map((function(e){if(e.id===r.id){var t=Object(N.findLast)(de.getLabelNames(),{name:e.suggestedLabel});return Object(j.a)(Object(j.a)({},e),{},{status:ge.ACCEPTED,labelId:t?t.id:e.labelId})}return e})),labelPoints:c.labelPoints.map((function(e){if(e.id===r.id){var t=Object(N.findLast)(de.getLabelNames(),{name:e.suggestedLabel});return Object(j.a)(Object(j.a)({},e),{},{status:ge.ACCEPTED,labelId:t?t.id:e.labelId})}return e})),labelPolygons:c.labelPolygons.map((function(e){if(e.id===r.id){var t=Object(N.findLast)(de.getLabelNames(),{name:e.suggestedLabel});return Object(j.a)(Object(j.a)({},e),{},{status:ge.ACCEPTED,labelId:t?t.id:e.labelId})}return e}))});l(c.id,e),n(!1)}}),Object(A.jsx)(Xe,{image:"ico/trash.png",imageAlt:"trash",buttonSize:{width:30,height:30},padding:15,onClick:function(){Ve.deleteImageLabelById(c.id,r.id),n(!1)}}),r.suggestedLabel&&Ve.labelExistsInLabelNames(r.suggestedLabel)?Object(A.jsx)("div",{className:"SuggestedLabel",children:r.suggestedLabel}):null]})})}));n(240);function ht(e){return{type:D.UPDATE_SUGGESTED_LABEL_LIST,payload:{labelList:e}}}var ft=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"loadModel",value:function(e){var t;console.log("I am here fucker"),wa.dispatch((t=!0,{type:D.UPDATE_FORM_DETECTOR_STATUS,payload:{isFormDetectorLoaded:t}})),wa.dispatch(V(b.RECT)),de.getActiveLabelType()===b.RECT&&Ot.detectRectsForActiveImage(),e&&e()}},{key:"predict",value:function(e,t){function n(){return(n=Object(L.a)(C.a.mark((function e(t){var n,a,i,o;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.createElement("canvas"),a=n.getContext("2d"),n.width=t.width,n.height=t.height,a.drawImage(t,0,0,t.width,t.height),i=new Blob,console.log(i),e.next=9,new Promise((function(e){return n.toBlob(e,"image/png")}));case 9:return i=e.sent,console.log(i),(o=new FormData).append("image",i,"image.png"),console.log("formdata",o),console.log(o.get("image")),e.next=17,fetch("/upload",{method:"POST",body:o});case 17:e.sent;case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(e){return n.apply(this,arguments)})(e).then((function(){fetch("/prediction").then((function(e){return e.json()})).then((function(e){console.log("preds"),console.log(e),t&&t(e)})).catch((function(e){throw new Error(e)}))}))}}]),e}(),Ot=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"detectRectsForActiveImage",value:function(){var t=de.getActiveImageData();e.detectRects(t.id,_.getById(t.id))}},{key:"detectRects",value:function(t,n){!de.getImageDataById(t).isVisitedByFormDetector&&K.isAIFormDetectorModelLoaded()&&(wa.dispatch(ee(u.LOADER)),ft.predict(n,(function(n){var a=e.extractNewSuggestedLabelNames(de.getLabelNames(),n),i=K.getRejectedSuggestedLabelList(),o=At.excludeRejectedLabelNames(a,i);o.length>0?(wa.dispatch(ht(o)),wa.dispatch(ee(u.SUGGEST_LABEL_NAMES))):wa.dispatch(ee(null)),e.saveRectPredictions(t,n)})))}},{key:"saveRectPredictions",value:function(t,n){var a=de.getImageDataById(t),i=e.mapPredictionsToRectLabels(n),o=Object(j.a)(Object(j.a)({},a),{},{labelRects:a.labelRects.concat(i),isVisitedByFormDetector:!0});wa.dispatch(z(a.id,o))}},{key:"mapPredictionsToRectLabels",value:function(e){return e.map((function(e){return{id:Object(pe.a)(),labelIndex:null,labelId:null,rect:{x:e.bbox[0],y:e.bbox[1],width:e.bbox[2],height:e.bbox[3]},isCreatedByAI:!0,status:ge.UNDECIDED,suggestedLabel:e.class}}))}},{key:"extractNewSuggestedLabelNames",value:function(e,t){return t.reduce((function(t,n){return t.includes(n.class)||Object(N.findLast)(e,{name:n.class})||t.push(n.class),t}),[])}},{key:"acceptAllSuggestedRectLabels",value:function(e){var t=Object(j.a)(Object(j.a)({},e),{},{labelRects:e.labelRects.map((function(e){var t=Object(N.findLast)(de.getLabelNames(),{name:e.suggestedLabel});return Object(j.a)(Object(j.a)({},e),{},{status:ge.ACCEPTED,labelId:t?t.id:e.labelId})}))});wa.dispatch(z(t.id,t))}},{key:"rejectAllSuggestedRectLabels",value:function(e){var t=Object(j.a)(Object(j.a)({},e),{},{labelRects:e.labelRects.filter((function(e){return e.status===ge.ACCEPTED}))});wa.dispatch(z(t.id,t))}}]),e}(),vt=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"loadModel",value:function(e){var t;console.log("I am in mask fucker"),wa.dispatch((t=!0,{type:D.UPDATE_MASK_DETECTOR_STATUS,payload:{isMaskDetectorLoaded:t}})),wa.dispatch(V(b.POLYGON)),de.getActiveLabelType()===b.POLYGON&&pt.detectPolygonsForActiveImage(),e&&e()}},{key:"predict",value:function(e,t){function n(){return(n=Object(L.a)(C.a.mark((function e(t){var n,a,i,o;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.createElement("canvas"),a=n.getContext("2d"),n.width=t.width,n.height=t.height,a.drawImage(t,0,0,t.width,t.height),i=new Blob,console.log(i),e.next=9,new Promise((function(e){return n.toBlob(e,"image/png")}));case 9:return i=e.sent,console.log(i),(o=new FormData).append("image",i,"image.png"),console.log("formdata",o),console.log(o.get("image")),e.next=17,fetch("/upload",{method:"POST",body:o});case 17:e.sent;case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(e){return n.apply(this,arguments)})(e).then((function(){fetch("/mask").then((function(e){return e.json()})).then((function(e){console.log("preds"),console.log(e),t&&t(e)})).catch((function(e){throw new Error(e)}))}))}}]),e}(),pt=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"detectPolygonsForActiveImage",value:function(){var t=de.getActiveImageData();e.detectPolygons(t.id,_.getById(t.id))}},{key:"detectPolygons",value:function(t,n){!de.getImageDataById(t).isVisitedByMaskDetector&&K.isAIMaskDetectorModelLoaded()&&(wa.dispatch(ee(u.LOADER)),vt.predict(n,(function(n){var a=e.extractNewSuggestedLabelNames(de.getLabelNames(),n),i=K.getRejectedSuggestedLabelList(),o=At.excludeRejectedLabelNames(a,i);o.length>0?(wa.dispatch(ht(o)),wa.dispatch(ee(u.SUGGEST_LABEL_NAMES))):wa.dispatch(ee(null)),e.savePolygonPredictions(t,n)})))}},{key:"savePolygonPredictions",value:function(t,n){var a=de.getImageDataById(t),i=e.mapPredictionsToPolygonLabels(n),o=Object(j.a)(Object(j.a)({},a),{},{labelPolygons:a.labelPolygons.concat(i),isVisitedByMaskDetector:!0});wa.dispatch(z(a.id,o))}},{key:"mapPredictionsToPolygonLabels",value:function(e){return e.map((function(e){return{id:Object(pe.a)(),labelIndex:null,labelId:null,vertices:e.vertices,isCreatedByAI:!0,status:ge.UNDECIDED,suggestedLabel:e.class}}))}},{key:"extractNewSuggestedLabelNames",value:function(e,t){return t.reduce((function(t,n){return t.includes(n.class)||Object(N.findLast)(e,{name:n.class})||t.push(n.class),t}),[])}},{key:"acceptAllSuggestedPolygonLabels",value:function(e){var t=Object(j.a)(Object(j.a)({},e),{},{labelPolygons:e.labelPolygons.map((function(e){var t=Object(N.findLast)(de.getLabelNames(),{name:e.suggestedLabel});return Object(j.a)(Object(j.a)({},e),{},{status:ge.ACCEPTED,labelId:t?t.id:e.labelId})}))});wa.dispatch(z(t.id,t))}},{key:"rejectAllSuggestedPolygonLabels",value:function(e){var t=Object(j.a)(Object(j.a)({},e),{},{labelPolygons:e.labelPolygons.filter((function(e){return e.status===ge.ACCEPTED}))});wa.dispatch(z(t.id,t))}}]),e}(),mt=(n(528),n(351)),jt=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"loadModel",value:function(t){mt.a({architecture:"ResNet50",outputStride:32,inputResolution:257,quantBytes:2}).then((function(n){var a;e.model=n,wa.dispatch((a=!0,{type:D.UPDATE_POSE_DETECTOR_STATUS,payload:{isPoseDetectorLoaded:a}})),wa.dispatch(V(b.POINT)),de.getActiveLabelType()===b.POINT&&It.detectPoseForActiveImage(),t&&t()})).catch((function(e){throw new Error(e)}))}},{key:"predict",value:function(t,n){e.model&&e.model.estimateMultiplePoses(t).then((function(e){n&&n(e)})).catch((function(e){throw new Error(e)}))}}]),e}();jt.model=void 0;var yt,It=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"detectPoseForActiveImage",value:function(){var t=de.getActiveImageData();e.detectPoses(t.id,_.getById(t.id))}},{key:"detectPoses",value:function(t,n){!de.getImageDataById(t).isVisitedByPoseDetector&&K.isAIPoseDetectorModelLoaded()&&(wa.dispatch(ee(u.LOADER)),jt.predict(n,(function(a){var i=e.extractNewSuggestedLabelNames(de.getLabelNames(),a),o=K.getRejectedSuggestedLabelList(),r=At.excludeRejectedLabelNames(i,o);r.length>0?(wa.dispatch(ht(r)),wa.dispatch(ee(u.SUGGEST_LABEL_NAMES))):wa.dispatch(ee(null)),e.savePosePredictions(t,a,n)})))}},{key:"savePosePredictions",value:function(t,n,a){var i=de.getImageDataById(t),o=e.mapPredictionsToPointLabels(n).filter((function(e){return y.isValueInRange(e.point.x,0,a.width)})).filter((function(e){return y.isValueInRange(e.point.y,0,a.height)})),r=Object(j.a)(Object(j.a)({},i),{},{labelPoints:i.labelPoints.concat(o),isVisitedByPoseDetector:!0});wa.dispatch(z(i.id,r))}},{key:"mapPredictionsToPointLabels",value:function(e){return e.map((function(e){return e.keypoints.map((function(e){return{id:Object(pe.a)(),labelIndex:null,labelId:null,point:{x:e.position.x,y:e.position.y},isCreatedByAI:!0,status:ge.UNDECIDED,suggestedLabel:e.part}}))})).reduce((function(e,t){return e.concat(t)}),[])}},{key:"extractNewSuggestedLabelNames",value:function(e,t){return t.map((function(e){return e.keypoints})).reduce((function(e,t){return e.concat(t)}),[]).map((function(e){return e.part})).reduce((function(t,n){return t.includes(n)||Object(N.findLast)(e,{name:n})||t.push(n),t}),[])}},{key:"acceptAllSuggestedPointLabels",value:function(e){var t=Object(j.a)(Object(j.a)({},e),{},{labelPoints:e.labelPoints.map((function(e){var t=Object(N.findLast)(de.getLabelNames(),{name:e.suggestedLabel});return Object(j.a)(Object(j.a)({},e),{},{status:ge.ACCEPTED,labelId:t?t.id:e.labelId})}))});wa.dispatch(z(t.id,t))}},{key:"rejectAllSuggestedPointLabels",value:function(e){var t=Object(j.a)(Object(j.a)({},e),{},{labelPoints:e.labelPoints.filter((function(e){return e.status===ge.ACCEPTED}))});wa.dispatch(z(t.id,t))}}]),e}(),At=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"excludeRejectedLabelNames",value:function(e,t){return e.reduce((function(e,n){return t.includes(n)||e.push(n),e}),[])}},{key:"detect",value:function(e,t){switch(de.getActiveLabelType()){case b.RECT:Ot.detectRects(e,t);break;case b.POINT:It.detectPoses(e,t);break;case b.POLYGON:pt.detectPolygons(e,t)}}},{key:"rejectAllSuggestedLabels",value:function(e){switch(de.getActiveLabelType()){case b.RECT:Ot.rejectAllSuggestedRectLabels(e);break;case b.POINT:It.rejectAllSuggestedPointLabels(e);break;case b.POLYGON:pt.rejectAllSuggestedPolygonLabels(e)}}},{key:"acceptAllSuggestedLabels",value:function(e){switch(de.getActiveLabelType()){case b.RECT:Ot.acceptAllSuggestedRectLabels(e);break;case b.POINT:It.acceptAllSuggestedPointLabels(e);break;case b.POLYGON:pt.acceptAllSuggestedPolygonLabels(e)}}}]),e}(),Et=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).loadImage=function(){var e=Object(L.a)(C.a.mark((function e(t){var n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.loadStatus?(Ne.setActiveImage(_.getById(t.id)),At.detect(t.id,_.getById(t.id)),a.updateModelAndRender()):ie.isLoading||(Ne.setLoadingStatus(!0),n=function(e){return a.saveLoadedImage(e,t)},X.loadImage(t.fileData).then((function(e){return n(e)})).catch((function(e){return a.handleLoadImageError()})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.saveLoadedImage=function(e,t){t.loadStatus=!0,a.props.updateImageDataById(t.id,t),_.storeImage(t.id,e),Ne.setActiveImage(e),At.detect(t.id,e),Ne.setLoadingStatus(!1),a.updateModelAndRender()},a.handleLoadImageError=function(){},a.updateModelAndRender=function(){Se.updateViewPortSize(),Se.updateDefaultViewPortImageRect(),Se.resizeViewPortContent(),Ne.fullRender()},a.update=function(e){var t=Ne.getEditorData(e);ie.mousePositionOnViewPortContent=ye.getMousePositionOnCanvasFromEvent(e,ie.canvas),ie.primaryRenderingEngine.update(t),a.props.imageDragMode?ie.viewPortHelper.update(t):ie.supportRenderingEngine&&ie.supportRenderingEngine.update(t),!a.props.activePopupType&&Ne.updateMousePositionIndicator(e),Ne.fullRender()},a.handleZoom=function(e){if(e.ctrlKey||dt.isMac&&e.metaKey){var t=Math.sign(e.deltaY);dt.isMac&&-1===t||!dt.isMac&&1===t?Se.zoomOut():(dt.isMac&&1===t||!dt.isMac&&-1===t)&&Se.zoomIn()}ie.mousePositionOnViewPortContent=ye.getMousePositionOnCanvasFromEvent(e,ie.canvas)},a.getOptionsPanels=function(){var e=Ne.getEditorData();return a.props.activeLabelType===b.RECT?a.props.imageData.labelRects.filter((function(e){return e.isCreatedByAI&&e.status!==ge.ACCEPTED})).map((function(t){var n={x:t.rect.x,y:t.rect.y},i=ve.transferPointFromImageToViewPortContent(n,e);return Object(A.jsx)(bt,{position:i,labelData:t,imageData:a.props.imageData},t.id)})):a.props.activeLabelType===b.POINT?a.props.imageData.labelPoints.filter((function(e){return e.isCreatedByAI&&e.status!==ge.ACCEPTED})).map((function(t){var n={x:t.point.x,y:t.point.y},i=ve.transferPointFromImageToViewPortContent(n,e);return Object(A.jsx)(bt,{position:i,labelData:t,imageData:a.props.imageData},t.id)})):a.props.activeLabelType===b.POLYGON?a.props.imageData.labelPolygons.filter((function(e){return e.isCreatedByAI&&e.status!==ge.ACCEPTED})).map((function(t){var n={x:t.vertices[0].x,y:t.vertices[0].y},i=ve.transferPointFromImageToViewPortContent(n,e);return Object(A.jsx)(bt,{position:i,labelData:t,imageData:a.props.imageData},t.id)})):null},a.onScrollbarsUpdate=function(e){var t={width:e.scrollWidth,height:e.scrollHeight};Object(N.isEqual)(t,a.state.viewPortSize)||a.setState({viewPortSize:t})},a.state={viewPortSize:{width:0,height:0}},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.mountEventListeners();var e=this.props,t=e.imageData,n=e.activeLabelType;He.switchCtx(Y.EDITOR),Ne.mountRenderEnginesAndHelpers(n),w.addAndRun(this.loadImage(t)),Se.resizeCanvas(this.props.size)}},{key:"componentWillUnmount",value:function(){this.unmountEventListeners()}},{key:"componentDidUpdate",value:function(e,t,n){var a=this.props,i=a.imageData,o=a.activeLabelType;e.imageData.id!==i.id&&w.addAndRun(this.loadImage(i)),e.activeLabelType!==o&&(Ne.swapSupportRenderingEngine(o),At.detect(i.id,_.getById(i.id))),this.updateModelAndRender()}},{key:"mountEventListeners",value:function(){window.addEventListener(ue.MOUSE_MOVE,this.update),window.addEventListener(ue.MOUSE_UP,this.update),ie.canvas.addEventListener(ue.MOUSE_DOWN,this.update),ie.canvas.addEventListener(ue.MOUSE_WHEEL,this.handleZoom)}},{key:"unmountEventListeners",value:function(){window.removeEventListener(ue.MOUSE_MOVE,this.update),window.removeEventListener(ue.MOUSE_UP,this.update),ie.canvas.removeEventListener(ue.MOUSE_DOWN,this.update),ie.canvas.removeEventListener(ue.MOUSE_WHEEL,this.handleZoom)}},{key:"render",value:function(){return Object(A.jsxs)("div",{className:"Editor",ref:function(e){return ie.editor=e},draggable:!1,children:[Object(A.jsx)(p.a,{ref:function(e){return ie.viewPortScrollbars=e},renderTrackHorizontal:function(e){return Object(A.jsx)("div",Object(j.a)(Object(j.a)({},e),{},{className:"track-horizontal"}))},renderTrackVertical:function(e){return Object(A.jsx)("div",Object(j.a)(Object(j.a)({},e),{},{className:"track-vertical"}))},onUpdate:this.onScrollbarsUpdate,children:Object(A.jsxs)("div",{className:"ViewPortContent",children:[Object(A.jsx)("canvas",{className:"ImageCanvas",ref:function(e){return ie.canvas=e},draggable:!1,onContextMenu:function(e){return e.preventDefault()}}),this.getOptionsPanels()]})}),Object(A.jsx)("div",{className:"MousePositionIndicator",ref:function(e){return ie.mousePositionIndicator=e},draggable:!1}),Object(A.jsx)("div",{className:ut.getCursorStyle(this.props.customCursorStyle),ref:function(e){return ie.cursor=e},draggable:!1,children:Object(A.jsx)("img",{draggable:!1,alt:"indicator",src:ut.getIndicator(this.props.customCursorStyle)})})]})}}]),n}(o.a.Component),Pt={updateImageDataById:z},Ct=Object(l.b)((function(e){return{activeLabelType:e.labels.activeLabelType,activePopupType:e.general.activePopupType,activeLabelId:e.labels.activeLabelId,customCursorStyle:e.general.customCursorStyle,imageDragMode:e.general.imageDragMode,zoom:e.general.zoom}}),Pt)(Et),Lt=(n(473),Object(l.b)((function(e){return{activeImageIndex:e.labels.activeImageIndex,activeContext:e.general.activeContext}}),{})((function(e){var t=e.size,n=e.imageData,a=e.totalImageCount,i=e.activeImageIndex,o=e.activeContext;return Object(A.jsxs)("div",{className:S()("EditorBottomNavigationBar",{"with-context":o===Y.EDITOR}),children:[Object(A.jsx)(Xe,{image:"ico/left.png",imageAlt:"previous",buttonSize:{width:25,height:25},onClick:function(){return ke.getPreviousImage()},isDisabled:0===i,externalClassName:"left"}),t.width>400?Object(A.jsxs)("div",{className:"CurrentImageName",children:[" ",n.fileData.name," "]}):Object(A.jsxs)("div",{className:"CurrentImageCount",children:[" ",i+1+" / "+a," "]}),Object(A.jsx)(Xe,{image:"ico/right.png",imageAlt:"next",buttonSize:{width:25,height:25},onClick:function(){return ke.getNextImage()},isDisabled:i===a-1,externalClassName:"right"})]})}))),Tt=(n(474),n(225)),St=n.n(Tt),xt=n(558),wt=n(555),Dt={width:30,height:30},Rt=St()((function(e){return{tooltip:{backgroundColor:"#171717",color:"#ffffff",boxShadow:e.shadows[1],fontSize:12,maxWidth:200,textAlign:"center"}}}))(xt.a),Nt=function(e,t,n,a,i,o,r){return Object(A.jsx)(Rt,{disableFocusListener:!0,title:t,TransitionComponent:wt.a,TransitionProps:{timeout:600},placement:"bottom",children:Object(A.jsx)("div",{children:Object(A.jsx)(Xe,{buttonSize:Dt,padding:10,image:n,imageAlt:a,href:o,onClick:r,isActive:i})})},e)},_t={updateImageDragModeStatusAction:function(e){return{type:D.UPDATE_IMAGE_DRAG_MODE_STATUS,payload:{imageDragMode:e}}},updateCrossHairVisibleStatusAction:function(e){return{type:D.UPDATE_CROSS_HAIR_VISIBLE_STATUS,payload:{crossHairVisible:e}}}},kt=Object(l.b)((function(e){return{activeContext:e.general.activeContext,imageDragMode:e.general.imageDragMode,crossHairVisible:e.general.crossHairVisible,activeLabelType:e.labels.activeLabelType}}),_t)((function(e){var t=e.activeContext,n=e.updateImageDragModeStatusAction,a=e.updateCrossHairVisibleStatusAction,i=e.imageDragMode,o=e.crossHairVisible,r=e.activeLabelType;return Object(A.jsxs)("div",{className:S()("EditorTopNavigationBar",{"with-context":t===Y.EDITOR}),children:[Object(A.jsxs)("div",{className:"ButtonWrapper",children:[Nt("zoom-in","zoom in","ico/zoom-in.png","zoom-in",!1,void 0,(function(){return Se.zoomIn()})),Nt("zoom-out","zoom out","ico/zoom-out.png","zoom-out",!1,void 0,(function(){return Se.zoomOut()})),Nt("zoom-fit","fit image to available space","ico/zoom-fit.png","zoom-fit",!1,void 0,(function(){return Se.setDefaultZoom()})),Nt("zoom-max","maximum allowed image zoom","ico/zoom-max.png","zoom-max",!1,void 0,(function(){return Se.setOneForOneZoom()}))]}),Object(A.jsxs)("div",{className:"ButtonWrapper",children:[Nt("image-drag-mode",i?"turn-off image drag mode":"turn-on image drag mode - works only when image is zoomed","ico/hand.png","image-drag-mode",i,void 0,(function(){(i||he.getZoom()!==Ee.MIN_ZOOM)&&n(!i)})),Nt("cursor-cross-hair",o?"turn-off cursor cross-hair":"turn-on cursor cross-hair","ico/cross-hair.png","cross-hair",o,void 0,(function(){a(!o)}))]}),(r===b.RECT&&K.isAIObjectDetectorModelLoaded()||r===b.POLYGON&&K.isAIMaskDetectorModelLoaded()||r===b.RECT&&K.isAIFormDetectorModelLoaded()||r===b.POINT&&K.isAIPoseDetectorModelLoaded())&&Object(A.jsxs)("div",{className:"ButtonWrapper",children:[Nt("accept-all","accept all proposed detections","ico/accept-all.png","accept-all",!1,void 0,(function(){return At.acceptAllSuggestedLabels(de.getActiveImageData())})),Nt("reject-all","reject all proposed detections","ico/reject-all.png","reject-all",!1,void 0,(function(){return At.rejectAllSuggestedLabels(de.getActiveImageData())}))]})]})})),Mt=Object(l.b)((function(e){return{windowSize:e.general.windowSize,activeImageIndex:e.labels.activeImageIndex,imagesData:e.labels.imagesData,activeContext:e.general.activeContext,projectType:e.general.projectData.type}}))((function(e){var t=e.windowSize,n=e.activeImageIndex,o=e.imagesData,r=e.activeContext,c=e.projectType,l=Object(i.useState)(!0),u=Object(s.a)(l,2),d=u[0],b=u[1],h=Object(i.useState)(!0),f=Object(s.a)(h,2),O=f[0],v=f[1],p=function(){if(t){var e=d?g.SIDE_NAVIGATION_BAR_WIDTH_OPEN_PX:g.SIDE_NAVIGATION_BAR_WIDTH_CLOSED_PX,n=O?g.SIDE_NAVIGATION_BAR_WIDTH_OPEN_PX:g.SIDE_NAVIGATION_BAR_WIDTH_CLOSED_PX;return{width:t.width-e-n,height:t.height-g.TOP_NAVIGATION_BAR_HEIGHT_PX-g.EDITOR_BOTTOM_NAVIGATION_BAR_HEIGHT_PX-g.EDITOR_TOP_NAVIGATION_BAR_HEIGHT_PX}}return null},m=function(){d?d&&r===Y.LEFT_NAVBAR&&He.restoreCtx():He.switchCtx(Y.LEFT_NAVBAR),b(!d)},j=function(){O?O&&r===Y.RIGHT_NAVBAR&&He.restoreCtx():He.switchCtx(Y.RIGHT_NAVBAR),v(!O)};return Object(A.jsxs)("div",{className:"EditorContainer",children:[Object(A.jsx)(st,{direction:a.LEFT,isOpen:d,isWithContext:r===Y.LEFT_NAVBAR,renderCompanion:function(){return Object(A.jsx)(A.Fragment,{children:Object(A.jsx)(lt,{label:"Images",image:"/ico/camera.png",imageAlt:"images",onClick:m,isActive:d})})},renderContent:function(){return Object(A.jsx)(Ye,{})}},"left-side-navigation-bar"),Object(A.jsxs)("div",{className:"EditorWrapper",onMouseDown:function(){return He.switchCtx(Y.EDITOR)},children:[c===Pe.OBJECT_DETECTION&&Object(A.jsx)(kt,{},"editor-top-navigation-bar"),Object(A.jsx)(Ct,{size:p(),imageData:o[n]},"editor"),Object(A.jsx)(Lt,{imageData:o[n],size:p(),totalImageCount:o.length},"editor-bottom-navigation-bar")]},"editor-wrapper"),Object(A.jsx)(st,{direction:a.RIGHT,isOpen:O,isWithContext:r===Y.RIGHT_NAVBAR,renderCompanion:function(){return Object(A.jsx)(A.Fragment,{children:Object(A.jsx)(lt,{label:"Labels",image:"/ico/tags.png",imageAlt:"labels",onClick:j,isActive:O})})},renderContent:function(){return Object(A.jsx)(ct,{})}},"right-side-navigation-bar")]})})),Bt=(n(497),n(498),Object(l.b)((function(e){return{imagesData:e.labels.imagesData,activeLabelType:e.labels.activeLabelType}}),{})((function(e){var t=e.imagesData,n=e.activeLabelType,a=t.reduce((function(e,t){return e+(t.labelPoints.length>0?1:0)}),0),i=t.reduce((function(e,t){return e+(t.labelRects.length>0?1:0)}),0),o=t.reduce((function(e,t){return e+(t.labelPolygons.length>0?1:0)}),0),r=t.reduce((function(e,t){return e+(t.labelLines.length>0?1:0)}),0),c=t.reduce((function(e,t){return e+(0!==t.labelNameIds.length?1:0)}),0);return Object(A.jsx)("div",{className:"StateBar",children:Object(A.jsx)("div",{style:{width:function(){switch(n){case b.POINT:return 100*a/t.length;case b.RECT:return 100*i/t.length;case b.POLYGON:return 100*o/t.length;case b.LINE:return 100*r/t.length;case b.IMAGE_RECOGNITION:return 100*c/t.length;default:return 0}}()+"%"},className:"done"})})}))),Ut=(n(499),[{name:"File",imageSrc:"",imageAlt:"",disabled:!0,children:[{name:"Edit Labels",description:"Modify labels list",imageSrc:"ico/tags.png",imageAlt:"labels",disabled:!1,onClick:function(){return wa.dispatch(ee(u.UPDATE_LABEL))}},{name:"Import Images",description:"Load more images",imageSrc:"ico/camera.png",imageAlt:"images",disabled:!1,onClick:function(){return wa.dispatch(ee(u.IMPORT_IMAGES))}},{name:"Export Annotations",description:"Export annotations to file",imageSrc:"ico/export-labels.png",imageAlt:"export-labels",disabled:!1,onClick:function(){return wa.dispatch(ee(u.EXPORT_ANNOTATIONS))}},{name:"Load AI Model",description:"Load our pre-trained annotation models",imageSrc:"ico/ai.png",imageAlt:"load-ai-model",disabled:!1,onClick:function(){return wa.dispatch(ee(u.LOAD_AI_MODEL))}}]}]),Vt={updatePreventCustomCursorStatusAction:ne},zt=Object(l.b)((function(e){return{}}),Vt)((function(e){var t=e.updatePreventCustomCursorStatusAction,n=Object(i.useState)(null),a=Object(s.a)(n,2),o=a[0],r=a[1],c=Object(i.useState)(null),l=Object(s.a)(c,2),u=l[0],d=l[1],g=function(e){t(!0)},b=function(e){t(!1)},h=function e(t){t.target.classList.contains("DropDownMenuTab")||t.target.classList.contains("DropDownMenuContentOption")||(r(null),document.removeEventListener(ue.MOUSE_DOWN,e))},f=function(e,n){return function(){n||(e&&e(),r(null),t(!1),document.removeEventListener(ue.MOUSE_DOWN,h))}},O=function(e,t){return Object(A.jsxs)("div",{className:(n=t,S()("DropDownMenuTab",{active:n===o})),onClick:function(e){return function(e,t){null===o&&document.addEventListener(ue.MOUSE_DOWN,h),o===e?(r(null),d(null)):(r(e),d({x:t.target.offsetLeft,y:35}))}(t,e)},onMouseEnter:function(e){return function(e,t){null!==o&&o!==e&&(r(e),d({x:t.target.offsetLeft,y:35}))}(t,e)},children:[Object(A.jsx)("img",{draggable:!1,src:e.imageSrc,alt:e.imageAlt}),e.name]},t);var n};return Object(A.jsx)("div",{className:"DropDownMenuWrapper",children:Object(A.jsxs)(A.Fragment,{children:[Ut.map((function(e,t){return O(e,t)})),function(e){if(null!==o){var t={top:35,left:u.x,height:40*e.children.length+10};return Object(A.jsx)("div",{className:"DropDownMenuContent",style:t,onMouseEnter:g,onMouseLeave:b,children:e.children.map((function(e,t){return Object(A.jsxs)("div",{className:(n=e.disabled,S()("DropDownMenuContentOption",{active:!n})),onClick:f(e.onClick,e.disabled),children:[Object(A.jsx)("div",{className:"Marker"}),Object(A.jsx)("img",{src:e.imageSrc,alt:e.imageAlt}),e.name]},t);var n}))})}return null}(Ut[o])]})})})),Ft={updateActivePopupTypeAction:ee,updateProjectDataAction:ae},Gt=Object(l.b)((function(e){return{projectData:e.general.projectData}}),Ft)((function(e){return Object(A.jsxs)("div",{className:"TopNavigationBar",children:[Object(A.jsx)(Bt,{}),Object(A.jsxs)("div",{className:"TopNavigationBarWrapper",children:[Object(A.jsx)("div",{className:"NavigationBarGroupWrapper"}),Object(A.jsx)("div",{className:"NavigationBarGroupWrapper",children:Object(A.jsx)(zt,{})}),Object(A.jsx)("div",{className:"NavigationBarGroupWrapper middle"})]})]})})),Ht=Object(l.b)((function(e){return{activePopupType:e.general.activePopupType}}))((function(e){var t=e.activePopupType;return Object(A.jsxs)("div",{className:S()("EditorView",{withPopup:!!t}),draggable:!1,children:[Object(A.jsx)(Gt,{}),Object(A.jsx)(Mt,{})]})})),Wt=(n(500),[{displayText:"Open source and free to use under GPLv3 license",imageSrc:"ico/open-source.png",imageAlt:"open-source"},{displayText:"No advanced installation required, just open up your browser",imageSrc:"ico/online.png",imageAlt:"online"},{displayText:"We don't store your images, because we don't send them anywhere",imageSrc:"ico/private.png",imageAlt:"private"},{displayText:"Support multiple label types - rects, lines, points and polygons",imageSrc:"ico/labels.png",imageAlt:"labels"},{displayText:"Support output file formats like YOLO, VOC XML, VGG JSON, CSV",imageSrc:"ico/file.png",imageAlt:"file"},{displayText:"Use AI to make your work more productive",imageSrc:"ico/robot.png",imageAlt:"robot"}]),Yt=(n(501),n(124)),Zt=(n(502),function(e){var t=e.key,n=e.label,a=e.onClick,i=e.style,o=e.isActive,r=e.isDisabled,c=e.externalClassName;return Object(A.jsx)("div",{className:S()("TextButton",c,{active:o,disabled:r}),onClick:function(e){e.stopPropagation(),a&&a()},style:i,children:n},t)});!function(e){e.IMAGE="image/jpeg, image/png",e.TEXT="text/plain",e.JSON="application/json"}(yt||(yt={}));var Xt,Kt=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"createImageDataFromFileData",value:function(e){return{id:Object(pe.a)(),fileData:e,loadStatus:!1,labelRects:[],labelPoints:[],labelLines:[],labelPolygons:[],labelNameIds:[],isVisitedByObjectDetector:!1,isVisitedByPoseDetector:!1,isVisitedByFormDetector:!1,isVisitedByMaskDetector:!1}}},{key:"cleanAnnotations",value:function(e){return Object(j.a)(Object(j.a)({},e),{},{labelRects:[],labelPoints:[],labelLines:[],labelPolygons:[],labelNameIds:[]})}},{key:"arrange",value:function(e,t){return e.sort((function(e,n){return t.indexOf(e.id)-t.indexOf(n.id)}))}},{key:"loadMissingImages",value:function(e){return new Promise((function(t,n){var a=e.filter((function(e){return!e.loadStatus})),i=a.map((function(e){return e.fileData}));X.loadImages(i).then((function(e){_.storeImages(a.map((function(e){return e.id})),e),t()})).catch((function(e){return n(e)}))}))}}]),e}(),Jt={updateActiveImageIndexAction:k,addImageDataAction:F,updateProjectDataAction:ae,updateActivePopupTypeAction:ee},qt=Object(l.b)((function(e){return{projectData:e.general.projectData}}),Jt)((function(e){var t=Object(Yt.a)({accept:yt.IMAGE}),n=t.acceptedFiles,a=t.getRootProps,i=t.getInputProps,o=function(t){if(n.length>0){var a=Object(N.sortBy)(n,(function(e){return e.name}));e.updateProjectDataAction(Object(j.a)(Object(j.a)({},e.projectData),{},{type:t})),e.updateActiveImageIndexAction(0),e.addImageDataAction(a.map((function(e){return Kt.createImageDataFromFileData(e)})))}};return Object(A.jsxs)("div",{className:"ImagesDropZone",children:[Object(A.jsx)("div",Object(j.a)(Object(j.a)({},a({className:"DropZone"})),{},{children:0===n.length?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("input",Object(j.a)({},i())),Object(A.jsx)("img",{draggable:!1,alt:"upload",src:"ico/box-opened.png"}),Object(A.jsx)("p",{className:"extraBold",children:"Drop images"}),Object(A.jsx)("p",{children:"or"}),Object(A.jsx)("p",{className:"extraBold",children:"Click here to select them"})]}):1===n.length?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("img",{draggable:!1,alt:"uploaded",src:"ico/box-closed.png"}),Object(A.jsx)("p",{className:"extraBold",children:"1 image loaded"})]}):Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("input",Object(j.a)({},i())),Object(A.jsx)("img",{draggable:!1,alt:"uploaded",src:"ico/box-closed.png"},1),Object(A.jsxs)("p",{className:"extraBold",children:[n.length," images loaded"]},2)]})})),Object(A.jsx)("div",{className:"DropZoneButtons",children:Object(A.jsx)(Zt,{label:"get started",isDisabled:!n.length,onClick:function(){return o(Pe.OBJECT_DETECTION)}})})]})})),Qt=function(){var e=Object(i.useState)(!1),t=Object(s.a)(e,2),n=t[0],a=(t[1],Object(i.useState)(!1)),o=Object(s.a)(a,2),r=o[0];o[1],St()((function(e){return{tooltip:{backgroundColor:"#171717",color:"#ffffff",boxShadow:e.shadows[1],fontSize:11,maxWidth:120}}}))(xt.a);return Object(A.jsx)("div",{className:S()("MainView",{InProgress:!0,Canceled:!n&&r}),children:Object(A.jsxs)("div",{className:"EditorFeaturesTiles",children:[Object(A.jsx)("div",{}),Object(A.jsx)("script",{children:"setProjectInProgress(true);"}),Object(A.jsx)(qt,{})]})})},$t=(n(503),n(504),n(505),function(e){var t=e.title,n=e.renderContent,a=e.acceptLabel,o=e.onAccept,r=e.skipAcceptButton,c=e.disableAcceptButton,l=e.rejectLabel,u=e.onReject,d=e.skipRejectButton,g=e.disableRejectButton,b=Object(i.useState)(!1),h=Object(s.a)(b,2),f=h[0],O=h[1];return Object(i.useEffect)((function(){f||(He.switchCtx(Y.POPUP),O(!0))}),[f]),Object(A.jsxs)("div",{className:"GenericYesNoPopup",children:[Object(A.jsx)("div",{className:"Header",children:t}),Object(A.jsx)("div",{className:"Content",children:n()}),Object(A.jsxs)("div",{className:"Footer",children:[!r&&Object(A.jsx)(Zt,{label:a||"YES",onClick:o,externalClassName:"accept",isDisabled:c}),!d&&Object(A.jsx)(Zt,{label:l||"NO, THANKS",onClick:u,externalClassName:"reject",isDisabled:g})]})]})}),en=n(128),tn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).name="YOLOAnnotationsLoadingError",a}return n}(Object(en.a)(Error)),nn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this,"For YOLO labels to be loaded correctly, labels.txt file is required")).name="NoLabelNamesFileProvidedError",e}return n}(tn),an=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this,"Label names listed in labels.txt file should be unique")).name="LabelNamesNotUniqueError",e}return n}(tn),on=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,"Unexpected error occurred during parsing of ".concat(e," annotations file"))).name="AnnotationsParsingError",a}return n}(tn),rn=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"parseLabelsNamesFromString",value:function(e){var t=e.split(/[\r\n]/).filter(Boolean).map((function(e){return e.replace(/\s/g,"")}));if(Object(N.uniq)(t).length!==t.length)throw new an;return t.map((function(e){return me.createLabelName(e)}))}},{key:"loadLabelsList",value:function(t,n,a){var i=new FileReader;i.onloadend=function(t){var a=t.target.result,i=e.parseLabelsNamesFromString(a);n(i)},i.onerror=function(){return a()},i.readAsText(t)}},{key:"parseYOLOAnnotationsFromString",value:function(t,n,a,i){return t.split(/[\r\n]/).filter(Boolean).map((function(t){return e.parseYOLOAnnotationFromString(t,n,a,i)}))}},{key:"parseYOLOAnnotationFromString",value:function(t,n,a,i){var o=t.split(" ");if(!e.validateYOLOAnnotationComponents(o,n.length))throw new on(i);var r=n[parseInt(o[0])].id,c=parseFloat(o[1]),s=parseFloat(o[2]),l=parseFloat(o[3]),u=parseFloat(o[4]),d={x:(c-l/2)*a.width,y:(s-u/2)*a.height,width:l*a.width,height:u*a.height};return me.createLabelRect(r,d)}},{key:"validateYOLOAnnotationComponents",value:function(e,t){var n=function(e){var t=Number(e);return!isNaN(t)&&0<=t&&t<=1};return[5===e.length,function(e){var n=parseInt(e);return!isNaN(n)&&0<=n&&n<t}(e[0]),n(e[1]),n(e[2]),n(e[3]),n(e[4])].every(Boolean)}}]),e}(),cn={updateActivePopupType:ee,updateLabels:H},sn=Object(l.b)((function(e){return{}}),cn)((function(e){var t=e.updateActivePopupType,n=e.updateLabels,a=Object(i.useState)([]),o=Object(s.a)(a,2),r=o[0],c=o[1],l=Object(i.useState)(!1),d=Object(s.a)(l,2),g=d[0],b=d[1],h=Object(Yt.a)({accept:yt.TEXT,multiple:!1,onDrop:function(e){1===e.length&&rn.loadLabelsList(e[0],p,m)}}),f=h.acceptedFiles,O=h.getRootProps,v=h.getInputProps,p=function(e){c(e),b(!1)},m=function(){b(!0)};return Object(A.jsx)($t,{title:"Load file with labels description",renderContent:function(){return Object(A.jsxs)("div",{className:"LoadLabelsPopupContent",children:[Object(A.jsx)("div",{className:"Message",children:"Load a text file with a list of labels you are planning to use. The names of each label should be separated by new line. If you don't have a prepared file, no problem. You can create your own list now."}),Object(A.jsx)("div",Object(j.a)(Object(j.a)({},O({className:"DropZone"})),{},{children:g?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("input",Object(j.a)({},v())),Object(A.jsx)("img",{draggable:!1,alt:"upload",src:"ico/box-opened.png"}),Object(A.jsx)("p",{className:"extraBold",children:"Loading of labels file was unsuccessful"}),Object(A.jsx)("p",{className:"extraBold",children:"Try again"})]}):0===f.length?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("input",Object(j.a)({},v())),Object(A.jsx)("img",{draggable:!1,alt:"upload",src:"ico/box-opened.png"}),Object(A.jsx)("p",{className:"extraBold",children:"Drop labels file"}),Object(A.jsx)("p",{children:"or"}),Object(A.jsx)("p",{className:"extraBold",children:"Click here to select it"})]}):1===r.length?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("img",{draggable:!1,alt:"uploaded",src:"ico/box-closed.png"}),Object(A.jsx)("p",{className:"extraBold",children:"only 1 label found"})]}):Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("img",{draggable:!1,alt:"uploaded",src:"ico/box-closed.png"}),Object(A.jsxs)("p",{className:"extraBold",children:[r.length," labels found"]})]})}))]})},acceptLabel:"Start project",onAccept:function(){r.length>0&&n(r)},disableAcceptButton:0===r.length,rejectLabel:"Create labels list",onReject:function(){t(u.INSERT_LABEL_NAMES)}})})),ln=(n(506),n(507),function(e){var t=e.color,n=e.onClick;return Object(A.jsx)("div",{className:"ColorSelectorView",style:{backgroundColor:t},onClick:n,children:Object(A.jsx)("img",{draggable:!1,alt:"refresh",src:"ico/refresh.png"})})}),un=n(556),dn=n(44);!function(e){e.ERROR="ERROR",e.SUCCESS="SUCCESS",e.MESSAGE="MESSAGE",e.WARNING="WARNING"}(Xt||(Xt={}));var gn,bn,hn=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"createErrorNotification",value:function(e){return{id:Object(pe.a)(),type:Xt.ERROR,header:e.header,description:e.description}}},{key:"createMessageNotification",value:function(e){return{id:Object(pe.a)(),type:Xt.MESSAGE,header:e.header,description:e.description}}},{key:"createWarningNotification",value:function(e){return{id:Object(pe.a)(),type:Xt.WARNING,header:e.header,description:e.description}}}]),e}(),fn=n(55);!function(e){e[e.EMPTY_LABEL_NAME_ERROR=0]="EMPTY_LABEL_NAME_ERROR",e[e.NON_UNIQUE_LABEL_NAMES_ERROR=1]="NON_UNIQUE_LABEL_NAMES_ERROR"}(gn||(gn={}));var On=(bn={},Object(fn.a)(bn,gn.EMPTY_LABEL_NAME_ERROR,{header:"Empty label name",description:"Looks like you didn't assign name to one of your labels. Unfortunately it is mandatory for every label to have unique name value. Insert correct name or delete empty label and try again."}),Object(fn.a)(bn,gn.NON_UNIQUE_LABEL_NAMES_ERROR,{header:"Non unique label names",description:"Looks like not all your label names are unique. Unique names are necessary to guarantee correct data export when you complete your work. Make your names unique and try again."}),bn),vn=Object(dn.a)({root:{"& .MuiInputBase-root":{color:"white"},"& label":{color:"white"},"& .MuiInput-underline:before":{borderBottomColor:"white"},"& .MuiInput-underline:hover:before":{borderBottomColor:"white"},"& label.Mui-focused":{color:g.SECONDARY_COLOR},"& .MuiInput-underline:after":{borderBottomColor:g.SECONDARY_COLOR}}})(un.a),pn={updateActivePopupTypeAction:ee,updateLabelNamesAction:H,updatePerClassColorationStatusAction:function(e){return{type:D.UPDATE_ENABLE_PER_CLASS_COLORATION_STATUS,payload:{enablePerClassColoration:e}}},submitNewNotificationAction:function(e){return{type:D.SUBMIT_NEW_NOTIFICATION,payload:{notification:e}}}},mn=Object(l.b)((function(e){return{projectType:e.general.projectData.type,enablePerClassColoration:e.general.enablePerClassColoration}}),pn)((function(e){var t=e.updateActivePopupTypeAction,n=e.updateLabelNamesAction,a=e.updatePerClassColorationStatusAction,o=e.submitNewNotificationAction,r=e.isUpdate,c=e.projectType,l=e.enablePerClassColoration,d=Object(i.useState)(de.getLabelNames()),b=Object(s.a)(d,2),h=b[0],f=b[1],O=function(e){return function(){0===Object(N.filter)(h,(function(e){return""===e.name})).length?Object(N.uniq)(h.map((function(e){return e.name}))).length===h.length?e():o(hn.createErrorNotification(On[gn.NON_UNIQUE_LABEL_NAMES_ERROR])):o(hn.createErrorNotification(On[gn.EMPTY_LABEL_NAME_ERROR]))}},v=function(){var e=[].concat(Object(R.a)(h),[me.createLabelName("")]);f(e)},m=function(){return O(v)()},y=function(){a(!l)},I=function(e){"Enter"===e.key&&m()},E=h.map((function(e){return Object(A.jsxs)("div",{className:"LabelEntry",children:[Object(A.jsx)(vn,{id:"key",autoComplete:"off",autoFocus:!0,type:"text",margin:"dense",label:"Insert label",onKeyUp:I,value:e.name,onChange:function(t){return P(e.id,t.target.value)},style:{width:280},InputLabelProps:{shrink:!0}}),c===Pe.OBJECT_DETECTION&&l&&Object(A.jsx)(ln,{color:e.color,onClick:function(){return function(e){var t=h.map((function(t){return t.id===e?Object(j.a)(Object(j.a)({},t),{},{color:Object(N.sample)(g.LABEL_COLORS_PALETTE)}):t}));f(t)}(e.id)}}),Object(A.jsx)(Xe,{image:"ico/trash.png",imageAlt:"remove_label",buttonSize:{width:30,height:30},onClick:function(){return function(e){var t=Object(N.reject)(h,{id:e});f(t)}(e.id)}})]},e.id)})),P=function(e,t){var n=h.map((function(n){return n.id===e?Object(j.a)(Object(j.a)({},n),{},{name:t}):n}));f(n)},C=function(){var e=Object(N.reject)(h,(function(e){return 0===e.name.length}));h.length>0&&n(e),t(null)},L=function(){var e=Object(N.reject)(h,(function(e){return 0===e.name.length})),a=me.labelNamesIdsDiff(de.getLabelNames(),e);Ve.removeLabelNames(a),n(e),t(null)};return Object(A.jsx)($t,{title:r?"Edit labels":"Create labels",renderContent:function(){return Object(A.jsxs)("div",{className:"InsertLabelNamesPopup",children:[Object(A.jsxs)("div",{className:"LeftContainer",children:[Object(A.jsx)(Xe,{image:"ico/plus.png",imageAlt:"plus",buttonSize:{width:40,height:40},padding:25,onClick:m,externalClassName:"monochrome"}),h.length>0&&Object(A.jsx)(Xe,{image:l?"ico/colors-on.png":"ico/colors-off.png",imageAlt:"per-class-coloration",buttonSize:{width:40,height:40},padding:15,onClick:y,isActive:l,externalClassName:l?"":"monochrome"})]}),Object(A.jsxs)("div",{className:"RightContainer",children:[Object(A.jsx)("div",{className:"Message",children:r?"You can now edit the label names you use to describe the objects in the photos. Use the + button to add a new empty text field.":"Before you start, you can create a list of labels you plan to assign to objects in your project. You can also choose to skip that part for now and define label names as you go."}),Object(A.jsx)("div",{className:"LabelsContainer",children:0!==Object.keys(h).length?Object(A.jsx)(p.a,{children:Object(A.jsx)("div",{className:"InsertLabelNamesPopupContent",children:E})}):Object(A.jsxs)("div",{className:"EmptyList",onClick:v,children:[Object(A.jsx)("img",{draggable:!1,alt:"upload",src:"ico/type-writer.png"}),Object(A.jsx)("p",{className:"extraBold",children:"Your label list is empty"})]})})]})]})},acceptLabel:r?"Accept":"Start project",onAccept:r?function(){return O(L)()}:function(){return O(C)()},rejectLabel:r?"Cancel":"Load labels from file",onReject:r?function(){t(null)}:function(){t(u.LOAD_LABEL_NAMES)}})})),jn=(n(508),{updateActiveLabelNameId:M,updateLabelNames:H,updateProjectData:ae,updateActiveImageIndex:k,updateImageData:G,updateFirstLabelCreatedFlag:W}),yn=Object(l.b)((function(e){return{}}),jn)((function(e){var t=e.updateActiveLabelNameId,n=e.updateLabelNames,a=e.updateActiveImageIndex,i=e.updateImageData,o=e.updateFirstLabelCreatedFlag,r=e.updateProjectData;return Object(A.jsx)($t,{title:"Exit project",renderContent:function(){return Object(A.jsx)("div",{className:"ExitProjectPopupContent",children:Object(A.jsx)("div",{className:"Message",children:"Are you sure you want to leave the editor? You will permanently lose all your progress."})})},acceptLabel:"Exit",onAccept:function(){t(null),n([]),r({type:null,name:"my-project-name"}),a(null),i([]),o(!1),Fe.close()},rejectLabel:"Back",onReject:function(){Fe.close()}})})),In=(n(509),{addImageData:F}),An=Object(l.b)((function(e){return{}}),In)((function(e){var t=e.addImageData,n=Object(Yt.a)({accept:yt.IMAGE}),a=n.acceptedFiles,i=n.getRootProps,o=n.getInputProps;return Object(A.jsx)($t,{title:"Load more images",renderContent:function(){return Object(A.jsx)("div",{className:"LoadMoreImagesPopupContent",children:Object(A.jsx)("div",Object(j.a)(Object(j.a)({},i({className:"DropZone"})),{},{children:0===a.length?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("input",Object(j.a)({},o())),Object(A.jsx)("img",{draggable:!1,alt:"upload",src:"ico/box-opened.png"}),Object(A.jsx)("p",{className:"extraBold",children:"Add new images"}),Object(A.jsx)("p",{children:"or"}),Object(A.jsx)("p",{className:"extraBold",children:"Click here to select them"})]}):1===a.length?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("img",{draggable:!1,alt:"uploaded",src:"ico/box-closed.png"}),Object(A.jsx)("p",{className:"extraBold",children:"1 new image loaded"})]}):Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("img",{draggable:!1,alt:"uploaded",src:"ico/box-closed.png"},1),Object(A.jsxs)("p",{className:"extraBold",children:[a.length," new images loaded"]},2)]})}))})},acceptLabel:"Load",disableAcceptButton:a.length<1,onAccept:function(){a.length>0&&(t(a.map((function(e){return Kt.createImageDataFromFileData(e)}))),Fe.close())},rejectLabel:"Cancel",onReject:function(){Fe.close()}})})),En=n(377),Pn=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"detectRectsForActiveImage",value:function(){var t=de.getActiveImageData();e.detectRects(t.id,_.getById(t.id))}},{key:"detectRects",value:function(t,n){!de.getImageDataById(t).isVisitedByObjectDetector&&K.isAIObjectDetectorModelLoaded()&&(wa.dispatch(ee(u.LOADER)),Cn.predict(n,(function(n){console.log("here in ai object");var a=e.extractNewSuggestedLabelNames(de.getLabelNames(),n),i=K.getRejectedSuggestedLabelList(),o=At.excludeRejectedLabelNames(a,i);o.length>0?(wa.dispatch(ht(o)),wa.dispatch(ee(u.SUGGEST_LABEL_NAMES))):wa.dispatch(ee(null)),e.saveRectPredictions(t,n)})))}},{key:"saveRectPredictions",value:function(t,n){var a=de.getImageDataById(t),i=e.mapPredictionsToRectLabels(n),o=Object(j.a)(Object(j.a)({},a),{},{labelRects:a.labelRects.concat(i),isVisitedByObjectDetector:!0});wa.dispatch(z(a.id,o))}},{key:"mapPredictionsToRectLabels",value:function(e){return e.map((function(e){return{id:Object(pe.a)(),labelIndex:null,labelId:null,rect:{x:e.bbox[0],y:e.bbox[1],width:e.bbox[2],height:e.bbox[3]},isCreatedByAI:!0,status:ge.UNDECIDED,suggestedLabel:e.class}}))}},{key:"extractNewSuggestedLabelNames",value:function(e,t){return t.reduce((function(t,n){return t.includes(n.class)||Object(N.findLast)(e,{name:n.class})||t.push(n.class),t}),[])}},{key:"acceptAllSuggestedRectLabels",value:function(e){var t=Object(j.a)(Object(j.a)({},e),{},{labelRects:e.labelRects.map((function(e){var t=Object(N.findLast)(de.getLabelNames(),{name:e.suggestedLabel});return Object(j.a)(Object(j.a)({},e),{},{status:ge.ACCEPTED,labelId:t?t.id:e.labelId})}))});wa.dispatch(z(t.id,t))}},{key:"rejectAllSuggestedRectLabels",value:function(e){var t=Object(j.a)(Object(j.a)({},e),{},{labelRects:e.labelRects.filter((function(e){return e.status===ge.ACCEPTED}))});wa.dispatch(z(t.id,t))}}]),e}(),Cn=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"loadModel",value:function(t){En.load().then((function(n){var a;console.log("I am here"),e.model=n,wa.dispatch((a=!0,{type:D.UPDATE_OBJECT_DETECTOR_STATUS,payload:{isObjectDetectorLoaded:a}})),wa.dispatch(V(b.RECT)),de.getActiveLabelType()===b.RECT&&Pn.detectRectsForActiveImage(),t&&t()})).catch((function(e){throw new Error(e)}))}},{key:"predict",value:function(t,n){e.model&&e.model.detect(t).then((function(e){console.log(e),n&&n(e)})).catch((function(e){throw new Error(e)}))}}]),e}();Cn.model=void 0;var Ln;n(519);!function(e){e.OBJECT_DETECTION="OBJECT_DETECTION",e.POSE_DETECTION="POSE_DETECTION",e.FORM_DETECTION="FORM_DETECTION",e.MASK_DETECTION="MASK_DETECTION"}(Ln||(Ln={}));var Tn,Sn,xn=[{model:Ln.FORM_DETECTION,name:"Object Detection",flag:!1},{model:Ln.MASK_DETECTION,name:"Semantic Segmentation",flag:!1}],wn=function(){var e=Object(i.useState)(!1),t=Object(s.a)(e,2),n=t[0],a=t[1],o=Object(i.useState)(xn),r=Object(s.a)(o,2),c=r[0],l=r[1],u=function(){var e=Object(N.findLast)(c,{flag:!0});return e?e.model:null},d=function(){return c.map((function(e){return Object(A.jsxs)("div",{className:"OptionsItem",onClick:function(){return function(e){var t=c.map((function(t){return t.model===e?Object(j.a)(Object(j.a)({},t),{},{flag:!t.flag}):Object(j.a)(Object(j.a)({},t),{},{flag:!1})}));l(t)}(e.model)},children:[e.flag?Object(A.jsx)("img",{draggable:!1,src:"ico/checkbox-checked.png",alt:"checked"}):Object(A.jsx)("img",{draggable:!1,src:"ico/checkbox-unchecked.png",alt:"unchecked"}),e.name]},e.model)}))};return Object(A.jsx)($t,{title:"Say hello to AI",renderContent:function(){return Object(A.jsxs)("div",{className:"LoadModelPopupContent",children:[Object(A.jsx)("div",{className:"Message",children:"To speed up your work, AI will try to mark objects on your images."}),Object(A.jsx)("div",{className:"Companion",children:n?Object(A.jsx)(x.ClipLoader,{size:40,color:J.getLeadingColor(),loading:!0}):Object(A.jsx)("div",{className:"Options",children:d()})})]})},acceptLabel:"Use model!",onAccept:function(){switch(a(!0),u()){case Ln.POSE_DETECTION:jt.loadModel((function(){Fe.close()}));break;case Ln.OBJECT_DETECTION:Cn.loadModel((function(){Fe.close()}));break;case Ln.FORM_DETECTION:ft.loadModel((function(){Fe.close()}));break;case Ln.MASK_DETECTION:vt.loadModel((function(){Fe.close()}))}},disableAcceptButton:n||!u(),rejectLabel:"I'm going on my own",onReject:function(){Fe.close()},disableRejectButton:n})},Dn=(n(520),function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this,"Given predicate results in more than one value being matched.")).name="ArrayUtilAmbiguousMatchError",e}return n}(Object(en.a)(Error))),Rn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this,"Given array is empty.")).name="EmptyArrayError",e}return n}(Object(en.a)(Error)),Nn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this,"Index can not be negative.")).name="NegativeIndexError",e}return n}(Object(en.a)(Error)),_n=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"partition",value:function(e,t){return e.reduce((function(e,n){return t(n)?e.pass.push(n):e.fail.push(n),e}),{pass:[],fail:[]})}},{key:"match",value:function(e,t,n){return e.reduce((function(e,a){var i=t.filter((function(e){return n(a,e)}));if(1===i.length)e.push([a,i[0]]);else if(i.length>1)throw new Dn;return e}),[])}},{key:"unzip",value:function(e){return e.reduce((function(e,t){return e[0].push(t[0]),e[1].push(t[1]),e}),[[],[]])}},{key:"getByInfiniteIndex",value:function(e,t){if(0===e.length)throw new Rn;if(t<0)throw new Nn;return e[t%e.length]}}]),e}(),kn={updateLabelNames:H,updateSuggestedLabelList:ht,updateRejectedSuggestedLabelList:function(e){return{type:D.UPDATE_REJECTED_SUGGESTED_LABEL_LIST,payload:{labelList:e}}}},Mn=Object(l.b)((function(e){return{}}),kn)((function(e){var t=e.updateLabelNames,n=e.updateSuggestedLabelList,a=e.updateRejectedSuggestedLabelList,o=Object(i.useState)(!1),r=Object(s.a)(o,2),c=r[0],l=r[1],u=Object(i.useState)(K.getSuggestedLabelList().map((function(e){return{name:e,flag:!1}}))),d=Object(s.a)(u,2),b=d[0],h=d[1],f=function(){return b.reduce((function(e,t){return t.flag&&e.push(t.name),e}),[])},O=function(){return b.reduce((function(e,t){return t.flag||e.push(t.name),e}),[])},v=function(){return b.map((function(e){return e.name}))},m=function(){return b.map((function(e,t){return Object(A.jsxs)("div",{className:"OptionsItem",onClick:function(){return function(e){var t=b.map((function(t,n){return e===n?Object(j.a)(Object(j.a)({},t),{},{flag:!t.flag}):t}));h(t);var n=t.reduce((function(e,t){return e&&t.flag}),!0);l(n)}(t)},children:[e.flag?Object(A.jsx)("img",{draggable:!1,src:"ico/checkbox-checked.png",alt:"checked"}):Object(A.jsx)("img",{draggable:!1,src:"ico/checkbox-unchecked.png",alt:"unchecked"}),e.name]},t)}))};return Object(A.jsx)($t,{title:"New classes found",renderContent:function(){return Object(A.jsxs)("div",{className:"SuggestLabelNamesPopupContent",children:[Object(A.jsx)("div",{className:"Message",children:"We found objects of classes that are not yet included in the list of labels. Select the names you would like to add. This will help to speed up the labeling process."}),Object(A.jsx)("div",{className:"AllToggle",children:Object(A.jsxs)("div",{className:"OptionsItem",onClick:function(){return c?(l(!1),void h(b.map((function(e){return Object(j.a)(Object(j.a)({},e),{},{flag:!1})})))):(l(!0),void h(b.map((function(e){return Object(j.a)(Object(j.a)({},e),{},{flag:!0})}))))},children:[c?Object(A.jsx)("img",{draggable:!1,src:"ico/checkbox-checked.png",alt:"checked"}):Object(A.jsx)("img",{draggable:!1,src:"ico/checkbox-unchecked.png",alt:"unchecked"}),c?"Deselect all":"Select all"]})}),Object(A.jsx)("div",{className:"LabelNamesContainer",children:Object(A.jsx)(p.a,{autoHeight:!0,children:Object(A.jsx)("div",{className:"LabelNamesContent",children:m()})})})]})},acceptLabel:"Accept",onAccept:function(){t(f().reduce((function(e,t,n){return e.push({name:t,id:Object(pe.a)(),color:_n.getByInfiniteIndex(g.LABEL_COLORS_PALETTE,n)}),e}),de.getLabelNames())),a(K.getRejectedSuggestedLabelList().concat(O())),n([]),Fe.close()},rejectLabel:"Reject",onReject:function(){a(K.getRejectedSuggestedLabelList().concat(v())),n([]),Fe.close()}})})),Bn=(n(521),n(522),Object(l.b)((function(e){return{projectType:e.general.projectData.type}}),{})((function(e){var t=e.title,n=e.activeLabelType,a=e.projectType,o=e.onLabelTypeChange,r=e.acceptLabel,c=e.onAccept,l=e.skipAcceptButton,u=e.disableAcceptButton,d=e.rejectLabel,g=e.onReject,b=e.renderInternalContent,h=Object(i.useState)(n),f=Object(s.a)(h,2),O=f[0],v=f[1];return Object(A.jsx)($t,{title:t,renderContent:function(){return Object(A.jsxs)("div",{className:"GenericLabelTypePopupContent",children:[Object(A.jsx)("div",{className:"LeftContainer",children:Ze.filter((function(e){return e.projectType===a})).map((function(e){return Object(A.jsx)(Xe,{image:e.imageSrc,imageAlt:e.imageAlt,buttonSize:{width:40,height:40},padding:20,onClick:function(){v(e.labelType),o(e.labelType)},isActive:O===e.labelType})}))}),Object(A.jsx)("div",{className:"RightContainer",children:b(O)})]})},acceptLabel:r,onAccept:function(){return c(O)},skipAcceptButton:l,disableAcceptButton:u,rejectLabel:d,onReject:function(){return g(O)}})})));!function(e){e.YOLO="YOLO",e.COCO="COCO",e.CSV="CSV",e.JSON="JSON",e.VOC="VOC",e.VGG="VGG"}(Tn||(Tn={}));var Un=(Sn={},Object(fn.a)(Sn,b.RECT,[{type:Tn.COCO,label:"Single file in COCO JSON format."},{type:Tn.YOLO,label:"Multiple files in YOLO format along with labels names definition - labels.txt file."}]),Object(fn.a)(Sn,b.POINT,[]),Object(fn.a)(Sn,b.LINE,[]),Object(fn.a)(Sn,b.POLYGON,[{type:Tn.COCO,label:"Single file in COCO JSON format."}]),Object(fn.a)(Sn,b.IMAGE_RECOGNITION,[]),Sn),Vn=(n(523),function(){return Object(A.jsxs)("div",{className:"FeatureInProgress",children:[Object(A.jsx)("img",{draggable:!1,alt:"take_off",src:"ico/take-off.png"}),Object(A.jsxs)("p",{className:"extraBold",children:["new feature ",Object(A.jsx)("br",{})," coming soon..."]})]})}),zn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).name="COCOAnnotationsLoadingError",a}return n}(Object(en.a)(Error)),Fn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).name="COCOFormatValidationError",a}return n}(zn),Gn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this,"Unexpected error occurred during reading annotations from file")).name="COCOAnnotationReadingError",e}return n}(zn),Hn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this,"COCO annotation file need to be in JSON format")).name="COCOAnnotationDeserializationError",e}return n}(zn),Wn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this,"COCO annotation requires single file but multiple were given")).name="COCOAnnotationFileCountError",e}return n}(zn),Yn=function(){function e(t){Object(d.a)(this,e),this.labelType=void 0,this.labelType=t}return Object(h.a)(e,[{key:"import",value:function(e,t,n){throw new Error("Method not implemented.")}}]),e}(),Zn=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"bbox2rect",value:function(e){return{x:e[0],y:e[1],width:e[2],height:e[3]}}},{key:"segmentation2vertices",value:function(e){return e.map((function(e){return Object(N.chunk)(e,2).map((function(e){return{x:e[0],y:e[1]}}))}))}}]),e}(),Xn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"import",value:function(e,t,a){var i=this;e.length>1&&a(new Wn);var o=new FileReader;o.readAsText(e[0]),o.onloadend=function(e){try{var o=de.getImagesData(),r=n.deserialize(e.target.result),c=i.applyLabels(o,r),s=c.imagesData,l=c.labelNames;t(s,l)}catch(u){a(u)}},o.onerror=function(){return a(new Gn)}}},{key:"applyLabels",value:function(e,t){n.validateCocoFormat(t);var a,i=t.images,o=t.categories,r=t.annotations,c=n.mapCOCOCategories(o),s=e.map((function(e){return Kt.cleanAnnotations(e)})),l=n.partitionImageData(s,i),u=n.mapImageData(l.pass,i),d=Object(Z.a)(r);try{for(d.s();!(a=d.n()).done;){var g=a.value;if(u[g.image_id]&&1!==g.iscrowd&&(this.labelType.includes(b.RECT)&&u[g.image_id].labelRects.push(me.createLabelRect(c[g.category_id].id,Zn.bbox2rect(g.bbox))),this.labelType.includes(b.POLYGON))){var h,f=Zn.segmentation2vertices(g.segmentation),O=Object(Z.a)(f);try{for(O.s();!(h=O.n()).done;){var v=h.value;u[g.image_id].labelPolygons.push(me.createLabelPolygon(c[g.category_id].id,v))}}catch(m){O.e(m)}finally{O.f()}}}}catch(m){d.e(m)}finally{d.f()}var p=Object.values(u).concat(l.fail);return{imagesData:Kt.arrange(p,e.map((function(e){return e.id}))),labelNames:Object.values(c)}}}],[{key:"deserialize",value:function(e){try{return JSON.parse(e)}catch(t){throw new Hn}}},{key:"partitionImageData",value:function(e,t){var n=t.map((function(e){return e.file_name}));return _n.partition(e,(function(e){return n.includes(e.fileData.name)}))}},{key:"mapCOCOCategories",value:function(e){return e.reduce((function(e,t,n){return e[t.id]={id:Object(pe.a)(),name:t.name,color:_n.getByInfiniteIndex(g.LABEL_COLORS_PALETTE,n)},e}),{})}},{key:"mapImageData",value:function(e,t){var n=t.reduce((function(e,t){return e[t.file_name]=t.id,e}),{});return e.reduce((function(e,t){return e[n[t.fileData.name]]=t,e}),{})}},{key:"validateCocoFormat",value:function(e){var t=n.requiredKeys.filter((function(t){return!e.hasOwnProperty(t)}));if(0!==t.length)throw new Fn("Uploaded file does not contain all required keys: ".concat(t))}}]),n}(Yn);Xn.requiredKeys=["images","annotations","categories"];var Kn,Jn=function(e){Object(f.a)(n,e);var t=Object(O.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"import",value:function(e,t,a){try{var i=de.getImagesData().map((function(e){return Kt.cleanAnnotations(e)})),o=n.filterFilesData(e,i),r=o.labelNameFile,c=o.annotationFiles,l=n.matchImagesWithAnnotations(i,c),u=Object(s.a)(l,2),d=u[0],g=u[1],b=X.readFile(r).then((function(e){return rn.parseLabelsNamesFromString(e)})),h=Kt.loadMissingImages(d),f=X.readFiles(g);Promise.all([b,h,f]).then((function(e){var a=Object(s.a)(e,3),o=a[0],r=a[2],c=Object(N.zip)(d,r).map((function(e){return n.applyAnnotations(e[0],e[1],o)}));t(n.injectImageDataWithAnnotations(i,c),o)})).catch((function(e){return a(e)}))}catch(O){a(O)}}}],[{key:"filterFilesData",value:function(e,t){var a=_n.partition(e,(function(e){return e.name===n.labelsFileName}));if(1!==a.pass.length)throw new nn;var i=t.map((function(e){return e.fileData.name})).map((function(e){return X.extractFileName(e)})),o=_n.partition(e,(function(e){return i.includes(X.extractFileName(e.name))}));return{labelNameFile:a.pass[0],annotationFiles:o.pass}}},{key:"matchImagesWithAnnotations",value:function(e,t){return _n.unzip(_n.match(e,t,(function(e,t){return X.extractFileName(e.fileData.name)===X.extractFileName(t.name)})))}},{key:"applyAnnotations",value:function(e,t,n){var a=_.getById(e.id);return e.labelRects=rn.parseYOLOAnnotationsFromString(t,n,{width:a.width,height:a.height},e.fileData.name),e}},{key:"injectImageDataWithAnnotations",value:function(e,t){return e.map((function(e){var n=Object(N.find)(t,{id:e.id});return n||e}))}}]),n}(Yn);Jn.labelsFileName="labels.txt";var qn,Qn,$n,ea=(Kn={},Object(fn.a)(Kn,Tn.COCO,Xn),Object(fn.a)(Kn,Tn.CSV,void 0),Object(fn.a)(Kn,Tn.JSON,void 0),Object(fn.a)(Kn,Tn.VGG,void 0),Object(fn.a)(Kn,Tn.VOC,void 0),Object(fn.a)(Kn,Tn.YOLO,Jn),Kn),ta={updateImageDataAction:G,updateLabelNamesAction:H,updateActiveLabelTypeAction:V},na=Object(l.b)((function(e){return{activeLabelType:e.labels.activeLabelType}}),ta)((function(e){var t=e.activeLabelType,n=e.updateImageDataAction,a=e.updateLabelNamesAction,o=e.updateActiveLabelTypeAction,r=function(e){var t=Un[e];return 1===t.length?t[0].type:null},c=Object(i.useState)(t),l=Object(s.a)(c,2),u=l[0],d=l[1],g=Object(i.useState)(r(t)),b=Object(s.a)(g,2),h=b[0],f=b[1],O=Object(i.useState)([]),v=Object(s.a)(O,2),p=v[0],m=v[1],y=Object(i.useState)([]),I=Object(s.a)(y,2),E=I[0],P=I[1],C=Object(i.useState)(null),L=Object(s.a)(C,2),T=L[0],S=L[1],x=Object(Yt.a)({accept:[yt.JSON,yt.TEXT],multiple:!0,onDrop:function(e){new ea[h]([u]).import(e,R,N)}}),w=x.getRootProps,D=x.getInputProps,R=function(e,t){m(t),P(e),S(null)},N=function(e){m([]),P([]),S(e)},_=function(e){return e.map((function(e){return Object(A.jsxs)("div",{className:"OptionsItem",onClick:function(){return t=e.type,void f(t);var t},children:[e.type===h?Object(A.jsx)("img",{draggable:!1,src:"ico/checkbox-checked.png",alt:"checked"}):Object(A.jsx)("img",{draggable:!1,src:"ico/checkbox-unchecked.png",alt:"unchecked"}),e.label]},e.type)}))};return Object(A.jsx)(Bn,{activeLabelType:u,title:"Import ".concat(u.toLowerCase()," annotations"),onLabelTypeChange:function(e){d(e),f(r(e)),m([]),P([]),S(null)},acceptLabel:"Import",onAccept:function(e){0!==p.length&&0!==E.length&&(n(E),a(p),o(e),Fe.close())},skipAcceptButton:0===Un[u].length,disableAcceptButton:0===E.length||0===p.length||!!T,rejectLabel:"Cancel",onReject:function(e){Fe.close()},renderInternalContent:function(e){return h||0===Un[e].length?0===Un[e].length?Object(A.jsx)(Vn,{}):Object(A.jsx)("div",Object(j.a)(Object(j.a)({},w({className:"DropZone"})),{},{children:T?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("input",Object(j.a)({},D())),Object(A.jsx)("img",{draggable:!1,alt:"upload",src:"ico/box-opened.png"}),Object(A.jsx)("p",{className:"extraBold",children:"Annotation import was unsuccessful"}),T.message,Object(A.jsx)("p",{className:"extraBold",children:"Try again"})]}):0!==E.length&&0!==p.length?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("img",{draggable:!1,alt:"uploaded",src:"ico/box-closed.png"}),Object(A.jsx)("p",{className:"extraBold",children:"Annotation ready for import"}),"After import you will lose all your current annotations"]}):Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("input",Object(j.a)({},D())),Object(A.jsx)("img",{draggable:!1,alt:"upload",src:"ico/box-opened.png"}),Object(A.jsx)("p",{className:"extraBold",children:"Drop ".concat(h," annotations")}),Object(A.jsx)("p",{children:"or"}),Object(A.jsx)("p",{className:"extraBold",children:"Click here to select them"})]})})):[Object(A.jsx)("div",{className:"Message",children:"Select file format you would like to use to import labels."}),Object(A.jsx)("div",{className:"Options",children:_(Un[e])})]}})})),aa=(n(524),n(244)),ia=n.n(aa),oa=n(177),ra=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"sanitize",value:function(e){return e.replace("<","&lt;").replace(">","&gt;").replace("&","&amp;").replace("'","&#39;").replace("/","&#x2F;")}}]),e}(),ca=n(378),sa=n.n(ca),la=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"getExportFileName",value:function(){var e=he.getProjectName(),t=sa()().format("YYYY-MM-DD-hh-mm-ss");return"labels_".concat(e,"_").concat(t)}},{key:"saveAs",value:function(e,t){var n=new Blob([e],{type:"text/plain;charset=utf-8"});try{Object(oa.saveAs)(n,t)}catch(a){throw new Error(a)}}}]),e}(),ua=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"export",value:function(t){switch(t){case Tn.YOLO:e.exportAsYOLO();break;case Tn.VOC:e.exportAsVOC();break;case Tn.CSV:e.exportAsCSV();break;default:return}}},{key:"exportAsYOLO",value:function(){var t=new ia.a;de.getImagesData().forEach((function(n){var a=e.wrapRectLabelsIntoYOLO(n);if(a){var i=n.fileData.name.replace(/\.[^/.]+$/,".txt");try{t.file(i,a)}catch(o){throw new Error(o)}}}));try{t.generateAsync({type:"blob"}).then((function(e){Object(oa.saveAs)(e,"".concat(la.getExportFileName(),".zip"))}))}catch(n){throw new Error(n)}}},{key:"wrapRectLabelIntoYOLO",value:function(e,t,n){var a=function(e){return y.snapValueToRange(e,0,1).toFixed(6)},i=Object(N.findIndex)(t,{id:e.labelId}).toString(),o=I.getCenter(e.rect),r=I.getSize(e.rect),c=[o.x/n.width,o.y/n.height,r.width/n.width,r.height/n.height].map((function(e){return parseFloat(a(e))})),l=Object(s.a)(c,4),u=l[0],d=l[1],g=l[2],b=l[3];u+g/2>1&&(g=2*(1-u)),u-g/2<0&&(g=2*u),d+b/2>1&&(b=2*(1-d)),d-b/2<0&&(b=2*d);var h=[u,d,g,b].map((function(e){return a(e)}));return[i].concat(Object(R.a)(h)).join(" ")}},{key:"wrapRectLabelsIntoYOLO",value:function(t){if(0===t.labelRects.length||!t.loadStatus)return null;var n=de.getLabelNames(),a=_.getById(t.id),i={width:a.width,height:a.height};return t.labelRects.map((function(t){return e.wrapRectLabelIntoYOLO(t,n,i)})).join("\n")}},{key:"exportAsVOC",value:function(){var t=new ia.a;de.getImagesData().forEach((function(n){var a=e.wrapImageIntoVOC(n);if(a){var i=n.fileData.name.replace(/\.[^/.]+$/,".xml");try{t.file(i,a)}catch(o){throw new Error(o)}}}));try{t.generateAsync({type:"blob"}).then((function(e){Object(oa.saveAs)(e,"".concat(la.getExportFileName(),".zip"))}))}catch(n){throw new Error(n)}}},{key:"wrapRectLabelsIntoVOC",value:function(e){if(0===e.labelRects.length||!e.loadStatus)return null;var t=de.getLabelNames();return e.labelRects.map((function(e){var n=Object(N.findLast)(t,{id:e.labelId});return(n?["\t<object>","\t\t<name>".concat(n.name,"</name>"),"\t\t<pose>Unspecified</pose>","\t\t<truncated>0</truncated>","\t\t<difficult>0</difficult>","\t\t<bndbox>","\t\t\t<xmin>".concat(Math.round(e.rect.x),"</xmin>"),"\t\t\t<ymin>".concat(Math.round(e.rect.y),"</ymin>"),"\t\t\t<xmax>".concat(Math.round(e.rect.x+e.rect.width),"</xmax>"),"\t\t\t<ymax>".concat(Math.round(e.rect.y+e.rect.height),"</ymax>"),"\t\t</bndbox>","\t</object>"]:[]).join("\n")})).join("\n")}},{key:"wrapImageIntoVOC",value:function(t){var n=e.wrapRectLabelsIntoVOC(t),a=ra.sanitize(he.getProjectName());if(n){var i=_.getById(t.id);return["<annotation>","\t<folder>".concat(a,"</folder>"),"\t<filename>".concat(t.fileData.name,"</filename>"),"\t<path>/".concat(a,"/").concat(t.fileData.name,"</path>"),"\t<source>","\t\t<database>Unspecified</database>","\t</source>","\t<size>","\t\t<width>".concat(i.width,"</width>"),"\t\t<height>".concat(i.height,"</height>"),"\t\t<depth>3</depth>","\t</size>",n,"</annotation>"].join("\n")}return null}},{key:"exportAsCSV",value:function(){var t=de.getImagesData().map((function(t){return e.wrapRectLabelsIntoCSV(t)})).filter((function(e){return!!e})).join("\n"),n="".concat(la.getExportFileName(),".csv");la.saveAs(t,n)}},{key:"wrapRectLabelsIntoCSV",value:function(e){if(0===e.labelRects.length||!e.loadStatus)return null;var t=_.getById(e.id),n=de.getLabelNames();return e.labelRects.map((function(a){var i=Object(N.findLast)(n,{id:a.labelId});return(i?[i.name,Math.round(a.rect.x).toString(),Math.round(a.rect.y).toString(),Math.round(a.rect.width).toString(),Math.round(a.rect.height).toString(),e.fileData.name,t.width.toString(),t.height.toString()]:[]).join(",")})).join("\n")}}]),e}(),da=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"export",value:function(){var t=de.getImagesData(),n=de.getLabelNames(),a=JSON.stringify(e.mapImagesDataToVGGObject(t,n)),i="".concat(la.getExportFileName(),".json");la.saveAs(a,i)}},{key:"mapImagesDataToVGGObject",value:function(t,n){return t.reduce((function(t,a){var i=e.mapImageDataToVGGFileData(a,n);return i&&(t[a.fileData.name]=i),t}),{})}},{key:"mapImageDataToVGGFileData",value:function(t,n){var a=e.mapImageDataToVGG(t,n);return a?{fileref:"",size:t.fileData.size,filename:t.fileData.name,base64_img_data:"",file_attributes:{},regions:a}:null}},{key:"mapImageDataToVGG",value:function(t,n){if(!t.loadStatus||!t.labelPolygons||!t.labelPolygons.length||!n||!n.length)return null;var a=e.getValidPolygonLabels(t);return a.length?a.reduce((function(t,a,i){var o=Object(N.findLast)(n,{id:a.labelId});return o&&(t[i.toString()]={shape_attributes:e.mapPolygonToVGG(a.vertices),region_attributes:{label:o.name}}),t}),{}):null}},{key:"getValidPolygonLabels",value:function(e){return e.labelPolygons.filter((function(e){return null!==e.labelId&&!!e.vertices.length}))}},{key:"mapPolygonToVGG",value:function(e){return e&&e.length?{name:"polygon",all_points_x:e.map((function(e){return e.x})).concat(e[0].x),all_points_y:e.map((function(e){return e.y})).concat(e[0].y)}:null}}]),e}(),ga=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"export",value:function(){var t=de.getImagesData(),n=de.getLabelNames(),a=he.getProjectName(),i=e.mapImagesDataToCOCOObject(t,n,a),o=JSON.stringify(i),r="".concat(la.getExportFileName(),".json");la.saveAs(o,r)}},{key:"mapImagesDataToCOCOObject",value:function(t,n,a){return{info:e.getInfoComponent(a),images:e.getImagesComponent(t),annotations:e.getAnnotationsComponent(t,n),categories:e.getCategoriesComponent(n)}}},{key:"getInfoComponent",value:function(e){return{description:e}}},{key:"getCategoriesComponent",value:function(e){return e.map((function(e,t){return{id:t+1,name:e.name}}))}},{key:"getImagesComponent",value:function(e){return e.filter((function(e){return e.loadStatus})).filter((function(e){return 0!==e.labelPolygons.length})).map((function(e,t){var n=_.getById(e.id);return{id:t+1,width:n.width,height:n.height,file_name:e.fileData.name}}))}},{key:"getAnnotationsComponent",value:function(t,n){var a=e.mapLabelsData(n),i=0,o=t.filter((function(e){return e.loadStatus})).filter((function(e){return 0!==e.labelPolygons.length})).map((function(t,n){return t.labelPolygons.map((function(t){return{id:i++,iscrowd:0,image_id:n+1,category_id:a[t.labelId],segmentation:e.getCOCOSegmentation(t.vertices),bbox:e.getCOCOBbox(t.vertices),area:e.getCOCOArea(t.vertices)}}))}));return Object(N.flatten)(o)}},{key:"mapLabelsData",value:function(e){return e.reduce((function(e,t,n){return e[t.id]=n+1,e}),{})}},{key:"getCOCOSegmentation",value:function(e){var t=e.map((function(e){return[e.x,e.y]}));return[Object(N.flatten)(t)]}},{key:"getCOCOBbox",value:function(e){var t,n=e[0].x,a=e[0].x,i=e[0].y,o=e[0].y,r=Object(Z.a)(e);try{for(r.s();!(t=r.n()).done;){var c=t.value;n>c.x&&(n=c.x),a<c.x&&(a=c.x),i>c.y&&(i=c.y),o<c.y&&(o=c.y)}}catch(s){r.e(s)}finally{r.f()}return[n,i,a-n,o-i]}},{key:"getCOCOArea",value:function(e){for(var t=0,n=e.length-1,a=0;a<e.length;a++)t+=(e[n].x+e[a].x)*(e[n].y-e[a].y),n=a;return Math.abs(t/2)}}]),e}(),ba=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"export",value:function(e){switch(e){case Tn.VGG:da.export();break;case Tn.COCO:ga.export();break;default:return}}}]),e}(),ha=(qn={},Object(fn.a)(qn,b.RECT,[{type:Tn.YOLO,label:"YOLO format."}]),Object(fn.a)(qn,b.POINT,[{type:Tn.CSV,label:"Single CSV file."}]),Object(fn.a)(qn,b.LINE,[{type:Tn.CSV,label:"Single CSV file."}]),Object(fn.a)(qn,b.POLYGON,[{type:Tn.COCO,label:"COCO JSON format."}]),Object(fn.a)(qn,b.IMAGE_RECOGNITION,[{type:Tn.CSV,label:"Single CSV file."},{type:Tn.JSON,label:"Single JSON file."}]),qn),fa=Object(l.b)((function(e){return{activeLabelType:e.labels.activeLabelType}}),{})((function(e){var t=e.activeLabelType,n=Object(i.useState)(t),a=Object(s.a)(n,2),o=a[0],r=a[1],c=Object(i.useState)(null),l=Object(s.a)(c,2),u=l[0],d=l[1],g=function(e){return e.map((function(e){return Object(A.jsxs)("div",{className:"OptionsItem",onClick:function(){return function(e){d(e)}(e.type)},children:[e.type===u?Object(A.jsx)("img",{draggable:!1,src:"ico/checkbox-checked.png",alt:"checked"}):Object(A.jsx)("img",{draggable:!1,src:"ico/checkbox-unchecked.png",alt:"unchecked"}),e.label]},e.type)}))};return Object(A.jsx)(Bn,{activeLabelType:o,title:"Export ".concat(o.toLowerCase()," annotations"),onLabelTypeChange:function(e){r(e),d(null)},acceptLabel:"Export",onAccept:function(e){switch(e){case b.RECT:ua.export(u);break;case b.POLYGON:ba.export(u)}Fe.close()},disableAcceptButton:!u,rejectLabel:"Cancel",onReject:function(e){Fe.close()},renderInternalContent:function(e){return[Object(A.jsx)("div",{className:"Message",children:"Select label type and the file format you would like to use to export labels."}),Object(A.jsx)("div",{className:"Options",children:g(ha[e])})]}})})),Oa=Object(l.b)((function(e){return{activePopupType:e.general.activePopupType}}))((function(e){var t=e.activePopupType;return t&&Object(A.jsx)("div",{className:"PopupView",children:function(){switch(t){case u.LOAD_LABEL_NAMES:return Object(A.jsx)(sn,{});case u.EXPORT_ANNOTATIONS:return Object(A.jsx)(fa,{});case u.IMPORT_ANNOTATIONS:return Object(A.jsx)(na,{});case u.INSERT_LABEL_NAMES:return Object(A.jsx)(mn,{isUpdate:!1});case u.UPDATE_LABEL:return Object(A.jsx)(mn,{isUpdate:!0});case u.EXIT_PROJECT:return Object(A.jsx)(yn,{});case u.IMPORT_IMAGES:return Object(A.jsx)(An,{});case u.LOAD_AI_MODEL:return Object(A.jsx)(wn,{});case u.SUGGEST_LABEL_NAMES:return Object(A.jsx)(Mn,{});case u.LOADER:return Object(A.jsx)(x.ClipLoader,{size:50,color:J.getLeadingColor(),loading:!0});default:return null}}()})})),va=(n(525),[{displayName:"Github",imageSrc:"/ico/github-logo.png",imageAlt:"GitHub Logo",href:g.GITHUB_URL,tooltipMessage:"Show me some love on GitHub"},{displayName:"Medium",imageSrc:"/ico/medium-logo.png",imageAlt:"Medium Logo",href:g.MEDIUM_URL,tooltipMessage:"Read my AI content on Medium"},{displayName:"Patreon",imageSrc:"/ico/patreon-logo.png",imageAlt:"Patreon Logo",href:g.PATREON_URL,tooltipMessage:"Support Make Sense on Patreon and help it grow"}]),pa=Object(l.b)((function(e){return{size:e.general.windowSize}}),{})((function(e){var t=e.size,n=Object(i.useState)(0),a=Object(s.a)(n,2),o=a[0],r=a[1],c=function(e){return e.map((function(e){return Object(A.jsx)("div",{className:"EditorFeaturesTiles",children:Object(A.jsxs)("div",{className:"EditorFeaturesTilesWrapper",children:[Object(A.jsx)("img",{draggable:!1,alt:e.imageAlt,src:e.imageSrc}),Object(A.jsx)("div",{className:"EditorFeatureLabel",children:e.displayText})]})},e.displayText)}))},l=Object(A.jsxs)("div",{className:S()("MobileTopNavigationBar",{Hide:o<350,Show:o>=350}),children:[Object(A.jsx)("div",{className:"NavigationBarGroupWrapper",children:Object(A.jsxs)("div",{className:"Header",children:[Object(A.jsx)("img",{draggable:!1,alt:"make-sense",src:"/make-sense-ico-transparent.png"}),"Make Sense"]})}),Object(A.jsx)("div",{className:"TriangleHorizontal Bottom",children:Object(A.jsx)("div",{className:"TriangleHorizontalContent"})})]}),u=Object(A.jsxs)("div",{className:"FirstStage",children:[Object(A.jsx)("img",{draggable:!1,alt:"main-logo",src:"ico/main-image-color.png"}),Object(A.jsx)("div",{className:"TriangleHorizontal Bottom",children:Object(A.jsx)("div",{className:"TriangleHorizontalContent"})})]}),d=Object(A.jsx)("div",{className:"SecondStage",children:c(Wt.slice(0,3))}),g=Object(A.jsxs)("div",{className:"ThirdStage",children:[c(Wt.slice(3,6)),Object(A.jsx)("div",{className:"TriangleHorizontal Top",children:Object(A.jsx)("div",{className:"TriangleHorizontalContent"})}),Object(A.jsx)("div",{className:"TriangleHorizontal Bottom",children:Object(A.jsx)("div",{className:"TriangleHorizontalContent"})})]}),b=Object(A.jsxs)("div",{className:"FourthStage",children:[Object(A.jsx)("div",{className:"Message",children:"Due to the small size of the screen we do not support our editor on mobile devices. Check what you missed and visit us from a desktop."}),Object(A.jsx)("div",{className:"SocialMediaWrapper",children:function(e){return va.map((function(t,n){return Object(A.jsx)(Xe,{buttonSize:e,image:t.imageSrc,imageAlt:t.imageAlt,href:t.href},n)}))}({width:40,height:40})})]});return Object(A.jsxs)("div",{className:"MobileMainView",children:[l,Object(A.jsx)(p.a,{onScrollFrame:function(e){r(e.scrollTop)},children:Object(A.jsxs)("div",{className:"MobileMainViewContent",style:{width:t.width},children:[u,d,g,b]})})]})})),ma=(n(526),function(){return Object(A.jsxs)("div",{className:"SizeItUpView",children:[Object(A.jsx)("p",{className:"extraBold",children:"Ops... This window is to tight for me!"}),Object(A.jsx)("img",{draggable:!1,alt:"small_window",src:"ico/small_window.png"}),Object(A.jsxs)("p",{className:"extraBold",children:["Please... make it at least ",g.EDITOR_MIN_WIDTH," x ",g.EDITOR_MIN_HEIGHT," px."]})]})});n(527);!function(e){e.IN="IN",e.DISPLAY="DISPLAY",e.OUT="OUT",e.IDLE="IDLE"}(Qn||(Qn={})),function(e){e.IN="animation-in",e.DISPLAY="animation-display",e.OUT="animation-out"}($n||($n={}));var ja={deleteNotificationByIdAction:function(e){return{type:D.DELETE_NOTIFICATION_BY_ID,payload:{id:e}}}},ya=Object(l.b)((function(e){return{queue:e.notifications.queue}}),ja)((function(e){var t=Object(i.useState)(Qn.IDLE),n=Object(s.a)(t,2),a=n[0],o=n[1];e.queue.length>0&&a===Qn.IDLE&&o(Qn.IN);var r=e.queue[0],c=function(){o(Qn.OUT)},l=function(t){switch(t.animationName){case $n.IN:o(Qn.DISPLAY);break;case $n.DISPLAY:o(Qn.OUT);break;case $n.OUT:e.deleteNotificationByIdAction(r.id),o(Qn.IDLE)}};return a!==Qn.IDLE?Object(A.jsx)("div",{className:S()("notification-wrapper",{in:a===Qn.IN,display:a===Qn.DISPLAY,out:a===Qn.OUT}),onAnimationEnd:l,onClick:c,children:Object(A.jsxs)("div",{className:S()("notification",{error:r.type===Xt.ERROR,success:r.type===Xt.SUCCESS,message:r.type===Xt.MESSAGE,warning:r.type===Xt.WARNING}),children:[Object(A.jsx)("div",{className:"header",children:r.header}),Object(A.jsx)("div",{className:"content",children:r.description}),Object(A.jsx)("div",{className:"loader"})]})},r.id):null})),Ia=Object(l.b)((function(e){return{projectType:e.general.projectData.type,windowSize:e.general.windowSize,FormDetectionLoaded:e.ai.isFormDetectorLoaded,MaskDetectionLoaded:e.ai.isMaskDetectorLoaded}}))((function(e){var t=e.projectType,n=e.windowSize,a=e.FormDetectionLoaded,i=e.MaskDetectionLoaded;return Object(A.jsxs)("div",{className:S()("App",{AI:i||a}),draggable:!1,children:[dt.mobileDeviceData.manufacturer&&dt.mobileDeviceData.os?Object(A.jsx)(pa,{}):t?n.height<g.EDITOR_MIN_HEIGHT||n.width<g.EDITOR_MIN_WIDTH?Object(A.jsx)(ma,{}):Object(A.jsx)(Ht,{}):Object(A.jsx)(Qt,{}),Object(A.jsx)(Oa,{}),Object(A.jsx)(ya,{})]})}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Aa=n(235),Ea={activeImageIndex:null,activeLabelNameId:null,activeLabelType:null,activeLabelId:null,highlightedLabelId:null,imagesData:[],firstLabelCreatedFlag:!1,labels:[]};var Pa={windowSize:null,activePopupType:null,customCursorStyle:oe.DEFAULT,activeContext:null,preventCustomCursor:!1,imageDragMode:!1,crossHairVisible:!0,enablePerClassColoration:!0,projectData:{type:null,name:"my-project-name"},zoom:Ee.MIN_ZOOM};var Ca={suggestedLabelList:[],rejectedSuggestedLabelList:[],isObjectDetectorLoaded:!1,isPoseDetectorLoaded:!1,isFormDetectorLoaded:!1,isMaskDetectorLoaded:!1,isAIDisabled:!1};var La={queue:[]};var Ta=Object(Aa.a)({general:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D.UPDATE_WINDOW_SIZE:return Object(j.a)(Object(j.a)({},e),{},{windowSize:t.payload.windowSize});case D.UPDATE_ACTIVE_POPUP_TYPE:return Object(j.a)(Object(j.a)({},e),{},{activePopupType:t.payload.activePopupType});case D.UPDATE_CUSTOM_CURSOR_STYLE:return Object(j.a)(Object(j.a)({},e),{},{customCursorStyle:t.payload.customCursorStyle});case D.UPDATE_CONTEXT:return Object(j.a)(Object(j.a)({},e),{},{activeContext:t.payload.activeContext});case D.UPDATE_PREVENT_CUSTOM_CURSOR_STATUS:return Object(j.a)(Object(j.a)({},e),{},{preventCustomCursor:t.payload.preventCustomCursor});case D.UPDATE_IMAGE_DRAG_MODE_STATUS:return Object(j.a)(Object(j.a)({},e),{},{imageDragMode:t.payload.imageDragMode});case D.UPDATE_CROSS_HAIR_VISIBLE_STATUS:return Object(j.a)(Object(j.a)({},e),{},{crossHairVisible:t.payload.crossHairVisible});case D.UPDATE_PROJECT_DATA:return Object(j.a)(Object(j.a)({},e),{},{projectData:t.payload.projectData});case D.UPDATE_ZOOM:return Object(j.a)(Object(j.a)({},e),{},{zoom:t.payload.zoom});case D.UPDATE_ENABLE_PER_CLASS_COLORATION_STATUS:return Object(j.a)(Object(j.a)({},e),{},{enablePerClassColoration:t.payload.enablePerClassColoration});default:return e}},labels:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ea,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D.UPDATE_ACTIVE_IMAGE_INDEX:return Object(j.a)(Object(j.a)({},e),{},{activeImageIndex:t.payload.activeImageIndex});case D.UPDATE_ACTIVE_LABEL_NAME_ID:return Object(j.a)(Object(j.a)({},e),{},{activeLabelNameId:t.payload.activeLabelNameId});case D.UPDATE_ACTIVE_LABEL_ID:return Object(j.a)(Object(j.a)({},e),{},{activeLabelId:t.payload.activeLabelId});case D.UPDATE_HIGHLIGHTED_LABEL_ID:return Object(j.a)(Object(j.a)({},e),{},{highlightedLabelId:t.payload.highlightedLabelId});case D.UPDATE_ACTIVE_LABEL_TYPE:return Object(j.a)(Object(j.a)({},e),{},{activeLabelType:t.payload.activeLabelType});case D.UPDATE_IMAGE_DATA_BY_ID:return Object(j.a)(Object(j.a)({},e),{},{imagesData:e.imagesData.map((function(e){return e.id===t.payload.id?t.payload.newImageData:e}))});case D.ADD_IMAGES_DATA:return Object(j.a)(Object(j.a)({},e),{},{imagesData:e.imagesData.concat(t.payload.imageData)});case D.UPDATE_IMAGES_DATA:return Object(j.a)(Object(j.a)({},e),{},{imagesData:t.payload.imageData});case D.UPDATE_LABEL_NAMES:return Object(j.a)(Object(j.a)({},e),{},{labels:t.payload.labels});case D.UPDATE_FIRST_LABEL_CREATED_FLAG:return Object(j.a)(Object(j.a)({},e),{},{firstLabelCreatedFlag:t.payload.firstLabelCreatedFlag});default:return e}},ai:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ca,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D.UPDATE_SUGGESTED_LABEL_LIST:return Object(j.a)(Object(j.a)({},e),{},{suggestedLabelList:t.payload.labelList});case D.UPDATE_REJECTED_SUGGESTED_LABEL_LIST:return Object(j.a)(Object(j.a)({},e),{},{rejectedSuggestedLabelList:t.payload.labelList});case D.UPDATE_OBJECT_DETECTOR_STATUS:return Object(j.a)(Object(j.a)({},e),{},{isObjectDetectorLoaded:t.payload.isObjectDetectorLoaded});case D.UPDATE_POSE_DETECTOR_STATUS:return Object(j.a)(Object(j.a)({},e),{},{isPoseDetectorLoaded:t.payload.isPoseDetectorLoaded});case D.UPDATE_FORM_DETECTOR_STATUS:return Object(j.a)(Object(j.a)({},e),{},{isFormDetectorLoaded:t.payload.isFormDetectorLoaded});case D.UPDATE_MASK_DETECTOR_STATUS:return Object(j.a)(Object(j.a)({},e),{},{isMaskDetectorLoaded:t.payload.isMaskDetectorLoaded});case D.UPDATE_DISABLED_AI_FLAG:return Object(j.a)(Object(j.a)({},e),{},{isAIDisabled:t.payload.isAIDisabled});default:return e}},notifications:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:La,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D.SUBMIT_NEW_NOTIFICATION:return Object(j.a)(Object(j.a)({},e),{},{queue:[].concat(Object(R.a)(e.queue),[t.payload.notification])});case D.DELETE_NOTIFICATION_BY_ID:return Object(j.a)(Object(j.a)({},e),{},{queue:e.queue.filter((function(e){return e.id!==t.payload.id}))});default:return e}}});var Sa=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"isDev",value:function(){return!1}},{key:"isProd",value:function(){return!0}}]),e}(),xa=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"inti",value:function(){e.handleResize(),e.detectDeviceParams(),e.handleAccidentalPageExit(),window.addEventListener(ue.RESIZE,e.handleResize),window.addEventListener(ue.MOUSE_WHEEL,e.disableGenericScrollZoom,{passive:!1}),window.addEventListener(ue.KEY_DOWN,e.disableUnwantedKeyBoardBehaviour),window.addEventListener(ue.KEY_PRESS,e.disableUnwantedKeyBoardBehaviour),He.init()}}]),e}();xa.handleAccidentalPageExit=function(){window.onbeforeunload=function(e){null!=he.getProjectType()&&Sa.isProd()&&(e.preventDefault(),e.returnValue="")}},xa.handleResize=function(){var e;wa.dispatch((e={width:window.innerWidth,height:window.innerHeight},{type:D.UPDATE_WINDOW_SIZE,payload:{windowSize:e}}))},xa.disableUnwantedKeyBoardBehaviour=function(e){dt.isMac&&e.metaKey&&e.preventDefault(),["=","+","-"].includes(e.key)&&(e.ctrlKey||dt.isMac&&e.metaKey)&&e.preventDefault()},xa.disableGenericScrollZoom=function(e){(e.ctrlKey||dt.isMac&&e.metaKey)&&e.preventDefault()},xa.detectDeviceParams=function(){var e=window.navigator.userAgent;dt.mobileDeviceData=Ue.getMobileDeviceData(e),dt.isMac=Ue.isMac(e),dt.isSafari=Ue.isSafari(e),dt.isFirefox=Ue.isFirefox(e)};var wa=Object(Aa.b)(Ta,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());xa.inti(),c.a.render(Object(A.jsx)(l.a,{store:wa,children:Object(A.jsx)(Ia,{})}),document.getElementById("root")||document.createElement("div")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[529,1,2]]]);
//# sourceMappingURL=main.e3eb032b.chunk.js.map